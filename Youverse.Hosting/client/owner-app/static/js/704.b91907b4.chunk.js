"use strict";(self.webpackChunkowner_app=self.webpackChunkowner_app||[]).push([[704],{2284:function(e,n,r){var t=r(885),a=r(2791),i=r(1261),s=r(4648),c=r(245),o=r(184),u=function(e){var n=e.className,r=e.isChecked,t=e.children,a=e.onChange;return(0,o.jsxs)("li",{className:"flex min-w-[6rem] cursor-pointer select-none flex-row py-1 px-4 hover:bg-slate-100 dark:hover:bg-slate-700 ".concat(n),onClick:a,children:[(0,o.jsx)(s.Z,{className:"my-auto mr-3 h-4 w-4 flex-shrink-0  ".concat(r?"text-slate-700 dark:text-slate-200":"text-transparent")})," ",(0,o.jsx)("span",{className:"mr-auto block h-full py-1",children:t})]})};n.Z=function(e){var n=e.className,r=e.permissionLevels,s=e.onChange,l=e.defaultValue,d=(0,a.useState)(!1),p=(0,t.Z)(d,2),v=p[0],m=p[1],f=(0,a.useState)(l),h=(0,t.Z)(f,2),x=h[0],g=h[1],y=(0,a.useRef)(null);(0,i.Z)(y,(function(){return m(!1)}));var Z=r.reduce((function(e,n){return n.value>e.value&&n.value<=l?n:e}),r[0]),w=function(e){g(e),s(e)};return(0,o.jsx)("div",{className:null!==n&&void 0!==n?n:"",children:(0,o.jsxs)("div",{className:"relative cursor-pointer rounded-md bg-slate-100 dark:bg-slate-800",onClick:function(){return m(!v)},ref:y,children:[(0,o.jsxs)("div",{className:"flex min-w-[6rem] flex-row py-1 px-2",children:[(0,o.jsx)("span",{className:"my-auto mr-2 select-none",children:Z.name})," ",(0,o.jsx)(c.Z,{className:"my-auto ml-auto h-2 w-2 rotate-90"})]}),(0,o.jsx)("ul",{className:"absolute top-[100%] right-0 overflow-hidden bg-white dark:bg-slate-800 ".concat(v?"z-10 max-h-[30rem] border border-slate-100 py-3 shadow-2xl dark:border-slate-700":"max-h-0"),children:r.map((function(e){return(0,o.jsx)(u,{isChecked:0===e.value?x===e.value:x>=e.value,onChange:function(){return x!==e.value?w(e.value):w(0)},children:e.name},e.value)}))})]})})}},245:function(e,n,r){var t=r(184);n.Z=function(e){var n=e.className;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",className:n,children:(0,t.jsx)("path",{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"})})}},2405:function(e,n,r){var t=r(3504),a=r(4990),i=r(715),s=r(184);n.Z=function(e){var n=e.appDef,r=e.permissionLevel,c=e.className;return n?(0,s.jsx)("div",{className:"".concat(null!==c&&void 0!==c?c:""," ").concat(n.isRevoked&&"opacity-50"),children:(0,s.jsx)(t.rU,{to:"/owner/apps/".concat(n.appId),children:(0,s.jsxs)("h2",{className:"mb-2 flex flex-row text-xl",children:[(0,s.jsx)(i.Z,{className:"my-auto mr-2 h-4 w-4"})," ",(0,s.jsxs)("span",{className:"my-auto",children:[n.isRevoked&&"".concat((0,a.t)("Revoked"),": "),n.name]}),r&&(0,s.jsxs)("span",{className:"my-auto",children:[": ",r]})]})})}):(0,s.jsx)(s.Fragment,{})}},8808:function(e,n,r){var t=r(3504),a=r(4990),i=r(7480),s=r(4665),c=r(715),o=r(184);n.Z=function(e){var n=e.circleDef,r=e.permissionLevel,u=e.className,l=e.onClick,d=(0,i.Z)({circleId:null===n||void 0===n?void 0:n.id}).fetchMembers.data;if(!n)return(0,o.jsx)(o.Fragment,{});var p=function(e){var r=e.children;return l?(0,o.jsx)(o.Fragment,{children:r}):(0,o.jsx)(t.rU,{to:"/owner/circles/".concat(encodeURIComponent(n.id)),className:"contents hover:text-slate-700 hover:underline dark:hover:text-slate-400",children:r})};return(0,o.jsx)("div",{className:"flex flex-row ".concat(null!==u&&void 0!==u?u:""," ").concat(n.disabled&&"opacity-50"," ").concat(l&&"cursor-pointer"),onClick:function(){return l&&l()},children:(0,o.jsxs)(p,{children:[(0,o.jsx)(c.Z,{className:"mt-1 mb-auto mr-3 h-6 w-6"}),(0,o.jsxs)("div",{className:"mr-2 flex flex-col",children:[(0,o.jsxs)("p",{className:"my-auto leading-none",children:[n.disabled&&(0,a.t)("Disabled:")," ",null===n||void 0===n?void 0:n.name,r&&": ".concat(r)]}),(0,o.jsxs)("small",{className:"block",children:[d?"".concat(d.length," ").concat(1===d.length?(0,a.t)("member"):(0,a.t)("members")," ").concat((0,a.t)("receives")," "):null,null!==n&&void 0!==n&&n.driveGrants?"".concat((0,a.t)("access on")," ").concat(n.driveGrants.length," ").concat(n.driveGrants.length>=2?(0,a.t)("drives"):(0,a.t)("drive")):null]})]}),l?(0,o.jsx)(t.rU,{to:"/owner/circles/".concat(encodeURIComponent(n.id)),className:"my-auto ml-auto py-2 px-4 hover:text-slate-700 hover:underline dark:hover:text-slate-400",children:(0,o.jsx)(s.Z,{className:"h-5 w-5"})}):(0,o.jsx)(s.Z,{className:"my-auto ml-auto h-5 w-5"})]})})}},8491:function(e,n,r){var t=r(184);n.Z=function(e){var n=e.title,r=e.className,a=e.children,i=e.isOpaqueBg,s=void 0!==i&&i,c=e.isBorderLess,o=void 0!==c&&c;return(0,t.jsxs)("section",{className:"my-5 rounded-md ".concat(s?o?"":"rounded-lg border-[1px] border-gray-200 border-opacity-80 px-5 dark:border-gray-700":"bg-slate-50 px-5 dark:bg-slate-800"," dark:text-slate-300 ").concat(null!==r&&void 0!==r?r:""),children:[n?(0,t.jsx)("div",{className:"relative border-b-[1px] border-gray-200 border-opacity-80 py-5 transition-all duration-300 dark:border-gray-700",children:(0,t.jsx)("h3",{className:"text-2xl dark:text-white",children:n})}):null,(0,t.jsx)("div",{className:"py-5 ",children:a})]})}},7266:function(e,n,r){r.d(n,{RG:function(){return s},fP:function(){return i},hz:function(){return c},m3:function(){return o},rS:function(){return t},vr:function(){return a}});var t=function(e){return e[Math.floor(Math.random()*e.length)]},a=function(){return t(["Ut bibendum, neque ac lacinia aliquam, justo ipsum aliquam urna, id vestibulum augue mauris sit amet lacus.","Proin ante sapien, interdum sit amet eros sit amet, eleifend pharetra metus.","Sed elit mi, euismod eget neque at, suscipit aliquam nisi.","Nunc diam arcu, tincidunt quis dignissim ac, volutpat non odio."])},i=function(){var e=["adorable","beautiful","clean","drab","elegant","fancy","glamorous","handsome","long","magnificent","old-fashioned","plain","quaint","sparkling","ugliest","unsightly","angry","bewildered","clumsy","defeated","embarrassed","fierce","grumpy","helpless","itchy","jealous","lazy","mysterious","nervous","obnoxious","panicky","repulsive","scary","thoughtless","uptight","worried"];return"".concat(t(e)," ").concat(t(e)," ").concat(t(["women","men","children","teeth","feet","people","leaves","mice","geese","halves","knives","wives","lives","elves","loaves","potatoes","tomatoes","cacti","foci","fungi","nuclei","syllabuses","analyses","diagnoses","oases","theses","crises","phenomena","criteria","data"]))},s=function(e){for(var n=window.atob(e),r=n.length,t=new Uint8Array(r),a=0;a<r;a++)t[a]=n.charCodeAt(a);return t.buffer},c=function(e,n){return n.reduce((function(n,r){return r.value>n.value&&r.value<=e?r:n}),n[0])},o=function(e,n,r){var t=e[n];return e.splice(n,1),e.splice(r,0,t),e}},769:function(e,n,r){r.r(n),r.d(n,{default:function(){return O}});var t=r(885),a=r(2791),i=r(6871),s=r(4990),c=r(1512),o=r(9072),u=r(1413),l=r(2982),d=r(4165),p=r(5861),v=r(4164),m=r(7480),f=r(4395),h=r(3412),x=r(2562),g=r(2284),y=r(715),Z=r(6123),w=r(184),j=function(e){var n=e.title,r=e.confirmText,i=e.isOpen,c=e.driveDefinition,j=e.onConfirm,b=e.onCancel,k=(0,h.Z)("modal-container"),N=c.targetDriveInfo,C=(0,a.useState)("idle"),D=(0,t.Z)(C,2),A=D[0],R=D[1],S=(0,f.Z)().fetch.data,G=(0,m.Z)({}).createOrUpdate.mutateAsync,O=(0,a.useState)([]),F=(0,t.Z)(O,2),I=F[0],q=F[1];if(!i)return null;var L=(0,w.jsx)(Z.Z,{title:n,onClose:b,children:(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)("form",{onSubmit:function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),R("loading"),e.prev=2,e.next=5,Promise.all(I.map(function(){var e=(0,p.Z)((0,d.Z)().mark((function e(n){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),R("error");case 10:return R("success"),j(),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(n){return e.apply(this,arguments)}}(),children:[null!==S&&void 0!==S&&S.length?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("h2",{className:"mb-2 flex flex-row text-xl",children:[(0,w.jsx)(y.Z,{className:"my-auto mr-2 h-4 w-4"})," ",(0,s.t)("Circles"),":"]}),S.map((function(e){var n,r=null===I||void 0===I?void 0:I.find((function(n){return n.id===e.id})),t=null===(n=(null!==r&&void 0!==r?r:e).driveGrants)||void 0===n?void 0:n.find((function(e){return e.permissionedDrive.drive.alias===N.alias&&e.permissionedDrive.drive.type===N.type}));return(0,w.jsxs)("div",{className:"mb-5 flex flex-row",children:[(0,w.jsx)("label",{htmlFor:"name",className:"my-auto mr-2",children:e.name}),(0,w.jsx)(g.Z,{className:"ml-auto",permissionLevels:x.Ac,defaultValue:null===t||void 0===t?void 0:t.permissionedDrive.permission,onChange:function(n){q([].concat((0,l.Z)(I.filter((function(n){return n.id!==e.id}))),[(0,u.Z)((0,u.Z)({},e),{},{driveGrants:[].concat((0,l.Z)(e.driveGrants.filter((function(e){return e.permissionedDrive.drive.alias!==N.alias&&e.permissionedDrive.drive.type!==N.type}))),[{permissionedDrive:{drive:(0,u.Z)({},N),permission:n}}])})]))}})]},e.id)}))]}):null,(0,w.jsxs)("div",{className:"-m-2 flex flex-row-reverse py-3",children:[(0,w.jsx)(o.Z,{className:"m-2",icon:"send",state:A,children:r||(0,s.t)("Save")}),(0,w.jsx)(o.Z,{className:"m-2",type:"secondary",onClick:b,children:(0,s.t)("Cancel")})]})]})})});return(0,v.createPortal)(L,k)},b=r(144),k=r(2405),N=r(8808),C=r(8491),D=r(7266),A=function(e){var n=e.driveDefinition,r=(0,f.Z)().fetch.data,t=(0,b.Z)().fetchRegistered.data,a=n.targetDriveInfo,i=null===r||void 0===r?void 0:r.filter((function(e){var n;return null===(n=e.driveGrants)||void 0===n?void 0:n.some((function(e){return e.permissionedDrive.drive.alias===a.alias&&e.permissionedDrive.drive.type===a.type}))})),c=null===t||void 0===t?void 0:t.filter((function(e){return e.grant.driveGrants.some((function(e){return e.permissionedDrive.drive.alias===a.alias&&e.permissionedDrive.drive.type===a.type}))}));return(0,w.jsxs)(w.Fragment,{children:[null!==i&&void 0!==i&&i.length?(0,w.jsx)(C.Z,{title:(0,s.t)("Circles with access:"),isOpaqueBg:!0,children:(0,w.jsx)("ul",{className:"-my-4",children:i.map((function(e){var n,r=e.driveGrants.find((function(e){return e.permissionedDrive.drive.alias===a.alias&&e.permissionedDrive.drive.type===a.type}));return(0,w.jsx)(N.Z,{circleDef:e,permissionLevel:(0,D.hz)(null===r||void 0===r||null===(n=r.permissionedDrive)||void 0===n?void 0:n.permission,x.Ac).name,className:"my-4"},e.id)}))})}):null,null!==c&&void 0!==c&&c.length?(0,w.jsx)(C.Z,{title:(0,s.t)("Apps with access:"),isOpaqueBg:!0,children:(0,w.jsx)("ul",{className:"-my-4",children:c.map((function(e){var n=e.grant.driveGrants.find((function(e){return e.permissionedDrive.drive.alias===a.alias&&e.permissionedDrive.drive.type===a.type}));return(0,w.jsx)(k.Z,{className:"my-4",appDef:e,permissionLevel:(0,D.hz)(null===n||void 0===n?void 0:n.permissionedDrive.permission,x.Ac).name},e.appId)}))})}):null]})},R=r(894),S=r(3004),G=r(8739),O=function(){var e,n=(0,i.UO)().driveKey.split("_"),r=(0,c.Z)({targetDrive:{alias:n[0],type:n[1]}}).fetch,u=r.data,l=r.isLoading,d=(0,a.useState)(!1),p=(0,t.Z)(d,2),v=p[0],m=p[1];return l?(0,w.jsx)(G.Z,{}):u?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(S.Z,{icon:R.Z,title:"".concat(u.name),actions:(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(o.Z,{onClick:function(){return m(!0)},className:"m-2",children:"Edit Access"})}),breadCrumbs:[{href:"/owner/drives",title:"My Drives"},{title:null!==(e=u.name)&&void 0!==e?e:""}]}),(0,w.jsxs)(C.Z,{title:(0,s.t)("Metadata"),isOpaqueBg:!0,children:[(0,w.jsx)("p",{children:u.metadata}),(0,w.jsxs)("ul",{children:[u.allowAnonymousReads?(0,w.jsx)("li",{children:"Allow Anonymous Reads"}):null,u.isReadonly?(0,w.jsx)("li",{children:"Read Only"}):null]})]}),(0,w.jsx)(A,{driveDefinition:u}),(0,w.jsx)(j,{driveDefinition:u,isOpen:v,onCancel:function(){m(!1)},onConfirm:function(){m(!1)},title:"".concat((0,s.t)("Edit access on")," ").concat(u.name)})]}):(0,w.jsx)(w.Fragment,{children:"No matching drive found"})}},144:function(e,n,r){var t=r(4165),a=r(5861),i=r(7408),s=r(4180),c=r(6117);n.Z=function(){var e=(0,c.Z)().getSharedSecret,n=s.Z.getInstance(e()),r=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.GetAppRegistrations();case 2:return r=e.sent,e.abrupt("return",null===r||void 0===r?void 0:r.sort((function(e,n){return(e.isRevoked?1:0)-(n.isRevoked?1:0)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{fetchRegistered:(0,i.useQuery)(["registeredApps"],(function(){return r()}),{refetchOnWindowFocus:!1})}}},4395:function(e,n,r){var t=r(4165),a=r(5861),i=r(7408),s=r(3766),c=r(6117);n.Z=function(){var e=(0,c.Z)().getSharedSecret,n=s.k.getInstance(e()),r=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getCircles();case 2:return r=e.sent,e.abrupt("return",null===r||void 0===r?void 0:r.sort((function(e,n){return(e.disabled?1:0)-(n.disabled?1:0)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["circles"],(function(){return r()}),{refetchOnWindowFocus:!1})}}},1512:function(e,n,r){var t=r(4165),a=r(5861),i=r(7408),s=r(1803),c=r(6117);n.Z=function(e){var n=e.targetDrive,r=(0,c.Z)().getSharedSecret,o=new s.AO({api:s.Ii.Owner,sharedSecret:r()}),u=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n){var r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.driveProvider.GetDrives({pageNumber:1,pageSize:100});case 2:return e.next=4,e.sent.results;case 4:return r=e.sent,e.abrupt("return",r.find((function(e){return e.targetDriveInfo.alias===n.alias&&e.targetDriveInfo.type===n.type})));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["drive","".concat(n.alias,"_").concat(n.type)],(function(){return u(n)}),{refetchOnWindowFocus:!1})}}},4180:function(e,n,r){r.d(n,{Z:function(){return u}});var t=r(4165),a=r(5861),i=r(5671),s=r(3144),c=r(9340),o=r(1129),u=function(e){(0,c.Z)(r,e);var n=(0,o.Z)(r);function r(e){return(0,i.Z)(this,r),n.call(this,e)}return(0,s.Z)(r,[{key:"RegisterAppClient",value:function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n){var r,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.createAxiosClient(),e.next=3,r.post("appmanagement/register/client",n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"RegisterChatAppClient_temp",value:function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n){var r,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.createAxiosClient(),e.next=3,r.post("appmanagement/register/chatclient_temp",n);case 3:return a=e.sent,console.log("RegisterChatAppClient_temp returning response"),console.log(a),e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"RegisterApp",value:function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n){var r,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.createAxiosClient(),e.next=3,r.post("appmanagement/register/app",n);case 3:return a=e.sent,console.log("RegisterApp returning response"),console.log(a),e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"GetAppRegistration",value:function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n){var r,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.createAxiosClient(),e.next=3,r.post("appmanagement/app",n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"GetAppRegistrations",value:function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var n,r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.createAxiosClient(),e.next=3,n.get("appmanagement/list");case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"RevokeApp",value:function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n){var r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.createAxiosClient(),e.next=3,r.post("appmanagement/revoke",n);case 3:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"AllowApp",value:function(){var e=(0,a.Z)((0,t.Z)().mark((function e(n){var r,a;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.createAxiosClient(),e.next=3,r.post("appmanagement/allow",n);case 3:a=e.sent,console.log(a);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(e){return r.instance||(r.instance=new r(e)),r.instance}}]),r}(r(2008).$);u.instance=void 0},2562:function(e,n,r){r.d(n,{Ac:function(){return a},WW:function(){return i},c$:function(){return s}});var t=r(4990),a=[{name:(0,t.t)("None"),value:0},{name:(0,t.t)("Reader"),value:1},{name:(0,t.t)("Editor"),value:3}],i=[{name:(0,t.t)("None"),value:0},{name:(0,t.t)("Read Connections"),value:10},{name:(0,t.t)("Read Circle Members"),value:50}],s=[{name:(0,t.t)("None"),value:0},{name:(0,t.t)("Read Connections"),value:10},{name:(0,t.t)("Manage Connection Requests"),value:30},{name:(0,t.t)("Read Circle Members"),value:50}]}}]);
//# sourceMappingURL=704.b91907b4.chunk.js.map