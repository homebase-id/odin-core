{"version":3,"file":"static/js/603.5671559b.chunk.js","mappings":"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","sources":["components/Form/PermissionLevelEditor.tsx","components/Icons/Triangle/Triangle.tsx","components/Sections/Section.tsx","components/Dialog/DriveAccessDialog/DriveAccessDialog.tsx","components/PermissionViews/AppPermissionView/AppPermissionView.tsx","components/Templates/Drives/DrivePermissionOverview/DrivePermissionOverview.tsx","components/Templates/DriveDetails/DriveDetails.tsx","hooks/apps/useApps.ts","hooks/circles/useCircles.ts","provider/app/AppManagementProvider.ts"],"sourcesContent":["import { ReactNode, useRef, useState } from 'react';\nimport useOutsideTrigger from '../../hooks/clickedOutsideTrigger/useClickedOutsideTrigger';\nimport Check from '../Icons/Check/Check';\nimport Triangle from '../Icons/Triangle/Triangle';\n\nconst PermissionLevelEditor = ({\n  className,\n  permissionLevels,\n  onChange,\n  defaultValue,\n}: {\n  className: string;\n  permissionLevels: { name: string; value: number }[];\n  onChange?: (value: number) => void;\n  defaultValue: number;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [value, setInnerValue] = useState(defaultValue);\n  const wrapperRef = useRef(null);\n  useOutsideTrigger(wrapperRef, () => setIsOpen(false));\n\n  const currentValue = permissionLevels.reduce((prevValue, currValue) => {\n    if (currValue.value > prevValue.value && currValue.value <= defaultValue) {\n      return currValue;\n    }\n\n    return prevValue;\n  }, permissionLevels[0]);\n\n  const setValue = (value: number) => {\n    setInnerValue(value);\n    onChange(value);\n  };\n\n  return (\n    <div className={className ?? ''}>\n      <div\n        className=\"relative cursor-pointer rounded-md bg-slate-100 dark:bg-slate-800\"\n        onClick={() => setIsOpen(!isOpen)}\n        ref={wrapperRef}\n      >\n        <div className=\"flex min-w-[6rem] flex-row py-1 px-2\">\n          <span className=\"my-auto mr-2 select-none\">{currentValue.name}</span>{' '}\n          <Triangle className=\"my-auto ml-auto h-2 w-2 rotate-90\" />\n        </div>\n        <ul\n          className={`absolute top-[100%] right-0 overflow-hidden bg-white dark:bg-slate-800 ${\n            isOpen\n              ? 'z-10 max-h-[30rem] border border-slate-100 py-3 shadow-2xl dark:border-slate-700'\n              : 'max-h-0'\n          }`}\n        >\n          {permissionLevels.map((level) => (\n            <Option\n              key={level.value}\n              isChecked={level.value === 0 ? value === level.value : value >= level.value}\n              onChange={() => (value !== level.value ? setValue(level.value) : setValue(0))}\n            >\n              {level.name}\n            </Option>\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nconst Option = ({\n  className,\n  isChecked,\n  children,\n  onChange,\n}: {\n  className?: string;\n  isChecked: boolean;\n  children: ReactNode;\n  onChange: () => void;\n}) => {\n  return (\n    <li\n      className={`flex min-w-[6rem] cursor-pointer select-none flex-row py-1 px-4 hover:bg-slate-100 dark:hover:bg-slate-700 ${className}`}\n      onClick={onChange}\n    >\n      <Check\n        className={`my-auto mr-3 h-4 w-4 flex-shrink-0  ${\n          isChecked ? 'text-slate-700 dark:text-slate-200' : 'text-transparent'\n        }`}\n      />{' '}\n      <span className={`mr-auto block h-full py-1`}>{children}</span>\n    </li>\n  );\n};\n\nexport default PermissionLevelEditor;\n","import { FC } from 'react';\n\nconst Triangle: FC<IconProps> = ({ className }) => {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 384 512\"\n      fill=\"currentColor\"\n      className={className}\n    >\n      <path d=\"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z\" />\n    </svg>\n  );\n};\n\nexport default Triangle;\n","import { ReactNode } from 'react';\n\nconst Section = ({\n  title,\n  className,\n  children,\n  isOpaqueBg = false,\n  isBorderLess = false,\n}: {\n  title?: ReactNode;\n  className?: string;\n  children: ReactNode;\n  isOpaqueBg?: boolean;\n  isBorderLess?: boolean;\n}) => {\n  return (\n    <section\n      className={`my-5 rounded-md ${\n        isOpaqueBg\n          ? isBorderLess\n            ? ''\n            : 'rounded-lg border-[1px] border-gray-200 border-opacity-80 px-5 dark:border-gray-700'\n          : 'bg-slate-50 px-5 dark:bg-slate-800'\n      } dark:text-slate-300 ${className ?? ''}`}\n    >\n      {title ? (\n        <div\n          className={`relative border-b-[1px] border-gray-200 border-opacity-80 py-5 transition-all duration-300 dark:border-gray-700`}\n        >\n          <h3 className=\"text-2xl dark:text-white\">{title}</h3>\n        </div>\n      ) : null}\n      <div className=\"py-5 \">{children}</div>\n    </section>\n  );\n};\n\nexport default Section;\n","import { DriveDefinition } from '@youfoundation/transit-lib';\nimport { useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { t } from '../../../helpers/i18n/dictionary';\nimport useCircle from '../../../hooks/circle/useCircle';\nimport useCircles from '../../../hooks/circles/useCircles';\nimport usePortal from '../../../hooks/portal/usePortal';\nimport { CircleDefinition } from '../../../provider/connections/CircleDataTypes';\nimport { drivePermissionLevels } from '../../../provider/permission/permissionLevels';\nimport ActionButton, { ActionButtonState } from '../../Buttons/ActionButton';\nimport PermissionLevelEditor from '../../Form/PermissionLevelEditor';\nimport Circles from '../../Icons/Circles/Circles';\nimport DialogWrapper from '../Common/DialogWrapper';\n\nconst DriveAccessDialog = ({\n  title,\n  confirmText,\n\n  isOpen,\n  driveDefinition,\n\n  onConfirm,\n  onCancel,\n}: {\n  title: string;\n  confirmText?: string;\n\n  isOpen: boolean;\n  driveDefinition: DriveDefinition;\n\n  onConfirm: () => void;\n  onCancel: () => void;\n}) => {\n  const target = usePortal('modal-container');\n\n  const targetDriveInfo = driveDefinition.targetDriveInfo;\n\n  const [saveState, setSaveState] = useState<ActionButtonState>('idle');\n\n  const { data: circles } = useCircles().fetch;\n  const { mutateAsync: updateCircle } = useCircle({}).createOrUpdate;\n\n  // TODO: Add apps as well\n  // const { data: apps } = useApps().fetchRegistered;\n\n  const [newCircles, setNewCircles] = useState<CircleDefinition[]>([]);\n\n  if (!isOpen) {\n    return null;\n  }\n\n  const dialog = (\n    <DialogWrapper title={title} onClose={onCancel}>\n      <>\n        <form\n          onSubmit={async (e) => {\n            e.preventDefault();\n            setSaveState('loading');\n\n            try {\n              await Promise.all(newCircles.map(async (circle) => await updateCircle(circle)));\n            } catch (ex) {\n              setSaveState('error');\n            }\n            setSaveState('success');\n\n            onConfirm();\n            return false;\n          }}\n        >\n          {circles?.length ? (\n            <>\n              <h2 className=\"mb-2 flex flex-row text-xl\">\n                <Circles className=\"my-auto mr-2 h-4 w-4\" /> {t('Circles')}:\n              </h2>\n              {circles.map((circle) => {\n                const matchingNewCircle = newCircles?.find(\n                  (newCircle) => newCircle.id === circle.id\n                );\n\n                const driveGrant = (matchingNewCircle ?? circle).driveGrants?.find(\n                  (driveGrant) =>\n                    driveGrant.permissionedDrive.drive.alias === targetDriveInfo.alias &&\n                    driveGrant.permissionedDrive.drive.type === targetDriveInfo.type\n                );\n\n                return (\n                  <div className=\"mb-5 flex flex-row\" key={circle.id}>\n                    <label htmlFor=\"name\" className=\"my-auto mr-2\">\n                      {circle.name}\n                    </label>\n                    <PermissionLevelEditor\n                      className=\"ml-auto\"\n                      permissionLevels={drivePermissionLevels}\n                      defaultValue={driveGrant?.permissionedDrive.permission}\n                      onChange={(newValue) => {\n                        setNewCircles([\n                          ...newCircles.filter((circleToUpdate) => circleToUpdate.id !== circle.id),\n                          {\n                            ...circle,\n\n                            driveGrants: [\n                              ...circle.driveGrants.filter(\n                                (driveGrant) =>\n                                  driveGrant.permissionedDrive.drive.alias !==\n                                    targetDriveInfo.alias &&\n                                  driveGrant.permissionedDrive.drive.type !== targetDriveInfo.type\n                              ),\n                              {\n                                permissionedDrive: {\n                                  drive: { ...targetDriveInfo },\n                                  permission: newValue,\n                                },\n                              },\n                            ],\n                          },\n                        ]);\n                      }}\n                    />\n                  </div>\n                );\n              })}\n            </>\n          ) : null}\n          <div className=\"-m-2 flex flex-row-reverse py-3\">\n            <ActionButton className=\"m-2\" icon={'send'} state={saveState}>\n              {confirmText || t('Save')}\n            </ActionButton>\n            <ActionButton className=\"m-2\" type=\"secondary\" onClick={onCancel}>\n              {t('Cancel')}\n            </ActionButton>\n          </div>\n        </form>\n      </>\n    </DialogWrapper>\n  );\n\n  return createPortal(dialog, target);\n};\n\nexport default DriveAccessDialog;\n","import { Link } from 'react-router-dom';\nimport { RedactedAppRegistration } from '../../../provider/app/AppManagementProviderTypes';\nimport Circles from '../../Icons/Circles/Circles';\n\nconst AppMembershipView = ({\n  appDef,\n  permissionLevel,\n}: {\n  appDef: RedactedAppRegistration;\n  permissionLevel?: string;\n}) => {\n  if (!appDef) {\n    return <></>;\n  }\n\n  return (\n    <div className=\"mb-4\">\n      <Link to={`/owner/apps/${appDef.appId}`}>\n        <h2 className=\"mb-2 flex flex-row text-xl\">\n          <Circles className=\"my-auto mr-2 h-4 w-4\" />{' '}\n          <span className=\"my-auto\">{appDef.name}</span>\n          {permissionLevel && <span className=\"my-auto\">: {permissionLevel}</span>}\n        </h2>\n      </Link>\n    </div>\n  );\n};\n\nexport default AppMembershipView;\n","import { DriveDefinition } from '@youfoundation/transit-lib';\nimport { t } from '../../../../helpers/i18n/dictionary';\nimport useApps from '../../../../hooks/apps/useApps';\nimport useCircles from '../../../../hooks/circles/useCircles';\nimport { drivePermissionLevels } from '../../../../provider/permission/permissionLevels';\nimport AppMembershipView from '../../../PermissionViews/AppPermissionView/AppPermissionView';\nimport CircleMembershipView from '../../../PermissionViews/CirclePermissionView/CirclePermissionView';\nimport Section from '../../../Sections/Section';\nimport { getAccessFromPermissionNumber } from '../../DemoData/helpers';\n\nconst DrivePermissionOverview = ({ driveDefinition }: { driveDefinition: DriveDefinition }) => {\n  const { data: circles } = useCircles().fetch;\n  const { data: apps } = useApps().fetchRegistered;\n\n  const targetDriveInfo = driveDefinition.targetDriveInfo;\n\n  const circlesWithAGrantOnThis = circles?.filter((circle) =>\n    circle.driveGrants?.some(\n      (grant) =>\n        grant.permissionedDrive.drive.alias === targetDriveInfo.alias && grant.permissionedDrive.drive.type === targetDriveInfo.type\n    )\n  );\n\n  const appsWithAGrantOnThis = apps?.filter((app) =>\n    app.grant.driveGrants.some(\n      (grant) =>\n        grant.permissionedDrive.drive.alias === targetDriveInfo.alias && grant.permissionedDrive.drive.type === targetDriveInfo.type\n    )\n  );\n\n  return (\n    <>\n      {circlesWithAGrantOnThis?.length ? (\n        <Section title={t('Circles with access:')} isOpaqueBg={true}>\n          <ul>\n            {circlesWithAGrantOnThis.map((circle) => {\n              const matchingGrant = circle.driveGrants.find(\n                (grant) =>\n                  grant.permissionedDrive.drive.alias === targetDriveInfo.alias &&\n                  grant.permissionedDrive.drive.type === targetDriveInfo.type\n              );\n              return (\n                <CircleMembershipView\n                  circleDef={circle}\n                  key={circle.id}\n                  permissionLevel={\n                    getAccessFromPermissionNumber(matchingGrant?.permissionedDrive?.permission, drivePermissionLevels)\n                      .name\n                  }\n                />\n              );\n            })}\n          </ul>\n        </Section>\n      ) : null}\n\n      {appsWithAGrantOnThis?.length ? (\n        <Section title={t('Apps with access:')} isOpaqueBg={true}>\n          <ul>\n            {appsWithAGrantOnThis.map((app) => {\n              const matchingGrant = app.grant.driveGrants.find(\n                (grant) =>\n                  grant.permissionedDrive.drive.alias === targetDriveInfo.alias &&\n                  grant.permissionedDrive.drive.type === targetDriveInfo.type\n              );\n              return (\n                <AppMembershipView\n                  appDef={app}\n                  key={app.appId}\n                  permissionLevel={\n                    getAccessFromPermissionNumber(matchingGrant?.permissionedDrive.permission, drivePermissionLevels)\n                      .name\n                  }\n                />\n              );\n            })}\n          </ul>\n        </Section>\n      ) : null}\n    </>\n  );\n};\n\nexport default DrivePermissionOverview;\n","import { useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { t } from '../../../helpers/i18n/dictionary';\nimport useDrive from '../../../hooks/drive/useDrive';\nimport ActionButton from '../../Buttons/ActionButton';\nimport DriveAccessDialog from '../../Dialog/DriveAccessDialog/DriveAccessDialog';\nimport DrivePermissionOverview from '../Drives/DrivePermissionOverview/DrivePermissionOverview';\nimport HardDrive from '../../Icons/HardDrive/HardDrive';\nimport PageMeta from '../../Layout/PageMeta/PageMeta';\nimport Section from '../../Sections/Section';\nimport LoadingDetailPage from '../../Loaders/LoadingDetailPage/LoadingDetailPage';\n\nconst DriveDetails = () => {\n  const { driveKey } = useParams();\n  const splittedDriveKey = driveKey.split('_');\n  const {\n    fetch: { data: driveDef, isLoading: driveDefLoading },\n  } = useDrive({ targetDrive: { alias: splittedDriveKey[0], type: splittedDriveKey[1] } });\n\n  const [isEditAccess, setIsEditAccess] = useState(false);\n\n  if (driveDefLoading) {\n    return <LoadingDetailPage />;\n  }\n\n  if (!driveDef) {\n    return <>No matching drive found</>;\n  }\n\n  return (\n    <>\n      <PageMeta\n        icon={HardDrive}\n        title={`${driveDef.name}`}\n        actions={\n          <>\n            <ActionButton onClick={() => setIsEditAccess(true)} className=\"m-2\">\n              Edit Access\n            </ActionButton>\n          </>\n        }\n        breadCrumbs={[\n          { href: '/owner/drives', title: 'My Drives' },\n          { title: driveDef.name ?? '' },\n        ]}\n      />\n      <Section title={t('Metadata')} isOpaqueBg={true}>\n        <p>{driveDef.metadata}</p>\n        <ul>\n          {driveDef.allowAnonymousReads ? <li>Allow Anonymous Reads</li> : null}\n          {driveDef.isReadonly ? <li>Read Only</li> : null}\n        </ul>\n      </Section>\n\n      <DrivePermissionOverview driveDefinition={driveDef} />\n\n      <DriveAccessDialog\n        driveDefinition={driveDef}\n        isOpen={isEditAccess}\n        onCancel={() => {\n          setIsEditAccess(false);\n        }}\n        onConfirm={() => {\n          setIsEditAccess(false);\n        }}\n        title={`${t('Edit access on')} ${driveDef.name}`}\n      />\n    </>\n  );\n};\n\nexport default DriveDetails;\n","import { useQuery } from '@tanstack/react-query';\nimport AppManagementProvider from '../../provider/app/AppManagementProvider';\nimport useAuth from '../auth/useAuth';\n\nconst useApps = () => {\n  const { getSharedSecret } = useAuth();\n\n  const appManagementProvider = AppManagementProvider.getInstance(getSharedSecret());\n\n  const fetchRegistered = async () => {\n    const apps = await appManagementProvider.GetAppRegistrations();\n    return apps?.sort((a, b) => (a.isRevoked ? 1 : 0) - (b.isRevoked ? 1 : 0));\n  };\n\n  return {\n    fetchRegistered: useQuery(['registeredApps'], () => fetchRegistered(), {\n      refetchOnWindowFocus: false,\n    }),\n  };\n};\n\nexport default useApps;\n","import { useQuery } from '@tanstack/react-query';\nimport { CircleProvider } from '../../provider/connections/CircleProvider';\nimport useAuth from '../auth/useAuth';\n\nconst useCircles = () => {\n  const { getSharedSecret } = useAuth();\n  const circleProvider = CircleProvider.getInstance(getSharedSecret());\n\n  const fetchAll = async () => {\n    return await circleProvider.getCircles();\n  };\n\n  return {\n    fetch: useQuery(['circles'], () => fetchAll(), {\n      refetchOnWindowFocus: false,\n    }),\n  };\n};\n\nexport default useCircles;\n","import {\n  AppClientRegistrationRequest,\n  AppClientRegistrationResponse,\n  AppRegistrationRequest,\n  RedactedAppRegistration,\n  GetAppRequest,\n} from './AppManagementProviderTypes';\nimport { OwnerProviderBase } from '../OwnerProviderBase';\n\nexport default class AppManagementProvider extends OwnerProviderBase {\n  private static instance: AppManagementProvider;\n  constructor(sharedSecret: Uint8Array | undefined) {\n    super(sharedSecret);\n  }\n\n  //adds the specified client to the list of allowed clients for a given app; returns a CAT\n  async RegisterAppClient(\n    request: AppClientRegistrationRequest\n  ): Promise<AppClientRegistrationResponse> {\n    const client = this.createAxiosClient();\n    const response = await client.post<AppClientRegistrationResponse>(\n      'appmanagement/register/client',\n      request\n    );\n    return response.data;\n  }\n\n  async RegisterChatAppClient_temp(\n    request: AppClientRegistrationRequest\n  ): Promise<AppClientRegistrationResponse> {\n    const client = this.createAxiosClient();\n    const response = await client.post<AppClientRegistrationResponse>(\n      'appmanagement/register/chatclient_temp',\n      request\n    );\n    console.log('RegisterChatAppClient_temp returning response');\n    console.log(response);\n\n    return response.data;\n  }\n\n  async RegisterApp(request: AppRegistrationRequest): Promise<RedactedAppRegistration> {\n    const client = this.createAxiosClient();\n    const response = await client.post<RedactedAppRegistration>(\n      'appmanagement/register/app',\n      request\n    );\n\n    console.log('RegisterApp returning response');\n    console.log(response);\n\n    return response.data;\n  }\n\n  async GetAppRegistration(request: GetAppRequest): Promise<RedactedAppRegistration> {\n    const client = this.createAxiosClient();\n    const response = await client.post<RedactedAppRegistration>('appmanagement/app', request);\n    return response.data;\n  }\n\n  async GetAppRegistrations(): Promise<RedactedAppRegistration[]> {\n    const client = this.createAxiosClient();\n    const response = await client.get<RedactedAppRegistration[]>('appmanagement/list');\n    return response.data;\n  }\n\n  async RevokeApp(request: GetAppRequest): Promise<void> {\n    const client = this.createAxiosClient();\n    await client.post('appmanagement/revoke', request);\n  }\n\n  async AllowApp(request: GetAppRequest): Promise<void> {\n    const client = this.createAxiosClient();\n    const response = await client.post('appmanagement/allow', request);\n    console.log(response);\n  }\n\n  public static getInstance(sharedSecret): AppManagementProvider {\n    if (!AppManagementProvider.instance) {\n      AppManagementProvider.instance = new AppManagementProvider(sharedSecret);\n    }\n\n    return AppManagementProvider.instance;\n  }\n}\n"],"names":["Option","className","isChecked","children","onChange","onClick","permissionLevels","defaultValue","useState","isOpen","setIsOpen","value","setInnerValue","wrapperRef","useRef","useOutsideTrigger","currentValue","reduce","prevValue","currValue","setValue","ref","name","map","level","xmlns","viewBox","fill","d","title","isOpaqueBg","isBorderLess","confirmText","driveDefinition","onConfirm","onCancel","target","usePortal","targetDriveInfo","saveState","setSaveState","circles","useCircles","fetch","data","updateCircle","useCircle","createOrUpdate","mutateAsync","newCircles","setNewCircles","dialog","DialogWrapper","onClose","onSubmit","e","preventDefault","Promise","all","circle","length","Circles","t","matchingNewCircle","find","newCircle","id","driveGrant","driveGrants","permissionedDrive","drive","alias","type","htmlFor","PermissionLevelEditor","drivePermissionLevels","permission","newValue","filter","circleToUpdate","ActionButton","icon","state","createPortal","appDef","permissionLevel","to","appId","apps","useApps","fetchRegistered","circlesWithAGrantOnThis","some","grant","appsWithAGrantOnThis","app","Section","matchingGrant","circleDef","getAccessFromPermissionNumber","splittedDriveKey","useParams","driveKey","split","useDrive","targetDrive","driveDef","driveDefLoading","isLoading","isEditAccess","setIsEditAccess","LoadingDetailPage","PageMeta","HardDrive","actions","breadCrumbs","href","metadata","allowAnonymousReads","isReadonly","getSharedSecret","useAuth","appManagementProvider","AppManagementProvider","GetAppRegistrations","sort","a","b","isRevoked","useQuery","refetchOnWindowFocus","circleProvider","CircleProvider","fetchAll","getCircles","sharedSecret","request","client","this","createAxiosClient","post","response","console","log","get","instance","OwnerProviderBase"],"sourceRoot":""}