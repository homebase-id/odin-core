"use strict";(self.webpackChunkowner_app=self.webpackChunkowner_app||[]).push([[731],{8532:function(e,n,t){var r=t(3433),o=t(4165),a=t(5861),i=t(9439),c=t(2791),s=t(4164),u=t(4990),d=t(4395),l=t(7903),f=t(7148),v=t(3412),p=t(9072),m=t(4940),h=t(6234),x=t(8808),g=t(8395),b=t(184);n.Z=function(e){var n,t,Z,y,I=e.title,w=e.confirmText,k=e.senderDotYouId,j=e.isOpen,C=e.onConfirm,N=e.onCancel,S=(0,v.Z)("modal-container"),D=(0,l.Z)({}).acceptRequest,Q=D.mutateAsync,q=D.status,R=(0,d.Z)().fetch.data,Y=(0,f.Z)(),A=(0,c.useState)(),P=(0,i.Z)(A,2),F=P[0],M=P[1],O=(0,c.useState)(null),V=(0,i.Z)(O,2),G=V[0],L=V[1],E=(0,c.useState)([]),H=(0,i.Z)(E,2),U=H[0],W=H[1];if(!j)return null;var B=(0,b.jsx)(g.Z,{title:I,onClose:N,size:"2xlarge",children:(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("form",{onSubmit:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,Q({senderDotYouId:k,name:F,photoFileId:G,circleIds:U});case 3:Y(),C();case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:[(0,b.jsx)("div",{className:"mt-2",children:"".concat(k," ").concat((0,u.t)("has sent you a connection request"))}),(0,b.jsxs)("h2",{className:"mb-2 text-lg",children:[(0,u.t)("Your contact info"),":"]}),(0,b.jsxs)("div",{className:"mb-5",children:[(0,b.jsxs)("label",{htmlFor:"dotyouid",children:[(0,u.t)("Name"),":"]}),(0,b.jsx)(m.Z,{id:"name",name:"name",required:!0,onChange:function(e){var n=e.target.value.split("+");M({givenName:n[0],surname:n[1]})}})]}),(0,b.jsxs)("div",{className:"mb-5",children:[(0,b.jsxs)("label",{htmlFor:"name",children:[(0,u.t)("Photo"),":"]}),(0,b.jsx)(h.Z,{defaultValue:G,id:"photo",onChange:function(e){L(e.target.value||void 0)},fallbackInitials:"".concat(null!==(n=null===F||void 0===F||null===(t=F.givenName)||void 0===t?void 0:t[0])&&void 0!==n?n:"").concat(null!==(Z=null===F||void 0===F||null===(y=F.surname)||void 0===y?void 0:y[0])&&void 0!==Z?Z:"")})]}),R.length?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("h2",{className:"mb-2 text-lg",children:[(0,u.t)("Add as member to one or more circles"),":"]}),R.map((function(e,n){var t,o=U.some((function(n){return n===e.id}));return(0,b.jsx)(x.Z,{circleDef:e,className:"my-4 w-full rounded-lg border p-4",isChecked:o,onClick:function(){var n=(0,r.Z)(U);n.some((function(n){return n===e.id}))?W(n.filter((function(n){return n!==e.id}))):(n.push(e.id),W(n))}},null!==(t=e.id)&&void 0!==t?t:n)}))]}):null,(0,b.jsxs)("div",{className:"-m-2 flex flex-row-reverse py-3",children:[(0,b.jsx)(p.Z,{className:"m-2",icon:"send",state:q,children:null!==w&&void 0!==w?w:(0,u.t)("Accept")}),(0,b.jsx)(p.Z,{className:"m-2",type:"secondary",onClick:function(){Y(),N()},children:(0,u.t)("Cancel")})]})]})})});return(0,s.createPortal)(B,S)}},4940:function(e,n,t){var r=t(1413),o=t(6752),a=t(4990),i=t(470),c=t(3225),s=t(184);n.Z=function(e){var n=(0,i.Z)({profileId:o.P.StandardProfileId.toString(),type:o.H1.Name.type}).fetchVersions,t=n.data,u=n.isLoading,d=null===t||void 0===t?void 0:t.filter((function(e){var n,t;return void 0!==e.data&&0!==(null===(n=Object.keys(e.data))||void 0===n?void 0:n.length)&&(null===(t=e.acl)||void 0===t?void 0:t.requiredSecurityGroup)===o.hh.Anonymous}));return(0,s.jsxs)(c.Z,(0,r.Z)((0,r.Z)({},e),{},{children:[(0,s.jsxs)("option",{children:["-- ",(0,a.t)("Choose a name")," --"]}),u&&(0,s.jsx)("option",{children:"Loading..."}),null===d||void 0===d?void 0:d.filter((function(e){return void 0!==e.data})).map((function(n){var t="".concat(n.data[o.mA.GivenNameId],"+").concat(n.data[o.mA.SurnameId]);return(0,s.jsxs)("option",{value:t,defaultChecked:e.defaultValue===t,children:["".concat(n.data[o.mA.GivenNameId]," ").concat(n.data[o.mA.SurnameId])," ","(",window.location.hostname,")"]},t)}))]}))}},6234:function(e,n,t){var r=t(6752),o=t(9779),a=t(470),i=t(5300),c=t(184),s=function(e){var n=e.value,t=e.onClick,a=e.isActive,s=(0,o.Z)((null===n||void 0===n?void 0:n.length)>2?n:void 0,(0,r.H3)(r.P.StandardProfileId.toString())).fetch.data;return(0,c.jsx)("li",{onClick:function(){t&&t(a?void 0:n)},className:"mr-1 cursor-pointer list-none rounded-lg border-[3px] p-[1px] ".concat(a?"overflow-hidden border-indigo-500 dark:border-indigo-700":"border-transparent hover:border-slate-100"," "),children:s?(0,c.jsx)("img",{src:s,className:"max-h-[5rem] rounded-md"}):(0,c.jsx)(i.Z,{initials:null!==n&&void 0!==n?n:"?",className:"aspect-square h-[5rem] w-[5rem] rounded-md sm:text-4xl"})},n)};n.Z=function(e){var n=e.defaultValue,t=e.onChange,o=e.id,i=e.className,u=e.fallbackInitials,d=(0,a.Z)({profileId:r.P.StandardProfileId.toString(),type:r.H1.Photo.type}).fetchVersions,l=d.data,f=d.isLoading,v=null===l||void 0===l?void 0:l.filter((function(e){var n;return void 0!==e.data&&0!==Object.keys(e.data).length&&(null===(n=e.acl)||void 0===n?void 0:n.requiredSecurityGroup)===r.hh.Anonymous}));return(0,c.jsxs)("ul",{id:o,className:"flex w-full flex-row flex-wrap rounded border border-gray-300 bg-white p-2 text-base leading-8 text-gray-700 outline-none transition-colors duration-200 ease-in-out focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 ".concat(i),children:[f&&(0,c.jsx)("li",{className:"w-full p-3",children:"Loading..."}),(0,c.jsx)(s,{onClick:function(){t({target:{value:void 0}})},value:u,isActive:!n},"empty"),null===v||void 0===v?void 0:v.map((function(e){return(0,c.jsx)(s,{onClick:function(e){t({target:{value:e}})},value:e.data[r.mA.ProfileImageId],isActive:n===e.data[r.mA.ProfileImageId]},e.id)}))]})}},3225:function(e,n,t){var r=t(1413),o=t(184);n.Z=function(e){return(0,o.jsx)("select",(0,r.Z)((0,r.Z)({},e),{},{className:"w-full rounded border border-gray-300 bg-white py-1 px-3 text-base leading-8 text-gray-700 outline-none transition-colors duration-200 ease-in-out focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 ".concat(e.className),children:e.children}))}},8808:function(e,n,t){var r=t(3504),o=t(4990),a=t(7480),i=t(4665),c=t(4648),s=t(715),u=t(184);n.Z=function(e){var n=e.circleDef,t=e.permissionDetails,d=e.className,l=e.isChecked,f=e.onClick,v=(0,a.Z)({circleId:null===n||void 0===n?void 0:n.id}).fetchMembers.data;if(!n)return(0,u.jsx)(u.Fragment,{});var p=function(e){var t=e.children;return f?(0,u.jsx)(u.Fragment,{children:t}):(0,u.jsx)(r.rU,{to:"/owner/circles/".concat(encodeURIComponent(n.id)),className:"contents hover:text-slate-700 hover:underline dark:hover:text-slate-400",children:t})},m=l?"border-indigo-500 bg-slate-50 dark:border-indigo-700 dark:bg-slate-700":!1===l?"border-slate-100":"";return(0,u.jsx)("div",{className:"flex flex-row ".concat(null!==d&&void 0!==d?d:""," ").concat(n.disabled&&"opacity-50"," ").concat(f&&"cursor-pointer"," ").concat(m),onClick:function(){return f&&f()},children:(0,u.jsxs)(p,{children:[l?(0,u.jsx)(c.Z,{className:"mt-1 mb-auto mr-3 h-6 w-6"}):(0,u.jsx)(s.Z,{className:"mt-1 mb-auto mr-3 h-6 w-6"}),(0,u.jsxs)("div",{className:"mr-2 flex flex-col",children:[(0,u.jsxs)("p",{className:"my-auto leading-none",children:[n.disabled&&(0,o.t)("Disabled:")," ",null===n||void 0===n?void 0:n.name,t&&": ".concat(t)]}),(0,u.jsxs)("small",{className:"block",children:[v?"".concat(v.length," ").concat(1===v.length?(0,o.t)("member"):(0,o.t)("members")," ").concat((0,o.t)("receives")," "):null,null!==n&&void 0!==n&&n.driveGrants?"".concat((0,o.t)("access on")," ").concat(n.driveGrants.length," ").concat(n.driveGrants.length>=2?(0,o.t)("drives"):(0,o.t)("drive")):null]})]}),!f&&(0,u.jsx)(i.Z,{className:"my-auto ml-2 h-5 w-5"})]})})}},8491:function(e,n,t){var r=t(184);n.Z=function(e){var n=e.title,t=e.className,o=e.children,a=e.isOpaqueBg,i=void 0!==a&&a,c=e.isBorderLess,s=void 0!==c&&c;return(0,r.jsxs)("section",{className:"my-5 rounded-md ".concat(i?s?"":"rounded-lg border-[1px] border-gray-200 border-opacity-80 px-5 dark:border-gray-700":"bg-slate-50 px-5 dark:bg-slate-800"," dark:text-slate-300 ").concat(null!==t&&void 0!==t?t:""),children:[n?(0,r.jsx)("div",{className:"relative border-b-[1px] border-gray-200 border-opacity-80 py-5 transition-all duration-300 dark:border-gray-700",children:(0,r.jsx)("h3",{className:"text-2xl dark:text-white",children:n})}):null,(0,r.jsx)("div",{className:"py-5 ",children:o})]})}},4395:function(e,n,t){var r=t(4165),o=t(5861),a=t(7408),i=t(3766),c=t(6117);n.Z=function(){var e=(0,c.Z)().getSharedSecret,n=i.k.getInstance(e()),t=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getCircles();case 2:return t=e.sent,e.abrupt("return",null===t||void 0===t?void 0:t.sort((function(e,n){return(e.disabled?1:0)-(n.disabled?1:0)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{fetch:(0,a.useQuery)(["circles"],(function(){return t()}),{refetchOnWindowFocus:!1})}}},7903:function(e,n,t){var r=t(3433),o=t(4165),a=t(5861),i=t(7408),c=t(7186),s=t(5144),u=t(6117);n.Z=function(e){var n=e.dotYouId,t=(0,i.useQueryClient)(),d=(0,u.Z)().getSharedSecret,l=c.I.getInstance(d()),f=s.e.getInstance(d()),v=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var t,r,a,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.dotYouId){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,l.getConnectionInfo(t);case 5:if(!(r=e.sent)||"none"===r.status.toLowerCase()){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,f.getPendingRequest(t);case 10:if(!(a=e.sent)){e.next=13;break}return e.abrupt("return",a);case 13:return e.next=15,f.getSentRequest(t);case 15:return i=e.sent,e.abrupt("return",null!==i&&void 0!==i?i:r);case 17:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),p=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(t){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connectionDotYouId,e.next=3,l.disconnectFromContact(null!==r&&void 0!==r?r:n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),m=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var t,r,a,i,c;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.targetDotYouId,r=n.message,a=n.name,i=n.photoFileId,c=n.circleIds,e.next=3,f.sendRequest(t,r,a,i,c);case 3:return e.abrupt("return",{targetDotYouId:t});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),h=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.targetDotYouId,e.next=3,f.deleteSentRequest(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),x=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var t,r,a,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.senderDotYouId,r=n.name,a=n.photoFileId,i=n.circleIds,e.next=3,f.acceptConnectionRequest(t,r,a,i);case 3:return e.abrupt("return",{senderDotYouId:t});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),g=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.senderDotYouId,e.next=3,f.deletePendingRequest(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),b=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.blockDotYouId(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Z=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.unblockDotYouId(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["connectionInfo",n],(function(){return v({dotYouId:n})}),{refetchOnWindowFocus:!1}),disconnect:(0,i.useMutation)(p,{onSuccess:function(e,n){t.invalidateQueries(["activeConnections"]),t.invalidateQueries(["connectionInfo",n])},onError:function(e){console.error(e)}}),sendConnectionRequest:(0,i.useMutation)(m,{onMutate:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var a,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.cancelQueries(["sentRequests"]);case 2:return a=t.getQueryData(["sentRequests"]),i=[{status:"sent",recipient:n.targetDotYouId}].concat((0,r.Z)(null!==a&&void 0!==a?a:[])),t.setQueryData(["sentRequests"],i),e.abrupt("return",{previousRequests:a,newRequest:n});case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),onError:function(e,n,r){console.error(e),t.setQueryData(["sentRequests"],r.previousRequests)},onSettled:function(e){t.invalidateQueries(["sentRequests"]),t.invalidateQueries(["connectionInfo",e.targetDotYouId])}}),revokeConnectionRequest:(0,i.useMutation)(h,{onSuccess:function(e,n){t.invalidateQueries(["sentRequests"]),t.invalidateQueries(["connectionInfo",n.targetDotYouId])},onError:function(e){console.error(e)}}),acceptRequest:(0,i.useMutation)(x,{onMutate:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var a,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.cancelQueries(["activeConnections"]);case 2:return a=t.getQueryData(["activeConnections"]),i=[{status:"pending",dotYouId:n.senderDotYouId}].concat((0,r.Z)(null!==a&&void 0!==a?a:[])),t.setQueryData(["activeConnections"],i),e.abrupt("return",{previousConnections:a,newRequest:n});case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),onError:function(e,n,r){console.error(e),t.setQueryData(["activeConnections"],r.previousConnections)},onSettled:function(e){t.invalidateQueries(["pendingConnections"]),t.invalidateQueries(["activeConnections"]),t.invalidateQueries(["connectionInfo",e.senderDotYouId])}}),ignoreRequest:(0,i.useMutation)(g,{onSuccess:function(e,n){t.invalidateQueries(["pendingConnections"]),t.invalidateQueries(["connectionInfo",n.senderDotYouId])},onError:function(e){console.error(e)}}),block:(0,i.useMutation)(b,{onSettled:function(e,n,r){t.invalidateQueries(["pendingConnections"]),t.invalidateQueries(["activeConnections"]),t.invalidateQueries(["connectionInfo",r])}}),unblock:(0,i.useMutation)(Z,{onSettled:function(e,n,r){t.invalidateQueries(["pendingConnections"]),t.invalidateQueries(["activeConnections"]),t.invalidateQueries(["connectionInfo",r])}})}}},7148:function(e,n,t){var r=t(9439),o=t(3504);n.Z=function(){var e=(0,o.lr)(),n=(0,r.Z)(e,1)[0];return function(){if("focus"===n.get("ui")||"minimal"===n.get("ui")){var e=n.get("return");window.location.href=e}}}},470:function(e,n,t){var r=t(4165),o=t(5861),a=t(7408),i=t(6752),c=t(6117);n.Z=function(e){var n=e.profileId,t=e.type,s=(0,c.Z)().getSharedSecret,u=new i.KU({api:i.Ii.Owner,sharedSecret:s()}),d=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var t,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.profileId,o=n.type,e.next=3,u.profileDataProvider.getAttributeVersions(t,void 0,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return{fetchVersions:(0,a.useQuery)(["attributeVersions",n,t],(function(){return d({profileId:n,type:t})}),{refetchOnWindowFocus:!1})}}}}]);
//# sourceMappingURL=731.a430f631.chunk.js.map