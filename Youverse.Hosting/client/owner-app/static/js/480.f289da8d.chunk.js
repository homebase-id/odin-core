"use strict";(self.webpackChunkowner_app=self.webpackChunkowner_app||[]).push([[480],{7480:function(r,e,t){t.d(e,{Z:function(){return h}});var n=t(4165),i=t(5861),c=t(7408),u=t(5671),a=t(3144),o=t(1752),s=t(1120),p=t(9340),l=t(1129),f=function(r){(0,p.Z)(t,r);var e=(0,l.Z)(t);function t(r){var n;if((0,u.Z)(this,t),!r)throw"Shared Secret is required";return(n=e.call(this,r)).root="/circles/connections/circles",n}return(0,a.Z)(t,[{key:"add",value:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var i,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),c=this.root+"/add",r.abrupt("return",i.post(c,e).then((function(r){return r.data})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"remove",value:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var i,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),c=this.root+"/revoke",r.abrupt("return",i.post(c,e).then((function(r){return r.data})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"fetchMembers",value:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var i,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),c=this.root+"/list",r.abrupt("return",i.post(c,{circleId:e}).then((function(r){return r.data})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()}],[{key:"getInstance",value:function(r){return t.instance||(t.instance=new t(r)),t.instance}}]),t}(t(2008).$);f.instance=void 0;var d=t(3766),v=t(6117),h=function(r){var e=r.circleId,t=(0,c.useQueryClient)(),u=(0,v.Z)().getSharedSecret,a=d.k.getInstance(u()),o=f.getInstance(u()),s=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.circleId){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,a.getCircle(t);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),p=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.circleId){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,o.fetchMembers(t);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),l=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.lastUpdated){r.next=6;break}return r.next=3,a.updateDefinition(e);case 3:case 8:return r.abrupt("return",r.sent);case 6:return r.next=8,a.createDefinition(e);case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),h=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.circleId,r.next=3,a.disableCircle(t);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),Z=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.circleId,r.next=3,a.enableCircle(t);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),y=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.circleId,c=e.dotYouIds,r.next=3,Promise.all(c.map(function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.add({circleId:t,dotYouId:e});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),w=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.circleId,c=e.dotYouIds,r.next=3,Promise.all(c.map(function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.remove({circleId:t,dotYouId:e});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()));case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),m=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t,i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.circleId,i=e.dotYouId,r.next=3,o.add({circleId:t,dotYouId:i});case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),b=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t,i;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.circleId,i=e.dotYouId,r.next=3,o.remove({circleId:t,dotYouId:i});case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),x=function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var t;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.circleId,r.next=3,a.removeCircle(t);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return{fetch:(0,c.useQuery)(["circle",e],(function(){return s({circleId:e})}),{refetchOnWindowFocus:!1}),fetchMembers:(0,c.useQuery)(["cirleMembers",e],(function(){return p({circleId:e})}),{refetchOnWindowFocus:!1}),createOrUpdate:(0,c.useMutation)(l,{onMutate:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){var i,c,u;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.cancelQueries(["circle",e.id]);case 2:return i=t.getQueryData(["circle",e.id]),t.setQueryData(["circle",e.id],e),c=t.getQueryData(["circles"]),u=null===c||void 0===c?void 0:c.map((function(r){return r.id===e.id?e:r})),t.setQueryData(["circles"],u),r.abrupt("return",{previousCircle:i,newCircle:e,previousCircles:c});case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),onError:function(r,e,n){console.error(r),t.setQueryData(["circle",e.id],n.previousCircle),t.setQueryData(["circles"],n.previousCircles)},onSettled:function(r){t.invalidateQueries(["circles"]),null!==r&&void 0!==r&&r.id&&t.invalidateQueries(["circle",r.id])}}),disableCircle:(0,c.useMutation)(h,{onSuccess:function(r,e){t.invalidateQueries(["circles"]),null!==e&&void 0!==e&&e.circleId&&t.invalidateQueries(["circle",e.circleId])}}),enableCircle:(0,c.useMutation)(Z,{onSuccess:function(r,e){t.invalidateQueries(["circles"]),null!==e&&void 0!==e&&e.circleId&&t.invalidateQueries(["circle",e.circleId])}}),provideGrants:(0,c.useMutation)(y,{onSuccess:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(c,u){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.invalidateQueries(["circles"]),t.invalidateQueries(["circle",e]),t.invalidateQueries(["cirleMembers",e]),r.next=5,Promise.all(u.dotYouIds.map(function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.invalidateQueries(["connectionInfo",e]);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()));case 5:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),onError:function(r){console.error(r)}}),revokeGrants:(0,c.useMutation)(w,{onSuccess:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(c,u){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.invalidateQueries(["circles"]),t.invalidateQueries(["circle",e]),t.invalidateQueries(["cirleMembers",e]),r.next=5,Promise.all(u.dotYouIds.map(function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.invalidateQueries(["connectionInfo",e]);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()));case 5:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),onError:function(r){console.error(r)}}),provideGrant:(0,c.useMutation)(m,{onSuccess:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(i,c){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.invalidateQueries(["circles"]),t.invalidateQueries(["circle",e]),t.invalidateQueries(["cirleMembers",e]),t.invalidateQueries(["connectionInfo",c.dotYouId]);case 4:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),onError:function(r){console.error(r)}}),revokeGrant:(0,c.useMutation)(b,{onSuccess:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(i,c){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.invalidateQueries(["circles"]),t.invalidateQueries(["circle",e]),t.invalidateQueries(["cirleMembers",e]),t.invalidateQueries(["connectionInfo",c.dotYouId]);case 4:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),onError:function(r){console.error(r)}}),removeCircle:(0,c.useMutation)(x,{onSuccess:function(){var r=(0,i.Z)((0,n.Z)().mark((function r(e,i){return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.invalidateQueries(["circles"]),t.invalidateQueries(["circle",i.circleId]);case 2:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),onError:function(r){console.error(r)}})}}},3766:function(r,e,t){t.d(e,{k:function(){return f}});var n=t(4165),i=t(1413),c=t(5861),u=t(5671),a=t(3144),o=t(1752),s=t(1120),p=t(9340),l=t(1129),f=function(r){(0,p.Z)(t,r);var e=(0,l.Z)(t);function t(r){var n;if((0,u.Z)(this,t),!r)throw"Shared Secret is required";return(n=e.call(this,r)).root="/circles/definitions",n}return(0,a.Z)(t,[{key:"updateDefinition",value:function(){var r=(0,c.Z)((0,n.Z)().mark((function r(e){var c,u,a;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),u=this.root+"/update",(a=(0,i.Z)({},e)).driveGrants=a.driveGrants||[],r.abrupt("return",c.post(u,a).then((function(r){return r.data})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 5:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"createDefinition",value:function(){var r=(0,c.Z)((0,n.Z)().mark((function r(e){var i,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),c=this.root+"/create",r.abrupt("return",i.post(c,e).then((function(r){return r.data})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"parsePermissions",value:function(r){if("string"!==typeof r)return r;var e=r.toLowerCase();return"read"===e?2:"write"===e?4:"readwrite"===e?5:r}},{key:"getCircles",value:function(){var r=(0,c.Z)((0,n.Z)().mark((function r(){var e,c,u=this;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),c=this.root+"/list",r.abrupt("return",e.get(c).then((function(r){return r.data.map((function(r){var e;return r.driveGrants=null===(e=r.driveGrants)||void 0===e?void 0:e.map((function(r){return{permissionedDrive:(0,i.Z)((0,i.Z)({},r.permissionedDrive),{},{permission:u.parsePermissions(r.permissionedDrive.permission)})}})),r}))})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(){return r.apply(this,arguments)}}()},{key:"getCircle",value:function(){var r=(0,c.Z)((0,n.Z)().mark((function r(e){var c,u,a=this;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),u=this.root+"/circle",r.abrupt("return",c.post(u,e).then((function(r){return r.data})).then((function(r){var e;return r.driveGrants=null===(e=r.driveGrants)||void 0===e?void 0:e.map((function(r){return{permissionedDrive:(0,i.Z)((0,i.Z)({},r.permissionedDrive),{},{permission:a.parsePermissions(r.permissionedDrive.permission)})}})),r})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"disableCircle",value:function(){var r=(0,c.Z)((0,n.Z)().mark((function r(e){var i,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),c=this.root+"/disable",r.abrupt("return",i.post(c,e).then((function(r){return r.data})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"enableCircle",value:function(){var r=(0,c.Z)((0,n.Z)().mark((function r(e){var i,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),c=this.root+"/enable",r.abrupt("return",i.post(c,e).then((function(r){return r.data})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()},{key:"removeCircle",value:function(){var r=(0,c.Z)((0,n.Z)().mark((function r(e){var i,c;return(0,n.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=(0,o.Z)((0,s.Z)(t.prototype),"createAxiosClient",this).call(this),c=this.root+"/delete",r.abrupt("return",i.post(c,e).then((function(r){return r.data})).catch((0,o.Z)((0,s.Z)(t.prototype),"handleErrorResponse",this)));case 3:case"end":return r.stop()}}),r,this)})));return function(e){return r.apply(this,arguments)}}()}],[{key:"getInstance",value:function(r){return t.instance||(t.instance=new t(r)),t.instance}}]),t}(t(2008).$);f.instance=void 0},4942:function(r,e,t){function n(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}t.d(e,{Z:function(){return n}})},1413:function(r,e,t){t.d(e,{Z:function(){return c}});var n=t(4942);function i(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function c(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?i(Object(t),!0).forEach((function(e){(0,n.Z)(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}}}]);
//# sourceMappingURL=480.f289da8d.chunk.js.map