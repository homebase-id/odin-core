"use strict";(self.webpackChunkowner_app=self.webpackChunkowner_app||[]).push([[389],{6225:function(e,n,t){t.r(n),t.d(n,{default:function(){return V}});var r=t(2982),a=t(3504),c=t(6871),s=t(4990),i=t(4165),l=t(1413),o=t(5861),u=t(7408),d=t(1803),m=t(3990),h=t(6117),f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page:void 0},n=e.channelId,t=e.page,r=50,a=(0,h.Z)(),c=a.getSharedSecret,s=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var n,t,a,s,o,u,h=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>0&&void 0!==h[0]?h[0]:{page:void 0},t=n.channelId,a=n.page,s=new d.KU({api:d.Ii.Owner,sharedSecret:c()}),e.next=4,s.blogPostProvider.getMasterPosts(a,r);case 4:return o=e.sent,u=(u=o.filter((function(e){return!t||e.publishTargets.some((function(e){return e.channelId===t}))}))).map((function(e){return(0,l.Z)((0,l.Z)({},e),{},{content:(0,l.Z)((0,l.Z)({},e.content),{},{itemKey:"".concat(e.content.channelId,"_").concat(e.content.id),slug:e.content.caption?(0,m.V)(e.content.caption):e.content.id})})})),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,u.useQuery)(["blogs",n,t],(function(){return s({channelId:n,page:t})}),{refetchOnWindowFocus:!1})},p=t(777),x=t(9072),g=t(885),v=t(2791),j=t(9088),b=t(6916),w=t(8491),Z=t(184),N=function(){var e=(0,v.useState)(""),n=(0,g.Z)(e,2),t=n[0],r=n[1],a=(0,v.useState)(""),i=(0,g.Z)(a,2),l=i[0],o=i[1],u=(0,j.Z)().save,h=u.mutate,f=u.status,p=(0,c.s0)();return(0,Z.jsx)(w.Z,{title:"New: channel",isOpaqueBg:!0,children:(0,Z.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n={channelId:"",name:t,description:l,templateId:void 0,acl:{requiredSecurityGroup:d.hh.Owner}};return h(n,{onSuccess:function(){p("/owner/blog/".concat((0,m.V)(n.name)))}}),!1},children:[(0,Z.jsxs)("div",{className:"mb-5",children:[(0,Z.jsx)("label",{htmlFor:"channelName",children:(0,s.t)("Name")}),(0,Z.jsx)(b.Z,{id:"name",name:"channelName",onChange:function(e){r(e.target.value)},required:!0})]}),(0,Z.jsxs)("div",{className:"mb-5",children:[(0,Z.jsx)("label",{htmlFor:"name",children:(0,s.t)("Description")}),(0,Z.jsx)(b.Z,{id:"name",name:"channelDescription",onChange:function(e){o(e.target.value)}})]}),(0,Z.jsx)("div",{className:"flex flex-row",children:(0,Z.jsx)(x.Z,{className:"ml-auto",state:f,children:(0,s.t)("Add channel")})})]})})},y=function(e){var n=e.publishTargets,t=(0,p.Z)().fetch.data;if(null!==n&&void 0!==n&&n.length)return(0,Z.jsx)("span",{className:"my-auto ml-2 flex flex-row flex-wrap",children:n.map((function(e){var n=t.find((function(n){return n.channelId===e.channelId}));return n?(0,Z.jsx)("span",{className:"mr-2 bg-green-300 px-2 py-1 text-xs",title:"".concat((0,s.t)("Published to"),": ").concat(n.name),children:n.name},n.channelId):null}))})},k=function(e){var n,t=e.className,r=e.blog,c=e.linkRoot;return(0,Z.jsx)(a.rU,{to:"".concat(c).concat(null!==(n=r.content.slug)&&void 0!==n?n:"#"),className:"contents",children:(0,Z.jsx)("div",{className:"flex flex-nowrap px-5 py-8 transition-colors duration-200 hover:bg-slate-50 hover:dark:bg-slate-800 ".concat(null!==t&&void 0!==t?t:""),children:(0,Z.jsxs)("div",{className:"flex flex-col md:flex-grow md:flex-row",children:[(0,Z.jsxs)("div",{className:"flex flex-shrink-0 md:order-3 md:mb-0 md:mt-3 md:w-32 md:flex-col md:text-right lg:w-64",children:[(0,Z.jsx)("span",{className:"title-font font-semibold text-gray-700 dark:text-white",children:r.content.type.toUpperCase()}),(0,Z.jsx)("span",{className:"pl-2 text-gray-500 md:mt-1 md:pl-0 md:text-sm",children:new Date(r.content.dateUnixTime).toLocaleDateString()})]}),(0,Z.jsxs)("div",{className:"md:order-2 md:flex-grow",children:[(0,Z.jsxs)("h2",{className:"title-font mb-2 flex flex-row text-2xl font-medium text-gray-900 dark:text-white",children:[r.content.caption,(0,Z.jsx)(y,{publishTargets:r.publishTargets})]}),"abstract"in r.content?(0,Z.jsx)("p",{className:"leading-relaxed",children:r.content.abstract}):null]})]})})})},I=t(2723),C=t(3225),S=t(2465),D=function(e){var n=e.channel,t=e.onCancel,r=(0,v.useState)((0,l.Z)({},n)),a=(0,g.Z)(r,2),i=a[0],o=a[1],u=(0,j.Z)().save,h=u.mutate,f=u.status,p=(0,c.s0)();if(n){var N=function(e){var n=(0,l.Z)({},i);n[e.target.name]=e.target.value,o(n)},y=Object.keys(d.rJ).filter((function(e){return!isNaN(Number(e))})),k=Object.keys(d.rJ).filter((function(e){return isNaN(Number(e))}));return(0,Z.jsx)(w.Z,{title:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(I.Z,{acl:i.acl,onChange:function(e){N({target:{name:"acl",value:e}})}},i.channelId)," ","".concat((0,s.t)("Edit"),": ").concat(n.name)]}),isOpaqueBg:!0,children:(0,Z.jsxs)("form",{onSubmit:function(e){e.preventDefault(),h(i,{onSuccess:function(){p("/owner/blog/".concat((0,m.V)(i.name)))}})},children:[(0,Z.jsxs)("div",{className:"mb-5",children:[(0,Z.jsx)("label",{htmlFor:"name",children:(0,s.t)("Name")}),(0,Z.jsx)(b.Z,{id:"name",name:"name",defaultValue:n.name,onChange:N})]}),(0,Z.jsxs)("div",{className:"mb-5",children:[(0,Z.jsx)("label",{htmlFor:"description",children:(0,s.t)("Description")}),(0,Z.jsx)(S.Z,{id:"description",name:"description",defaultValue:n.description,onChange:N})]}),(0,Z.jsxs)("div",{className:"mb-5",children:[(0,Z.jsx)("label",{htmlFor:"template",children:(0,s.t)("Template")}),(0,Z.jsxs)(C.Z,{id:"template",name:"templateId",defaultValue:n.templateId,onChange:N,children:[(0,Z.jsx)("option",{children:(0,s.t)("Make a selection")}),y.map((function(e,n){return(0,Z.jsx)("option",{value:e,children:(0,s.t)(k[n])},e)}))]})]}),(0,Z.jsxs)("div",{className:"flex flex-row",children:[(0,Z.jsx)(x.Z,{type:"secondary",className:"ml-auto",onClick:function(e){e.preventDefault(),t()},children:(0,s.t)("Cancel")}),(0,Z.jsx)(x.Z,{type:"primary",className:"ml-2",state:f,children:(0,s.t)("Save")})]})]})})}},O=function(e){var n=e.channel,t=e.blogs,r="/owner/blog/".concat(n?n.slug:"all","/"),a=(0,v.useState)(!1),c=(0,g.Z)(a,2),i=c[0],l=c[1];return(0,Z.jsxs)(Z.Fragment,{children:[n?i?(0,Z.jsx)(D,{channel:n,onCancel:function(){return l(!1)}},n.channelId):(0,Z.jsxs)("section",{className:"items-center bg-slate-50 p-3 dark:bg-slate-800 sm:flex sm:flex-row",children:[(0,Z.jsx)("p",{className:"sm:mr-2",children:n.description?n.description:n.name}),(0,Z.jsxs)("p",{className:"ml-auto",children:[(0,s.t)("Template"),":"," ",parseInt(n.templateId+"")===d.rJ.LargeCards?(0,s.t)("LargeCards"):parseInt(n.templateId+"")===d.rJ.ClassicBlog?(0,s.t)("ClassicBlog"):(0,s.t)("MasonryLayout")]}),(0,Z.jsx)(x.Z,{type:"secondary",className:"sm:ml-2",onClick:function(){return l(!0)},children:(0,s.t)("Edit Channel")})]}):null,t.length?(0,Z.jsx)("div",{className:"-mx-5 divide-y-2 divide-gray-100 dark:divide-gray-800",children:t.map((function(e){return(0,Z.jsx)(k,{blog:e,linkRoot:r},e.content.itemKey)}))}):(0,Z.jsx)("div",{className:"mt-4",children:(0,s.t)("no-data-found")})]})},F=t(5207),L=t(4439),P=t(3004),U=function(e){var n=e.className,t=e.items;return(0,Z.jsx)("div",{className:"flex ".concat(n),children:t.map((function(e){return(0,Z.jsx)(a.OL,{className:function(n){var t,r=n.isActive;return"flex-grow cursor-pointer border-b-2 py-2 px-1 text-lg ".concat(r?"border-indigo-500 text-indigo-500 dark:text-indigo-400":"border-gray-300 transition-colors duration-300 hover:border-indigo-400 dark:border-gray-800 hover:dark:border-indigo-600"," ").concat(null!==(t=e.className)&&void 0!==t?t:"")},to:e.path,end:!0,children:e.title},e.key)}))})},V=function(){var e=(0,c.UO)().channelKey,n=(0,p.Z)().fetch,t=n.data,i=n.isLoading,l=null===t||void 0===t?void 0:t.find((function(n){return n.slug===e})),o=f({channelId:null===l||void 0===l?void 0:l.channelId,page:void 0}),u=o.data,d=o.isLoading;return!t||!u||i||d?(0,Z.jsx)(Z.Fragment,{children:"Loading"}):(0,Z.jsxs)("section",{children:[(0,Z.jsx)(P.Z,{icon:L.Z,title:(0,s.t)("Blog"),actions:(0,Z.jsx)(a.rU,{className:"contents",to:"/owner/blog/draft/new",children:(0,Z.jsx)(x.Z,{type:"primary",icon:"plus",className:"ml-auto",children:(0,s.t)("New")})})}),(0,Z.jsx)(U,{items:[{title:(0,s.t)("Drafts"),key:"",path:"/owner/blog"}].concat((0,r.Z)(t.map((function(e){return{title:e.name,key:e.channelId,path:"/owner/blog/".concat(e.slug)}}))),[{title:(0,Z.jsx)(F.Z,{className:"h-5 w-5"}),key:"new",className:"flex-grow-0",path:"/owner/blog/new"}])}),(0,Z.jsx)("div",{className:"pt-5",children:"new"===e?(0,Z.jsx)(N,{}):(0,Z.jsx)(O,{channel:l,blogs:u})})]})}},3990:function(e,n,t){t.d(n,{P:function(){return a},V:function(){return r}});var r=function(e){return e.split(" ").join("-").toLowerCase()},a=function(e){return Object.keys(e).map((function(n){return n+"="+e[n]})).join("&")}},9088:function(e,n,t){var r=t(4165),a=t(5861),c=t(7408),s=t(1803),i=t(6117),l=t(1695);n.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.channelId,t=(0,i.Z)(),o=t.getSharedSecret,u=new s.KU({api:s.Ii.Owner,sharedSecret:o()}),d=(0,c.useQueryClient)(),m=(0,l.Z)().publish.mutate,h=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u.blogDefinitionProvider.getChannelDefinition(n);case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),f=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.blogDefinitionProvider.saveChannelDefinition(n);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return{fetch:(0,c.useQuery)(["channel",n],(function(){return h(n)}),{refetchOnWindowFocus:!1}),save:(0,c.useMutation)(f,{onSuccess:function(e,n){n.channelId?d.removeQueries(["channel",n.channelId]):d.removeQueries(["channel"]),d.removeQueries(["channels"]),m()}})}}},777:function(e,n,t){var r=t(4165),a=t(1413),c=t(5861),s=t(7408),i=t(1803),l=t(3990),o=t(6117);n.Z=function(){var e=(0,o.Z)().getSharedSecret,n=new i.KU({api:i.Ii.Owner,sharedSecret:e()}),t=function(){var e=(0,c.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.blogDefinitionProvider.getChannelDefinitions();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{slug:(0,l.V)(e.name)})})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{fetch:(0,s.useQuery)(["channels"],(function(){return t()}),{refetchOnWindowFocus:!1})}}}}]);
//# sourceMappingURL=389.08c3a756.chunk.js.map