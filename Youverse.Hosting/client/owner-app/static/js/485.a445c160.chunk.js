"use strict";(self.webpackChunkowner_app=self.webpackChunkowner_app||[]).push([[485],{9835:function(e,n,t){var r=t(3504),s=t(184);n.Z=function(e){var n=e.name,t=e.href,o=e.className,a=e.children,c=e.onClick,i=function(e){var n=e.children;return t?(0,s.jsx)(r.rU,{to:t,children:n}):(0,s.jsx)(s.Fragment,{children:n})};return(0,s.jsx)("div",{className:o,children:(0,s.jsx)(i,{children:(0,s.jsxs)("div",{className:"h-full rounded-md border-[1px] border-gray-200 border-opacity-60 bg-white transition-colors dark:border-gray-800 dark:bg-gray-800",onClick:c,children:[(0,s.jsx)("div",{className:"aspect-square",children:(0,s.jsx)("img",{src:"https://placehold.co/200",className:"h-full w-full"})}),(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("h2",{className:"font-thiner mb-6 dark:text-white",children:n}),a]})]})})})}},4661:function(e,n,t){var r=t(885),s=t(2791),o=t(4665),a=t(184);n.Z=function(e){var n=e.isOpenByDefault,t=void 0===n||n,c=e.title,i=e.className,u=e.children,l=e.isOpaqueBg,d=void 0!==l&&l,f=e.isBorderLess,m=void 0!==f&&f,p=(0,s.useState)(t),h=(0,r.Z)(p,2),x=h[0],v=h[1],g=(0,s.useRef)(null),Z=(0,s.useRef)(0);return(0,s.useEffect)((function(){t&&g.current&&(Z.current=g.current.clientHeight)}),[x]),(0,a.jsxs)("section",{className:"my-5 rounded-md ".concat(d?m?"":"rounded-lg border-[1px] border-gray-200 border-opacity-80 px-5 dark:border-gray-700":"bg-slate-50 px-5 dark:bg-slate-800 dark:text-slate-300"," ").concat(i),children:[(0,a.jsxs)("div",{className:"relative cursor-pointer border-b-[1px] border-slate-200 py-5 transition-all duration-300 ".concat(x?"border-opacity-100":"border-opacity-0"),onClick:function(){return v(!x)},children:[(0,a.jsx)("h3",{className:"text-2xl dark:text-white",children:c}),(0,a.jsx)("button",{className:"absolute top-0 right-0 bottom-0",children:(0,a.jsx)(o.Z,{className:"h-4 w-4 transition-transform duration-300 ".concat(x?"rotate-90":"-rotate-90")})})]}),(0,a.jsx)("div",{className:"overflow-hidden transition-all duration-300 ",style:{maxHeight:"".concat(x?Z.current?Z.current:2e3:0,"px")},ref:g,children:(0,a.jsx)("div",{className:"py-5 ",children:u})})]})}},952:function(e,n,t){t.r(n),t.d(n,{default:function(){return k}});var r=t(885),s=t(3004),o=t(4257),a=t(9072),c=t(7903),i=t(9835),u=t(184),l=function(e){var n,t=e.senderDotYouId,r=e.children,s=e.className,o=(0,c.Z)({}),l=o.acceptRequest,d=l.mutate,f=l.status,m=o.ignoreRequest,p=m.mutate,h=m.status;return(0,u.jsxs)(i.Z,{className:s,name:t,href:null!==(n=t&&"/owner/connections/".concat(t))&&void 0!==n?n:void 0,children:[r,(0,u.jsx)(a.Z,{type:"primary",className:"mb-2 w-full",onClick:function(e){return e.preventDefault(),d({senderDotYouId:t}),!1},state:f,children:"Confirm"}),(0,u.jsx)(a.Z,{type:"secondary",className:"mb-2 w-full",onClick:function(e){return e.preventDefault(),p({senderDotYouId:t}),!1},state:h,children:"Ignore"})]})},d=function(e){var n,t=e.recipientDotYouId,r=e.className,s=(0,c.Z)({}).revokeConnectionRequest,o=s.mutate,l=s.status;return(0,u.jsx)(i.Z,{className:r,name:t,href:null!==(n=t&&"/owner/connections/".concat(t))&&void 0!==n?n:void 0,children:(0,u.jsx)(a.Z,{type:"secondary",className:"mb-2 w-full",onClick:function(e){return e.preventDefault(),o({targetDotYouId:t}),!1},state:l,children:"Cancel"})})},f=t(4990),m=function(e){var n,t=e.dotYouProfile,r=e.className,s=(0,c.Z)({}).disconnect,o=s.mutate,l=s.status;return(0,u.jsx)(i.Z,{className:r,name:t.givenName&&t.surName?"".concat(t.givenName," ").concat(t.surName):t.dotYouId,href:null!==(n=t.dotYouId&&"/owner/connections/".concat(t.dotYouId))&&void 0!==n?n:void 0,children:(0,u.jsx)(a.Z,{type:"secondary",className:"w-full",onClick:function(e){e.preventDefault(),o({connectionDotYouId:t.dotYouId})},state:l,confirmOptions:{title:"".concat((0,f.t)("Remove")," ").concat(t.dotYouId),buttonText:(0,f.t)("Remove"),body:"".concat((0,f.t)("Are you sure you want to remove")," ").concat(t.dotYouId," ").concat((0,f.t)("from your connections. They will lose all existing access."))},children:"Remove"})})},p=t(8491),h=t(4661),x=t(2982),v=t(2791),g=t(4164),Z=t(4395),w=t(3412),j=t(6419),b=t(6916),y=t(2465),N=t(6123),I=function(e){var n=e.title,t=e.isOpen,s=e.onConfirm,o=e.onCancel,i=(0,w.Z)("modal-container"),l=(0,c.Z)({}).sendConnectionRequest,d=l.mutate,m=l.status,p=l.reset,h=(0,Z.Z)().fetch.data,I=(0,v.useState)("samwise.digital"),C=(0,r.Z)(I,2),k=C[0],Y=C[1],q=(0,v.useState)(""),S=(0,r.Z)(q,2),D=S[0],R=S[1],F=(0,v.useState)("Frodo"),Q=(0,r.Z)(F,2),O=Q[0],B=Q[1],P=(0,v.useState)([]),L=(0,r.Z)(P,2),E=L[0],M=L[1];if(!t)return null;var A=(0,u.jsx)(N.Z,{title:n,onClose:o,children:(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("form",{onSubmit:function(e){e.preventDefault(),d({message:D,name:O,targetDotYouId:k,circleIds:E},{onSuccess:function(){p(),Y(""),R(""),M([]),s()}})},children:[(0,u.jsxs)("div",{className:"mb-5",children:[(0,u.jsx)("label",{htmlFor:"dotyouid",children:"Recipient (dot you id)"}),(0,u.jsx)(b.Z,{id:"dotyouid",name:"dotyouid",onChange:function(e){Y(e.target.value)},defaultValue:k,required:!0})]}),(0,u.jsxs)("div",{className:"mb-5",children:[(0,u.jsx)("label",{htmlFor:"dotyouid",children:"From:"}),(0,u.jsx)(b.Z,{id:"dotyouid",name:"dotyouid",onChange:function(e){B(e.target.value)},defaultValue:O,required:!0})]}),(0,u.jsxs)("div",{className:"mb-5",children:[(0,u.jsx)("label",{htmlFor:"message",children:(0,f.t)("Message")}),(0,u.jsx)(y.Z,{id:"message",name:"message",onChange:function(e){R(e.target.value)},required:!0})]}),h.length?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("h2",{className:"mb-2 text-lg",children:"Add as member to:"}),h.map((function(e,n){var t;return(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsx)(j.Z,{value:e.id,id:e.id,onChange:function(e){var n=(0,x.Z)(E);e.target.checked?(n.push(e.target.value),M(n)):M(n.filter((function(n){return n!==e.target.value})))}}),(0,u.jsx)("label",{htmlFor:e.id,className:"ml-2 cursor-pointer",children:e.name})]},null!==(t=e.id)&&void 0!==t?t:n)}))]}):null,(0,u.jsxs)("div",{className:"-mx-2 py-3 sm:flex sm:flex-row-reverse",children:[(0,u.jsx)(a.Z,{className:"mx-2",state:m,icon:"send",children:(0,f.t)("Send")}),(0,u.jsx)(a.Z,{className:"mx-2",type:"secondary",onClick:o,children:(0,f.t)("Cancel")})]})]})})});return(0,g.createPortal)(A,i)},C=t(959),k=function(){var e=(0,o.Z)(),n=e.fetchPending,t=n.data,c=n.isLoading,i=e.fetchActive,x=i.data,g=i.isLoading,Z=e.fetchSent,w=Z.data,j=Z.isLoading,b=(0,v.useState)(!1),y=(0,r.Z)(b,2),N=y[0],k=y[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("section",{children:[(0,u.jsx)(s.Z,{icon:C.Z,title:"Connections",actions:(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(a.Z,{onClick:function(){return k(!0)},icon:"plus",children:(0,f.t)("Send request")})})}),!c&&null!==t&&void 0!==t&&t.length?(0,u.jsx)(p.Z,{isOpaqueBg:!0,isBorderLess:!0,title:(0,f.t)("Connection requests"),children:(0,u.jsx)("div",{className:"-m-1 flex flex-row flex-wrap",children:null===t||void 0===t?void 0:t.map((function(e){return(0,u.jsx)(l,{className:"w-1/2 p-1 sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/6",senderDotYouId:e.senderDotYouId,children:(0,u.jsxs)("div",{className:"-mt-3",children:[(0,u.jsxs)("p",{children:[(0,f.t)("From:")," ",e.name]}),(0,u.jsx)("p",{className:"mb-3 text-sm",children:e.message})]})},e.senderDotYouId)}))})}):null,!g&&null!==x&&void 0!==x&&x.length?(0,u.jsx)(p.Z,{isOpaqueBg:!0,isBorderLess:!0,title:(0,f.t)("Your Connections"),children:(0,u.jsx)("div",{className:"-m-1 flex flex-row flex-wrap",children:null===x||void 0===x?void 0:x.map((function(e){return(0,u.jsx)(m,{className:"w-1/2 p-1 sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/6",dotYouProfile:e},e.dotYouId)}))})}):null,!j&&null!==w&&void 0!==w&&w.length?(0,u.jsx)(h.Z,{isOpaqueBg:!0,isBorderLess:!0,isOpenByDefault:!0,title:(0,f.t)("Sent Connection Requests"),children:(0,u.jsx)("div",{className:"-m-1 flex flex-row flex-wrap",children:null===w||void 0===w?void 0:w.map((function(e){return(0,u.jsx)(d,{className:"w-1/2 p-1 sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/6",recipientDotYouId:e.recipient},e.recipient)}))})}):null]}),(0,u.jsx)(I,{title:(0,f.t)("Send connection request"),isOpen:N,onConfirm:function(){return k(!1)},onCancel:function(){return k(!1)}})]})}},7903:function(e,n,t){var r=t(4165),s=t(5861),o=t(7408),a=t(7186),c=t(5144),i=t(6117);n.Z=function(e){var n=e.dotYouId,t=(0,o.useQueryClient)(),u=(0,i.Z)().getSharedSecret,l=a.I.getInstance(u()),d=c.e.getInstance(u()),f=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t,s,o,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.dotYouId){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,l.getConnectionInfo(t);case 5:if(!(s=e.sent)||"None"===s.status){e.next=8;break}return e.abrupt("return",s);case 8:return e.next=10,d.getPendingRequest(t);case 10:if(!(o=e.sent)){e.next=13;break}return e.abrupt("return",o);case 13:return e.next=15,d.getSentRequest(t);case 15:return a=e.sent,e.abrupt("return",null!==a&&void 0!==a?a:s);case 17:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),m=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.connectionDotYouId,e.next=3,l.disconnectFromContact(null!==s&&void 0!==s?s:n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),p=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t,s,o,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.targetDotYouId,s=n.message,o=n.name,a=n.circleIds,e.next=3,d.sendRequest(t,s,o,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),h=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.targetDotYouId,e.next=3,d.deleteSentRequest(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),x=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.senderDotYouId,e.next=3,d.acceptConnectionRequest(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.senderDotYouId,e.next=3,d.deletePendingRequest(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return{fetch:(0,o.useQuery)(["connectionInfo",n],(function(){return f({dotYouId:n})}),{refetchOnWindowFocus:!1}),disconnect:(0,o.useMutation)(m,{onSuccess:function(e,n){t.invalidateQueries(["activeConnections"]),t.invalidateQueries(["connectionInfo",n])},onError:function(e){console.error(e)}}),sendConnectionRequest:(0,o.useMutation)(p,{onSuccess:function(e,n){t.invalidateQueries(["sentRequests"]),t.invalidateQueries(["connectionInfo",n.targetDotYouId])},onError:function(e){console.error(e)}}),revokeConnectionRequest:(0,o.useMutation)(h,{onSuccess:function(e,n){t.invalidateQueries(["sentRequests"]),t.invalidateQueries(["connectionInfo",n.targetDotYouId])},onError:function(e){console.error(e)}}),acceptRequest:(0,o.useMutation)(x,{onSuccess:function(e,n){t.invalidateQueries(["pendingConnections"]),t.invalidateQueries(["activeConnections"]),t.invalidateQueries(["connectionInfo",n.senderDotYouId])},onError:function(e){console.error(e)}}),ignoreRequest:(0,o.useMutation)(v,{onSuccess:function(e,n){t.invalidateQueries(["pendingConnections"]),t.invalidateQueries(["connectionInfo",n.senderDotYouId])},onError:function(e){console.error(e)}})}}},4257:function(e,n,t){var r=t(4165),s=t(5861),o=t(7408),a=t(7186),c=t(5144),i=t(6117);n.Z=function(){var e=(0,i.Z)().getSharedSecret,n=c.e.getInstance(e()),t=a.I.getInstance(e()),u=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getPendingRequests({pageNumber:1,pageSize:10});case 2:return e.next=4,e.sent.results;case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getSentRequests({pageNumber:1,pageSize:10});case 2:return e.next=4,e.sent.results;case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getConnections({pageNumber:1,pageSize:10});case 2:return e.next=4,e.sent.results;case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{fetchPending:(0,o.useQuery)(["pendingConnections"],(function(){return u()}),{refetchOnWindowFocus:!1}),fetchSent:(0,o.useQuery)(["sentRequests"],(function(){return l()}),{refetchOnWindowFocus:!1}),fetchActive:(0,o.useQuery)(["activeConnections"],(function(){return d()}),{refetchOnWindowFocus:!1})}}}}]);
//# sourceMappingURL=485.a445c160.chunk.js.map