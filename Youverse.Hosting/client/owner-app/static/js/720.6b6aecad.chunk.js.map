{"version":3,"file":"static/js/720.6b6aecad.chunk.js","mappings":"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","sources":["components/Buttons/SaveStatus.tsx","components/Layout/PageMeta/PageMeta.tsx","components/Templates/Apps/Apps.tsx","hooks/apps/useApps.ts","provider/app/AppManagementProvider.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\n\nconst seconds = 60000;\nconst minutes = 600000;\n\nconst SaveStatus = ({\n  className,\n  state,\n}: {\n  className: string;\n  state: 'error' | 'idle' | 'loading' | 'success';\n}) => {\n  const [lastSave, setLastSave] = useState<Date>(null);\n  const [now, setNow] = useState<Date>(new Date());\n\n  useEffect(() => {\n    if (state === 'success') {\n      setLastSave(new Date());\n    }\n  }, [state]);\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setNow(new Date());\n    }, 30000);\n\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [now]);\n\n  if (state === 'loading') {\n    return <p className={`${className} text-sm`}>Saving...</p>;\n  }\n\n  if (state === 'error') {\n    return <p className={`${className} text-sm`}>Something went wrong</p>;\n  }\n\n  if (!lastSave) {\n    return null;\n  }\n\n  const diff = now.getTime() - lastSave.getTime();\n  const text = lastSave\n    ? diff <= seconds\n      ? 'a few seconds ago'\n      : diff <= minutes\n      ? 'a few minutes ago'\n      : lastSave.toLocaleString()\n    : '';\n\n  return text ? <p className={`${className} text-sm`}>Last saved {text}</p> : null;\n};\n\nexport default SaveStatus;\n","import { FC, ReactNode } from 'react';\nimport { Link } from 'react-router-dom';\nimport SaveStatus from '../../Buttons/SaveStatus';\n\nconst PageMeta = ({\n  title,\n  actions,\n  saveStatus,\n  breadCrumbs,\n  icon,\n}: {\n  title?: ReactNode;\n  actions?: ReactNode;\n  saveStatus?: 'error' | 'idle' | 'loading' | 'success';\n  breadCrumbs?: { title: string; href?: string }[];\n  icon?: FC;\n}) => {\n  return (\n    <section\n      className=\"-mx-5 -mt-4 mb-10 border-b-2 border-gray-100 bg-slate-50 py-4 pr-5 pl-10 dark:border-gray-700 dark:bg-slate-800 sm:-mx-10\n    sm:-mt-8 sm:py-8 sm:px-10\"\n    >\n      <div className=\"flex flex-col sm:flex-row\">\n        <div className=\"flex-col\">\n          {breadCrumbs && (\n            <ul className=\"mb-2 hidden flex-row sm:flex\">\n              {breadCrumbs.map((crumb, index) => {\n                return (\n                  <li key={index} className=\"mr-2\">\n                    {crumb.href ? (\n                      <Link to={crumb.href} className=\"\">\n                        {crumb.title}\n                        <span className=\"ml-2\">{'>'}</span>\n                      </Link>\n                    ) : (\n                      <span className=\"text-slate-500\">{crumb.title}</span>\n                    )}\n                  </li>\n                );\n              })}\n            </ul>\n          )}\n          {title && (\n            <h1 className=\"mb-5 flex flex-row text-4xl dark:text-white\">\n              {icon && icon({ className: 'h-8 w-8 my-auto mr-4' })} {title}\n            </h1>\n          )}\n        </div>\n        <div className=\"ml-auto\">\n          <div className=\"-m-2 flex flex-col flex-wrap justify-end sm:flex-row sm:items-center\">\n            {actions}\n          </div>\n          {saveStatus && <SaveStatus className=\"mt-1\" state={saveStatus} />}\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default PageMeta;\n","import { Link } from 'react-router-dom';\nimport { t } from '../../../helpers/i18n/dictionary';\nimport useApps from '../../../hooks/apps/useApps';\nimport { RedactedAppRegistration } from '../../../provider/app/AppManagementProviderTypes';\nimport Grid from '../../Icons/Grid/Grid';\nimport PageMeta from '../../Layout/PageMeta/PageMeta';\nimport LoadingParagraph from '../../Loaders/LoadingParagraph/LoadingParagraph';\n\nconst Apps = () => {\n  const { data: registeredApps, isLoading: loadingRegisteredApps } = useApps().fetchRegistered;\n\n  return (\n    <>\n      <section>\n        <PageMeta icon={Grid} title={'Apps'} />\n      </section>\n      {loadingRegisteredApps ? (\n        <>\n          <LoadingParagraph className=\"m-4 h-10\" />\n          <LoadingParagraph className=\"m-4 h-10\" />\n          <LoadingParagraph className=\"m-4 h-10\" />\n        </>\n      ) : (\n        <>\n          {registeredApps?.length\n            ? registeredApps.map((app) => (\n                <AppCard appRegistration={app} key={app.appId} className=\"py-4\" />\n              ))\n            : null}\n        </>\n      )}\n    </>\n  );\n};\n\nconst AppCard = ({\n  appRegistration,\n  className,\n}: {\n  appRegistration: RedactedAppRegistration;\n  className: string;\n}) => {\n  return (\n    <div className={`${className} ${appRegistration.isRevoked ? 'opacity-50' : ''}`}>\n      <Link to={`/owner/apps/${encodeURIComponent(appRegistration.appId)}`} className=\"contents\">\n        <div\n          className={`h-full rounded-md border-[1px] border-gray-200 border-opacity-60 bg-white transition-colors hover:bg-slate-100 dark:border-gray-800 dark:bg-gray-800 dark:hover:bg-slate-700`}\n        >\n          <h2 className=\"bg-slate-100 p-4 text-xl dark:bg-slate-700 dark:text-slate-200\">\n            {appRegistration.isRevoked ? `${t('Revoked')} ` : ''}\n            {appRegistration.name}\n          </h2>\n          <div className=\"p-4\">\n            <p className=\"text-xs\">\n              Created on: {new Date(appRegistration.created).toLocaleDateString()}\n            </p>\n          </div>\n        </div>\n      </Link>\n    </div>\n  );\n};\n\nexport default Apps;\n","import { useQuery } from '@tanstack/react-query';\nimport AppManagementProvider from '../../provider/app/AppManagementProvider';\nimport useAuth from '../auth/useAuth';\n\nconst useApps = () => {\n  const { getSharedSecret } = useAuth();\n\n  const appManagementProvider = AppManagementProvider.getInstance(getSharedSecret());\n\n  const fetchRegistered = async () => {\n    const apps = await appManagementProvider.GetAppRegistrations();\n    return apps?.sort((a, b) => (a.isRevoked ? 1 : 0) - (b.isRevoked ? 1 : 0));\n  };\n\n  return {\n    fetchRegistered: useQuery(['registeredApps'], () => fetchRegistered(), {\n      refetchOnWindowFocus: false,\n    }),\n  };\n};\n\nexport default useApps;\n","import {\n  AppClientRegistrationRequest,\n  AppClientRegistrationResponse,\n  AppRegistrationRequest,\n  RedactedAppRegistration,\n  GetAppRequest,\n} from './AppManagementProviderTypes';\nimport { OwnerProviderBase } from '../OwnerProviderBase';\n\nexport default class AppManagementProvider extends OwnerProviderBase {\n  private static instance: AppManagementProvider;\n  constructor(sharedSecret: Uint8Array | undefined) {\n    super(sharedSecret);\n  }\n\n  //adds the specified client to the list of allowed clients for a given app; returns a CAT\n  async RegisterAppClient(\n    request: AppClientRegistrationRequest\n  ): Promise<AppClientRegistrationResponse> {\n    const client = this.createAxiosClient();\n    const response = await client.post<AppClientRegistrationResponse>(\n      'appmanagement/register/client',\n      request\n    );\n    return response.data;\n  }\n\n  async RegisterChatAppClient_temp(\n    request: AppClientRegistrationRequest\n  ): Promise<AppClientRegistrationResponse> {\n    const client = this.createAxiosClient();\n    const response = await client.post<AppClientRegistrationResponse>(\n      'appmanagement/register/chatclient_temp',\n      request\n    );\n    console.log('RegisterChatAppClient_temp returning response');\n    console.log(response);\n\n    return response.data;\n  }\n\n  async RegisterApp(request: AppRegistrationRequest): Promise<RedactedAppRegistration> {\n    const client = this.createAxiosClient();\n    const response = await client.post<RedactedAppRegistration>(\n      'appmanagement/register/app',\n      request\n    );\n\n    console.log('RegisterApp returning response');\n    console.log(response);\n\n    return response.data;\n  }\n\n  async GetAppRegistration(request: GetAppRequest): Promise<RedactedAppRegistration> {\n    const client = this.createAxiosClient();\n    const response = await client.post<RedactedAppRegistration>('appmanagement/app', request);\n    return response.data;\n  }\n\n  async GetAppRegistrations(): Promise<RedactedAppRegistration[]> {\n    const client = this.createAxiosClient();\n    const response = await client.get<RedactedAppRegistration[]>('appmanagement/list');\n    return response.data;\n  }\n\n  async RevokeApp(request: GetAppRequest): Promise<void> {\n    const client = this.createAxiosClient();\n    await client.post('appmanagement/revoke', request);\n  }\n\n  async AllowApp(request: GetAppRequest): Promise<void> {\n    const client = this.createAxiosClient();\n    const response = await client.post('appmanagement/allow', request);\n    console.log(response);\n  }\n\n  public static getInstance(sharedSecret): AppManagementProvider {\n    if (!AppManagementProvider.instance) {\n      AppManagementProvider.instance = new AppManagementProvider(sharedSecret);\n    }\n\n    return AppManagementProvider.instance;\n  }\n}\n"],"names":["className","state","useState","lastSave","setLastSave","Date","now","setNow","useEffect","timer","setTimeout","clearTimeout","diff","getTime","text","toLocaleString","title","actions","saveStatus","breadCrumbs","icon","map","crumb","index","href","to","AppCard","appRegistration","isRevoked","encodeURIComponent","appId","t","name","created","toLocaleDateString","useApps","fetchRegistered","registeredApps","data","loadingRegisteredApps","isLoading","Grid","length","app","getSharedSecret","useAuth","appManagementProvider","AppManagementProvider","GetAppRegistrations","apps","sort","a","b","useQuery","refetchOnWindowFocus","sharedSecret","request","client","this","createAxiosClient","post","response","console","log","get","instance","OwnerProviderBase"],"sourceRoot":""}