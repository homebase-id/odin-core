{"version":3,"file":"static/js/524.8aec21ff.chunk.js","mappings":"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","sources":["components/Templates/RegisterChatClient/RegisterChatClient.tsx","provider/temp/app/AppManagementProvider.ts","provider/temp/app/AppManagementProviderTypes.ts","../node_modules/react-json-pretty/dist/JSONPretty.js","../node_modules/react-json-pretty/dist/monikai.js"],"sourcesContent":["import useAuth from '../../../hooks/auth/useAuth';\nimport {\n  AppClientRegistrationRequest,\n  AppRegistrationRequest,\n  RedactedAppRegistration,\n  DriveGrantRequest,\n  DrivePermission,\n  PermissionFlags,\n  PermissionSet\n} from \"../../../provider/temp/app/AppManagementProviderTypes\";\nimport {useEffect, useState} from \"react\";\nimport {useSearchParams} from \"react-router-dom\";\nimport AppManagementProvider from \"../../../provider/temp/app/AppManagementProvider\";\nimport {ApiType, DataUtil, DriveProvider} from \"@youfoundation/transit-lib\";\nimport JSONPretty from \"react-json-pretty\";\nimport JSONPrettyMon from 'react-json-pretty/dist/monikai';\n\n// https://frodo.digital/owner/registerchat?fn=todds%20android&rs=odinchat\n\nconst RegisterAppClient = () => {\n  const {getSharedSecret} = useAuth();\n  const [searchParams] = useSearchParams();\n  const [isLoaded, setIsLoaded] = useState<boolean>();\n  const [finalUrl, setFinalUrl] = useState<string | null>();\n  const [appRegistrationRequest, setAppRegistrationRequest] = useState<AppRegistrationRequest | null>(null);\n  const [clientRegistrationRequest, setClientRegistrationRequest] = useState<AppClientRegistrationRequest | null>(null);\n  const [appRegistration, setAppRegistration] = useState<RedactedAppRegistration | null>(null);\n  const [returnScheme, setReturnScheme] = useState<string>();\n\n  const tempProvider = new AppManagementProvider(getSharedSecret());\n  const driveProvider = new DriveProvider({api: ApiType.Owner, sharedSecret: getSharedSecret()});\n  \n  const chatAppId = \"chat-r-box\";\n  const chatAppName = \"Chatrbox\";\n\n  const chatDriveGrantRequest: DriveGrantRequest = {\n    drive: {\n      alias: DataUtil.toByteArrayId(\"chatr-drive\"),\n      type: DataUtil.toByteArrayId(\"chat-data\")\n    },\n    permission: DrivePermission.Read | DrivePermission.Write\n  }\n\n  const chatPermissionSet: PermissionSet = {\n    permissions: PermissionFlags.ReadConnectionRequests | PermissionFlags.ReadConnections\n  }\n\n  useEffect(() => {\n    const init = async () => {\n      const appRegRequest: AppRegistrationRequest = {\n        appId: DataUtil.toByteArrayId(chatAppId),\n        name: chatAppName,\n        permissionSet: chatPermissionSet, //TODO - read from parameter\n        drives: [chatDriveGrantRequest] //TODO - this should be parameter a list of drives for which this app requests access (along with permissions)\n      }\n\n      const clientRegRequest: AppClientRegistrationRequest =\n        {\n          appId: appRegRequest.appId,\n          clientPublicKey64: searchParams.get('pk'),\n          clientFriendlyName: searchParams.get('fn')\n        }\n\n      const appReg = await tempProvider.GetAppRegistration({\n        appId: appRegRequest.appId\n      });\n\n      setAppRegistration(appReg);\n      setAppRegistrationRequest(appRegRequest);\n      setClientRegistrationRequest(clientRegRequest);\n      setReturnScheme(searchParams.get('rs'));\n      setIsLoaded(true);\n    }\n\n    init();\n\n  }, [searchParams])\n\n  const registerApp = async () => {\n\n    await driveProvider.EnsureDrive(chatDriveGrantRequest.drive, \"Chat Drive\", \"Chatr drive\", false);\n    await tempProvider.RegisterApp(appRegistrationRequest);\n    await registerClient();\n  };\n\n  const registerClient = async () => {\n    const clientRegistrationResponse = await tempProvider.RegisterChatAppClient_temp(clientRegistrationRequest);\n    const encodedData = encodeURI(clientRegistrationResponse.data);\n\n    const bytes = DataUtil.base64ToUint8Array(encodedData);\n    console.log('bytes', bytes);\n    const url = `${returnScheme}?d=${encodedData}&v=${clientRegistrationResponse.encryptionVersion}`;\n    // window.location.href = url;\n    setFinalUrl(url);\n  };\n\n  if (!isLoaded) {\n    return (<div>Loading...</div>);\n  }\n\n\n  if (finalUrl) {\n    return (<div className=\"container mx-auto\">\n      You have approved the app...\n      <br/>\n      <br/>\n      <a href={finalUrl}>Click to continue...</a>\n      <br/>\n    </div>)\n  }\n\n  return (\n    <section className=\"mt-20\">\n      <div className=\"container mx-auto\">\n        <div className=\"-m-5 flex flex-wrap\">\n\n          {isLoaded && appRegistration == null &&\n              <div className=\"row\">\n                  <div className=\"px-5\">\n                      App with id {appRegistrationRequest.appId} is not registered.\n                      <br/>\n                      Clicking OK will approve the app for use and register this client\n                  </div>\n                  <div className=\"px-5\">\n                      <a\n                          onClick={registerApp}\n                          className=\"mt-10 block rounded border-0 bg-green-500 py-2 px-4 text-white hover:bg-green-600 focus:outline-none\">\n                          Register Now\n                      </a>\n                  </div>\n              </div>\n          }\n\n          {isLoaded && appRegistration != null &&\n              <div className=\"row\">\n                  <div className=\"px-5\">\n                      <div className=\"pb-2\">The App '{appRegistration?.name}' is registered</div>\n                      <JSONPretty id=\"json-pretty\" theme={JSONPrettyMon} data={DataUtil.JsonStringify64(appRegistration)}></JSONPretty>\n                  </div>\n                  <div className=\"px-5\">\n                      <a\n                          onClick={registerClient}\n                          className=\"mt-10 block rounded border-0 bg-green-500 py-2 px-4 text-white hover:bg-green-600 focus:outline-none\">\n                          Register this Client\n                      </a>\n                  </div>\n              </div>}\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default RegisterAppClient;\n","import {\n  AppClientRegistrationRequest,\n  AppClientRegistrationResponse,\n  AppRegistrationRequest,\n  RedactedAppRegistration,\n  GetAppRequest,\n} from './AppManagementProviderTypes';\nimport { OwnerProviderBase } from '../../OwnerProviderBase';\n\nexport default class AppManagementProvider extends OwnerProviderBase {\n  constructor(sharedSecret: Uint8Array | undefined) {\n    super(sharedSecret);\n  }\n\n  //adds the specified client to the list of allowed clients for a given app; returns a CAT\n  async RegisterAppClient(\n    request: AppClientRegistrationRequest\n  ): Promise<AppClientRegistrationResponse> {\n    const client = this.createAxiosClient();\n    const response = await client.post<AppClientRegistrationResponse>(\n      'appmanagement/register/client',\n      request\n    );\n    return response.data;\n  }\n  \n  async RegisterChatAppClient_temp(\n    request: AppClientRegistrationRequest\n  ): Promise<AppClientRegistrationResponse> {\n    const client = this.createAxiosClient();\n    const response = await client.post<AppClientRegistrationResponse>(\n      'appmanagement/register/chatclient_temp',\n      request\n    );\n    console.log('RegisterChatAppClient_temp returning response');\n    console.log(response);\n    \n    return response.data;\n  }\n  \n  async RegisterApp(request: AppRegistrationRequest): Promise<RedactedAppRegistration> {\n    const client = this.createAxiosClient();\n    const response = await client.post<RedactedAppRegistration>(\n      'appmanagement/register/app',\n      request\n    );\n  \n    console.log('RegisterApp returning response');\n    console.log(response);\n    \n    return response.data;\n  }\n\n  async GetAppRegistration(request: GetAppRequest): Promise<RedactedAppRegistration> {\n    const client = this.createAxiosClient();\n    const response = await client.post<RedactedAppRegistration>('appmanagement/app', request);\n    return response.data;\n  }\n}\n","export interface AppClientRegistrationRequest {\n  appId: string;\n  clientFriendlyName: string;\n  clientPublicKey64: string\n}\n\nexport interface AppClientRegistrationResponse {\n  /** Version number for how the data field is encrypted */\n  encryptionVersion: number,\n\n  /** RSA encrypted response.  When encryption version == 1, the  first 16 bytes is token id, second 16 bytes is AccessTokenHalfKey, and last 16 bytes is SharedSecret */\n  data: string,\n\n  /** A Guid representing the Id of the access registration */\n  token: string\n}\n\nexport interface GetAppRequest {\n  /** @format uuid */\n  appId: string;\n}\n\nexport interface AppRegistrationRequest {\n  /** @format uuid */\n  appId: string;\n  name: string | null;\n  permissionSet?: PermissionSet;\n\n  /** The list of drives of which this app should receive access */\n  drives?: DriveGrantRequest[] | null;\n}\n\nexport interface DriveGrantRequest {\n  drive: TargetDrive;\n  permission: DrivePermission;\n}\n\nexport interface TargetDrive {\n  alias: string;\n  type: string;\n}\n\nexport interface RedactedAppRegistration {\n  appId: string;\n  name: string;\n  created: number;\n  isRevoked: boolean;\n  grant: RedactedExchangeGrant\n}\n\nexport interface RedactedExchangeGrant {\n  isRevoked: boolean;\n  permissionSet: PermissionSet;\n  driveGrants: RedactedDriveGrant[];\n}\n\nexport interface RedactedDriveGrant {\n  TargetDrive: TargetDrive;\n  Permission: DrivePermission;\n}\n\nexport enum DrivePermission {\n  None = 0,\n  Read = 1 << 0,\n  Write = 1 << 2\n}\n\nexport interface PermissionSet {\n  permissions: PermissionFlags\n}\n\nexport enum PermissionFlags {\n  None = 0,\n\n  ApproveConnection = 1 << 0,\n\n  ReadConnections = 1 << 1,\n\n  UpdateConnections = 1 << 2,\n\n  DeleteConnections = 1 << 3,\n\n  CreateOrSendConnectionRequests = 1 << 4,\n\n  ReadConnectionRequests = 1 << 5,\n\n  DeleteConnectionRequests = 1 << 6,\n\n}\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n            t[p[i]] = s[p[i]];\n    return t;\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nvar PropTypes = __importStar(require(\"prop-types\"));\nvar React = __importStar(require(\"react\"));\nfunction getStyleValue(name, theme, styles) {\n    var extra = styles[name + 'Style'] || '';\n    var style = theme ? theme[name] || '' : '';\n    return extra ? extra + \";\" + style : style;\n}\nfunction getStyle(name, theme, styles) {\n    var value = getStyleValue(name, theme, styles);\n    return value ? \" style=\\\"\" + value + \"\\\"\" : '';\n}\nvar xssmap = {\n    '\"': '&quot;',\n    '\\'': '&apos;',\n    '&': '&amp;',\n    '>': '&gt;',\n    '<': '&lt',\n};\nfunction xss(s) {\n    if (!s) {\n        return s;\n    }\n    return s.replace(/<|>|&|\"|'/g, function (m) {\n        return xssmap[m];\n    });\n}\nvar JSONPretty = /** @class */ (function (_super) {\n    __extends(JSONPretty, _super);\n    function JSONPretty() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    JSONPretty.prototype.render = function () {\n        var _a = this.props, json = _a.json, data = _a.data, replacer = _a.replacer, space = _a.space, themeClassName = _a.themeClassName, theme = _a.theme, onJSONPrettyError = _a.onJSONPrettyError, onError = _a.onError, silent = _a.silent, mainStyle = _a.mainStyle, keyStyle = _a.keyStyle, valueStyle = _a.valueStyle, stringStyle = _a.stringStyle, booleanStyle = _a.booleanStyle, errorStyle = _a.errorStyle, rest = __rest(_a, [\"json\", \"data\", \"replacer\", \"space\", \"themeClassName\", \"theme\", \"onJSONPrettyError\", \"onError\", \"silent\", \"mainStyle\", \"keyStyle\", \"valueStyle\", \"stringStyle\", \"booleanStyle\", \"errorStyle\"]);\n        var styles = {\n            mainStyle: mainStyle,\n            keyStyle: keyStyle,\n            valueStyle: valueStyle,\n            stringStyle: stringStyle,\n            booleanStyle: booleanStyle,\n            errorStyle: errorStyle\n        };\n        var obj = data || json;\n        // See https://facebook.github.io/react/warnings/unknown-prop.html\n        if (typeof obj === 'string') {\n            try {\n                obj = JSON.parse(obj);\n            }\n            catch (e) {\n                if (!silent) {\n                    console.warn(\"[react-json-pretty]: \" + e.message);\n                }\n                if (onJSONPrettyError) {\n                    onJSONPrettyError(e);\n                }\n                if (!onJSONPrettyError && onError) {\n                    onError(e);\n                    console.warn('JSONPretty#onError is deprecated, please use JSONPretty#onJSONPrettyError instead');\n                }\n                return (React.createElement(\"div\", __assign({}, rest, { dangerouslySetInnerHTML: { __html: \"<pre class=\\\"__json-pretty-error__\\\"\" + getStyle('error', theme, styles) + \">\" + xss(obj) + \"</pre>\"\n                    } })));\n            }\n        }\n        return (React.createElement(\"div\", __assign({}, rest, { dangerouslySetInnerHTML: { __html: \"<pre class=\\\"\" + themeClassName + \"\\\"\" + getStyle('main', theme, styles) + \">\" + this._pretty(theme, obj, replacer, +space, styles) + \"</pre>\"\n            } })));\n    };\n    // JSON =》 HTML转换器\n    JSONPretty.prototype._pretty = function (theme, obj, replacer, space, styles) {\n        // 逐行匹配，列举：“key”: \"value\" | \"key\": value | \"key\": [ | \"key\": { | \"key\": [],| \"Key\": {},\n        var regLine = /^( *)(\"[^\"]+\": )?(\"[^\"]*\"|[\\w.+-]*)?([,[{]|\\[\\s*\\],?|\\{\\s*\\},?)?$/mg;\n        var text = JSON.stringify(obj, typeof replacer === 'function' ? replacer : null, isNaN(space) ? 2 : space);\n        /* istanbul ignore next */\n        if (!text) {\n            return text;\n        }\n        return text.replace(/&/g, '&amp;').replace(/\\\\\"([^,])/g, '\\\\&quot;$1')\n            .replace(/</g, '&lt;').replace(/>/g, '&gt;')\n            .replace(regLine, this._replace.bind(null, theme, styles));\n    };\n    // 格式化函数\n    JSONPretty.prototype._replace = function (theme, styles, match, ind, key, val, tra) {\n        var spanEnd = '</span>';\n        var keySpan = \"<span class=\\\"__json-key__\\\"\" + getStyle('key', theme, styles) + \">\";\n        var valSpan = \"<span class=\\\"__json-value__\\\"\" + getStyle('value', theme, styles) + \">\";\n        var strSpan = \"<span class=\\\"__json-string__\\\"\" + getStyle('string', theme, styles) + \">\";\n        var booSpan = \"<span class=\\\"__json-boolean__\\\"\" + getStyle('boolean', theme, styles) + \">\";\n        var sps = ind || '';\n        if (key) {\n            sps = sps + '\"' + keySpan + key.replace(/^\"|\":\\s$/g, '') + spanEnd + '\": ';\n        }\n        if (val) {\n            if (val === 'true' || val === 'false') {\n                sps = sps + booSpan + val + spanEnd;\n            }\n            else {\n                sps = sps + (val[0] === '\"' ? strSpan : valSpan) + val + spanEnd;\n            }\n        }\n        return sps + (tra || '');\n    };\n    JSONPretty.propTypes = {\n        data: PropTypes.any,\n        json: PropTypes.any,\n        replacer: PropTypes.func,\n        silent: PropTypes.bool,\n        space: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n        theme: PropTypes.object,\n        themeClassName: PropTypes.string,\n        onJSONPrettyError: PropTypes.func\n    };\n    JSONPretty.defaultProps = {\n        data: '',\n        json: '',\n        silent: true,\n        space: 2,\n        themeClassName: '__json-pretty__',\n    };\n    return JSONPretty;\n}(React.Component));\nmodule.exports = JSONPretty;\n","\"use strict\";\nmodule.exports = {\n    main: 'line-height:1.3;color:#66d9ef;background:#272822;overflow:auto;',\n    error: 'line-height:1.3;color:#66d9ef;background:#272822;overflow:auto;',\n    key: 'color:#f92672;',\n    string: 'color:#fd971f;',\n    value: 'color:#a6e22e;',\n    boolean: 'color:#ac81fe;',\n};\n"],"names":["getSharedSecret","useAuth","useSearchParams","searchParams","useState","isLoaded","setIsLoaded","finalUrl","setFinalUrl","appRegistrationRequest","setAppRegistrationRequest","clientRegistrationRequest","setClientRegistrationRequest","appRegistration","setAppRegistration","returnScheme","setReturnScheme","tempProvider","AppManagementProvider","driveProvider","DriveProvider","api","ApiType","sharedSecret","chatDriveGrantRequest","drive","alias","DataUtil","type","permission","DrivePermission","chatPermissionSet","permissions","PermissionFlags","useEffect","init","appRegRequest","appId","name","permissionSet","drives","clientRegRequest","clientPublicKey64","get","clientFriendlyName","GetAppRegistration","appReg","registerApp","EnsureDrive","RegisterApp","registerClient","RegisterChatAppClient_temp","clientRegistrationResponse","encodedData","encodeURI","data","bytes","console","log","url","encryptionVersion","className","href","onClick","id","theme","JSONPrettyMon","request","client","this","createAxiosClient","post","response","OwnerProviderBase","__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__rest","e","indexOf","getOwnPropertySymbols","__importStar","mod","__esModule","result","k","PropTypes","require","React","getStyle","styles","value","extra","style","getStyleValue","xssmap","JSONPretty","_super","render","_a","props","json","replacer","space","themeClassName","onJSONPrettyError","onError","silent","mainStyle","keyStyle","valueStyle","stringStyle","booleanStyle","errorStyle","rest","obj","JSON","parse","warn","message","createElement","dangerouslySetInnerHTML","__html","replace","m","_pretty","text","stringify","isNaN","_replace","bind","match","ind","key","val","tra","spanEnd","keySpan","valSpan","strSpan","booSpan","sps","propTypes","any","func","bool","oneOfType","number","string","object","defaultProps","Component","module","exports","main","error","boolean"],"sourceRoot":""}