"use strict";(self.webpackChunkowner_app=self.webpackChunkowner_app||[]).push([[23],{3023:function(e,r,s){s.r(r),s.d(r,{default:function(){return N}});var n=s(4165),i=s(5861),t=s(9439),a=s(630),c=s(2851),l=s(1434),o=s(8321),d=s(1869),m=s(4990),p=s(5809),u=s(2562),x=s(7927),h=s(7385),v=s(184),g=function(e){var r,s,n=e.driveGrant,i=e.permissionTree,t=e.className,a=(0,p.Z)({targetDrive:n.permissionedDrive.drive}).fetch.data;return(0,v.jsxs)("div",{className:"flex flex-row ".concat(t),title:i,children:[(0,v.jsx)(x.Z,{className:"mt-1 mb-auto mr-3 h-6 w-6"}),(0,v.jsxs)("div",{className:"flex flex-col",children:[(0,v.jsxs)("p",{className:"leading-none ".concat(i?"":"my-auto"),children:[null!==(r=null===a||void 0===a?void 0:a.name)&&void 0!==r?r:"".concat((0,m.t)("New")," ").concat(null===(s=n.driveMeta)||void 0===s?void 0:s.name),":"," ",(0,h.hz)(n.permissionedDrive.permission,u.Ac).name]}),i&&(0,v.jsx)("small",{className:"ml-1",children:i})]})]},"".concat(n.permissionedDrive.drive.alias,"-").concat(n.permissionedDrive.drive.type))},f=s(2791),y=s(3504),j=s(2042),N=function(){var e,r,s,m,p=(0,y.lr)(),u=(0,t.Z)(p,1)[0],x=u.get("appId"),h=u.get("n"),N=u.get("p"),w=u.get("pk"),Z=u.get("fn"),k=u.get("return"),b=u.get("d");try{var D=b&&JSON.parse(b);m=(Array.isArray(D)?D:[D]).map((function(e){return{permissionedDrive:{drive:{alias:e.a,type:e.t},permission:parseInt(e.p)},driveMeta:{name:e.n,description:e.d}}}))}catch(V){return console.error(V),(0,v.jsx)("div",{children:"Bad request"})}if(!x||!h||!w||!Z||!k)return console.error("Any of the following required params was not found in the url: appId, name, publicKey64, friendlyName, returnUrl"),(0,v.jsx)("div",{children:"Bad request"});var A=(0,a.Z)({appId:x}),I=A.fetch,B=I.data,q=I.isLoading,C=A.registerNewApp,F=C.mutateAsync,G=C.status,S=C.error,O=A.registerNewAppClient,R=O.mutateAsync,T=O.status,U=O.error,K=(0,f.useState)(),L=(0,t.Z)(K,2),M=L[0],_=L[1],z={keys:null!==(e=null===N||void 0===N?void 0:N.split(",").map((function(e){return parseInt(e)})))&&void 0!==e?e:[]},J=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F({appId:x,name:h,permissionSet:z,driveGrants:m});case 2:return e.next=4,P();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var r,s,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R({appId:x,clientPublicKey64:w,clientFriendlyName:Z});case 2:r=e.sent,s=encodeURI(r.data),i="".concat(k,"d=").concat(s,"&v=").concat(r.encryptionVersion),console.log(i),_(i);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return q?(0,v.jsx)("div",{children:"Loading..."}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(j.Z,{error:S}),(0,v.jsx)(j.Z,{error:U}),(0,v.jsx)("section",{className:"my-20",children:(0,v.jsx)("div",{className:"container mx-auto",children:(0,v.jsx)("div",{className:"max-w-[35rem]",children:B?(0,v.jsxs)(v.Fragment,{children:[M?(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)("h1",{className:"mb-5 text-4xl dark:text-white",children:["Scucessfully registered client: ",Z," on app: ",h]})}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("h1",{className:"mb-5 text-4xl dark:text-white",children:["Register client: ",Z]}),(0,v.jsxs)("p",{children:["The app ",h," is registered on your identity."]}),(0,v.jsx)("p",{className:"mt-2",children:"It has the following access on your identity and the following drives:"})]}),null!==(r=B.grant.permissionSet)&&void 0!==r&&r.keys?(0,v.jsx)(l.Z,{isOpaqueBg:!0,children:(0,v.jsx)("div",{className:"-my-4",children:B.grant.permissionSet.keys.map((function(e){return(0,v.jsx)(o.Z,{permission:e,className:"my-4"},"".concat(e))}))})}):null,null!==(s=B.grant)&&void 0!==s&&s.driveGrants?(0,v.jsx)(l.Z,{isOpaqueBg:!0,children:(0,v.jsx)("div",{className:"-my-4",children:B.grant.driveGrants.map((function(e){return(0,v.jsx)(d.Z,{driveGrant:e,className:"my-4"},"".concat(e.permissionedDrive.drive.alias,"-").concat(e.permissionedDrive.drive.type))}))})}):null,M?(0,v.jsxs)(v.Fragment,{children:["Url:",(0,v.jsx)("div",{className:"overflow-x-scroll whitespace-nowrap",children:M}),(0,v.jsx)("div",{className:"flex flex-row justify-end",children:(0,v.jsxs)(c.Z,{onClick:function(){window.location.href=M},className:"mt-10 block rounded border-0 bg-green-500 py-2 px-4 text-white hover:bg-green-600 focus:outline-none",state:T,children:["Back to ",h]})})]}):(0,v.jsx)("div",{className:"flex flex-row justify-end",children:(0,v.jsxs)(c.Z,{onClick:P,className:"mt-10 block rounded border-0 bg-green-500 py-2 px-4 text-white hover:bg-green-600 focus:outline-none",state:T,children:["Register ",Z]})})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("h1",{className:"mb-5 text-4xl dark:text-white",children:["Registering app: ",h," ",(0,v.jsxs)("small",{className:"block",children:["client: ",Z]})]}),(0,v.jsxs)("p",{children:["The app ",h," is not registered on your identity."]}),(0,v.jsxs)("p",{className:"mt-2",children:['By registering this app, "',h,'" will have the following access on your identity and the following drives:']}),(0,v.jsx)(l.Z,{isOpaqueBg:!0,children:(0,v.jsx)("div",{className:"-my-4",children:z.keys.map((function(e){return(0,v.jsx)(o.Z,{permission:e,className:"my-4"},"".concat(e))}))})}),(0,v.jsx)(l.Z,{isOpaqueBg:!0,children:(0,v.jsx)("div",{className:"-my-4",children:m.map((function(e){return(0,v.jsx)(g,{driveGrant:e,className:"my-4"},"".concat(e.permissionedDrive.drive.alias,"-").concat(e.permissionedDrive.drive.type))}))})}),(0,v.jsxs)("div",{className:"-sm:mx-2 mt-10 sm:flex sm:flex-row-reverse",children:[(0,v.jsxs)(c.Z,{onClick:J,className:"my-3 block rounded border-0 bg-green-500 py-2 px-4 text-white hover:bg-green-600 focus:outline-none sm:mx-2 sm:my-auto",state:(0,c.s)(G,T),children:["Allow access and Register ",h]}),(0,v.jsx)(c.Z,{className:"my-3 sm:mx-2 sm:my-auto",type:"secondary",children:"Cancel"})]})]})})})})]})}}}]);
//# sourceMappingURL=23.1535aa1e.chunk.js.map