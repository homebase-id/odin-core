"use strict";(self.webpackChunkowner_app=self.webpackChunkowner_app||[]).push([[120],{7272:function(e,r,n){var t=n(1413),a=n(5713),i=n(4411),s=n(9835),o=n(184);r.Z=function(e){var r,n,l=(0,a.Z)({dotYouId:e.dotYouId}).fetch,c=l.data,u=l.isLoading,d=null===c||void 0===c?void 0:c.name,m=d?"".concat(null!==(r=d.givenName)&&void 0!==r?r:""," ").concat(null!==(n=d.surname)&&void 0!==n?n:""):e.dotYouId;return u?(0,o.jsx)(i.Z,{className:"aspect-[3/5] ".concat(e.className)}):(0,o.jsxs)(s.Z,(0,t.Z)((0,t.Z)({},e),{},{children:[(0,o.jsx)("h2",{className:"font-thiner mb-6 dark:text-white",children:null!==m&&void 0!==m?m:e.dotYouId}),e.children]}))}},8522:function(e,r,n){n.d(r,{Z:function(){return m}});var t=n(9439),a=n(2791),i=n(5713),s=n(9779),o=n(9006),l=n(365),c=n(184),u=function(e){var r=e.className;return(0,c.jsxs)("svg",{className:r,stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[(0,c.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,c.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})},d=n(4411),m=function(e){var r,n=e.dotYouId,m=e.onlyLoadAfterClick,v=(0,a.useState)(!1),f=(0,t.Z)(v,2),x=f[0],h=f[1],p=(0,i.Z)({dotYouId:n,loadPendingProfilePicture:!m||x}).fetch,g=p.data,b=p.isLoading,j=("pending"===(null===g||void 0===g?void 0:g.source)||"public"===(null===g||void 0===g?void 0:g.source))&&m,Z=(0,s.Z)(j?x&&(null===g||void 0===g?void 0:g.imageFileId)||void 0:null===g||void 0===g?void 0:g.imageFileId,o.F.ContactTargetDrive).fetch.data,y=null===g||void 0===g?void 0:g.name;return(0,c.jsxs)("div",{className:"relative aspect-square",children:[b?(0,c.jsx)(d.Z,{className:"aspect-square"}):null!==g&&void 0!==g&&g.imageUrl||Z?(0,c.jsx)("figure",{className:"relative overflow-hidden",children:(0,c.jsx)("img",{src:null!==(r=g.imageUrl)&&void 0!==r?r:Z,className:"aspect-square w-full object-cover"})}):(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(l.Z,{initials:function(){var e,r;if(y)return(null===(e=y.givenName)||void 0===e?void 0:e[0])+(null===(r=y.surname)||void 0===r?void 0:r[0])+"";var t=null===n||void 0===n?void 0:n.split(".");return(null===t||void 0===t?void 0:t.length)>=2?t[0][0]+t[1][0]+"":"--"}()})}),!0===j&&(0,c.jsxs)("button",{className:"absolute bottom-2 right-2 bg-white bg-opacity-60 p-2 hover:bg-opacity-100 dark:bg-black dark:bg-opacity-60 hover:dark:bg-opacity-100",onClick:function(e){return e.preventDefault(),h(!x),!1},children:[(0,c.jsx)(u,{className:"h-4 w-4"}),x&&(0,c.jsx)("span",{className:"absolute bottom-[0.9rem] right-[0.2rem] block w-[1.5rem] rotate-45 border-b-[2px] border-black dark:border-white"})]})]})}},9835:function(e,r,n){var t=n(8522),a=n(184);r.Z=function(e){var r=e.dotYouId,n=e.href,i=e.isChecked,s=e.className,o=e.children,l=e.onClick,c=e.onlyLoadAfterClick;return(0,a.jsx)("a",{className:"".concat(s),href:n,children:(0,a.jsxs)("div",{className:"h-full rounded-md border bg-white transition-colors  ".concat(i?"border-4 border-indigo-500 dark:border-indigo-700":!1===i?"border-4":"border-gray-200 border-opacity-60 dark:border-gray-800 dark:bg-gray-800","\n        ").concat(n?"cursor-pointer hover:shadow-md hover:dark:shadow-slate-600":""),onClick:l,children:[(0,a.jsx)(t.Z,{dotYouId:r,onlyLoadAfterClick:c}),(0,a.jsx)("div",{className:"p-2",children:o})]})})}},4523:function(e,r,n){n.d(r,{Z:function(){return S}});var t=n(3433),a=n(4165),i=n(5861),s=n(1413),o=n(9439),l=n(2791),c=n(4164),u=n(4990),d=n(4075),m=n(6770),v=n(3412),f=n(2562),x=n(2042),h=n(2851),p=n(6916),g=n(3147),b=n(1261),j=n(4311),Z=n(8602),y=n(184),N=function(e){var r=e.className,n=e.isChecked,t=e.children,a=e.onChange;return(0,y.jsxs)("li",{className:"flex min-w-[16rem] cursor-pointer select-none flex-row py-1 px-4 hover:bg-slate-100 dark:hover:bg-slate-700 ".concat(r),onClick:a,children:[(0,y.jsx)(j.Z,{className:"my-auto mr-3 h-4 w-4 flex-shrink-0 ".concat(n?"text-slate-700 dark:text-slate-200":"text-transparent")})," ",(0,y.jsx)("span",{className:"mr-auto block h-full py-1",children:t})]})},w=function(e){var r,n,a=e.className,i=e.permissionLevels,s=e.onChange,c=e.defaultValue,u=(0,l.useState)(!1),d=(0,o.Z)(u,2),m=d[0],v=d[1],f=(0,l.useState)(c),x=(0,o.Z)(f,2),h=x[0],p=x[1],g=(0,l.useRef)(null);(0,b.Z)(g,(function(){return v(!1)}));var j=(null===c||void 0===c?void 0:c.length)>=2?"Multiple":null!==(r=null!==c&&void 0!==c&&c[0]?null===(n=i.find((function(e){return e.value===c[0]})))||void 0===n?void 0:n.name:i[0].name)&&void 0!==r?r:i[0].name,w=function(e){p(e),s&&s(e)};return(0,y.jsx)("div",{className:null!==a&&void 0!==a?a:"",children:(0,y.jsxs)("div",{className:"relative cursor-pointer rounded-md bg-slate-100 dark:bg-slate-800",onClick:function(){return v(!m)},ref:g,children:[(0,y.jsxs)("div",{className:"flex min-w-[6rem] flex-row py-1 px-2",children:[(0,y.jsx)("span",{className:"my-auto mr-2 select-none",children:j})," ",(0,y.jsx)(Z.Z,{className:"my-auto ml-auto h-2 w-2 rotate-90"})]}),(0,y.jsx)("ul",{className:"absolute top-[100%] right-0 overflow-hidden bg-white dark:bg-slate-800 ".concat(m?"z-10 max-h-[30rem] border border-slate-100 py-3 shadow-2xl dark:border-slate-700":"max-h-0"),children:i.map((function(e){return(0,y.jsx)(N,{isChecked:h.some((function(r){return r===e.value}))||0===h.length&&0===e.value,onChange:function(){return h.some((function(r){return r===e.value}))?w(h.filter((function(r){return r!==e.value}))):0!==e.value?w([].concat((0,t.Z)(h),[e.value])):w([])},children:e.name},e.value)}))})]})})},k=n(2284),C=n(2465),I=n(7927),D=n(8930),S=function(e){var r,n=e.title,b=e.confirmText,j=e.isOpen,Z=e.defaultValue,N=e.onConfirm,S=e.onCancel,O=(0,v.Z)("modal-container"),Y=(0,d.Z)({}).createOrUpdate,A=Y.mutateAsync,P=Y.status,F=Y.error,G=(0,m.Z)().fetch.data,L=(0,l.useState)((0,s.Z)({driveGrants:Z.driveGrants||[]},Z)),z=(0,o.Z)(L,2),M=z[0],R=z[1];if((0,l.useEffect)((function(){j&&R((0,s.Z)({driveGrants:Z.driveGrants||[]},Z))}),[j]),!j)return null;var T=function(){R((0,s.Z)({driveGrants:Z.driveGrants||[]},Z))},q=(0,y.jsx)(D.Z,{title:n,onClose:S,size:"4xlarge",children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(x.Z,{error:F}),(0,y.jsxs)("form",{onSubmit:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(r){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,A(M);case 3:return T(),N(),e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),children:[(0,y.jsxs)("div",{className:"mb-5",children:[(0,y.jsx)(g.Z,{htmlFor:"name",children:(0,u.t)("Name")}),(0,y.jsx)(p.Z,{id:"name",name:"circleName",defaultValue:M.name,onChange:function(e){R((0,s.Z)((0,s.Z)({},M),{},{name:e.target.value}))},required:!0})]}),(0,y.jsxs)("div",{className:"mb-5",children:[(0,y.jsx)(g.Z,{htmlFor:"name",children:(0,u.t)("Description")}),(0,y.jsx)(C.Z,{id:"description",name:"circleDescription",defaultValue:M.description,onChange:function(e){R((0,s.Z)((0,s.Z)({},M),{},{description:e.target.value}))},required:!0})]}),(0,y.jsxs)("div",{className:"mb-5 flex flex-row",children:[(0,y.jsx)(g.Z,{htmlFor:"name",className:"my-auto mr-2",children:(0,u.t)("Permissions")}),(0,y.jsx)(w,{className:"ml-auto",permissionLevels:f.WW,defaultValue:null!==(r=M.permissions.keys)&&void 0!==r?r:[0],onChange:function(e){R((0,s.Z)((0,s.Z)({},M),{},{permissions:{keys:e}}))}})]}),null!==G&&void 0!==G&&G.length?(0,y.jsxs)("div",{className:"my-7",children:[(0,y.jsxs)("div",{className:"mb-8",children:[(0,y.jsxs)("h2",{className:"text-lg",children:[(0,u.t)("Drive Permissions"),":"]}),(0,y.jsx)("p",{className:"text-sm text-slate-500",children:(0,u.t)("Drives with anonymous access enabled are available to any user")})]}),(0,y.jsx)("div",{className:"-my-4",children:G.filter((function(e){return!e.ownerOnly})).map((function(e,r){var n,a,i,o,l,c,d=null!==(n=null===(a=M.driveGrants)||void 0===a||null===(i=a.find((function(r){return r.permissionedDrive.drive.alias===e.targetDriveInfo.alias&&r.permissionedDrive.drive.type===e.targetDriveInfo.type})))||void 0===i?void 0:i.permissionedDrive.permission)&&void 0!==n?n:0;return(0,y.jsxs)("div",{className:"my-4 flex w-full select-none flex-row rounded-lg border p-4 dark:border-slate-800 ".concat(d>0&&"bg-slate-50 dark:bg-slate-700"),children:[(0,y.jsx)(I.Z,{className:"my-auto mr-3 h-6 w-6"}),(0,y.jsxs)(g.Z,{htmlFor:"".concat(e.targetDriveInfo.alias,"-").concat(e.targetDriveInfo.type),className:"mt-auto mb-auto mr-2",children:[e.name,(0,y.jsx)("small",{className:"block text-sm text-slate-500",children:e.allowAnonymousReads&&(0,u.t)("Allows anonymous access")})]}),(0,y.jsx)(k.Z,{className:"my-auto ml-auto",permissionLevels:f.Ac,defaultValue:null!==(o=null===(l=M.driveGrants)||void 0===l||null===(c=l.find((function(r){return r.permissionedDrive.drive.alias===e.targetDriveInfo.alias&&r.permissionedDrive.drive.type===e.targetDriveInfo.type})))||void 0===c?void 0:c.permissionedDrive.permission)&&void 0!==o?o:0,onChange:function(r){var n;r>0?R((0,s.Z)((0,s.Z)({},M),{},{driveGrants:[].concat((0,t.Z)((null===M||void 0===M||null===(n=M.driveGrants)||void 0===n?void 0:n.filter((function(r){var n,t;return(null===(n=r.permissionedDrive)||void 0===n?void 0:n.drive.alias)!==e.targetDriveInfo.alias||(null===(t=r.permissionedDrive)||void 0===t?void 0:t.drive.type)!==e.targetDriveInfo.type})))||[]),[{permissionedDrive:{drive:e.targetDriveInfo,permission:r}}])})):R((0,s.Z)((0,s.Z)({},M),{},{driveGrants:(0,t.Z)(M.driveGrants.filter((function(r){return r.permissionedDrive.drive.alias!==e.targetDriveInfo.alias||r.permissionedDrive.drive.type!==e.targetDriveInfo.type})))}))}})]},r)}))})]}):null,(0,y.jsxs)("div",{className:"-m-2 flex flex-row-reverse py-3",children:[(0,y.jsx)(h.Z,{className:"m-2",state:P,icon:"send",children:b||(0,u.t)("Add Circle")}),(0,y.jsx)(h.Z,{className:"m-2",type:"secondary",onClick:function(){T(),S()},children:(0,u.t)("Cancel")})]})]})]})});return(0,c.createPortal)(q,O)}},2284:function(e,r,n){var t=n(9439),a=n(2791),i=n(1261),s=n(4311),o=n(8602),l=n(184),c=function(e){var r=e.className,n=e.isChecked,t=e.children,a=e.onChange;return(0,l.jsxs)("li",{className:"flex min-w-[8rem] cursor-pointer select-none flex-row py-1 px-4 hover:bg-slate-100 dark:hover:bg-slate-700 ".concat(r),onClick:a,children:[(0,l.jsx)(s.Z,{className:"my-auto mr-3 h-4 w-4 flex-shrink-0  ".concat(n?"text-slate-700 dark:text-slate-200":"text-transparent")})," ",(0,l.jsx)("span",{className:"mr-auto block h-full py-1",children:t})]})};r.Z=function(e){var r=e.className,n=e.permissionLevels,s=e.onChange,u=e.defaultValue,d=(0,a.useState)(!1),m=(0,t.Z)(d,2),v=m[0],f=m[1],x=(0,a.useState)(u),h=(0,t.Z)(x,2),p=h[0],g=h[1],b=(0,a.useRef)(null);(0,i.Z)(b,(function(){return f(!1)}));var j=n.reduce((function(e,r){return r.value>e.value&&r.value<=u?r:e}),n[0]),Z=function(e){g(e),s(e)};return(0,l.jsx)("div",{className:null!==r&&void 0!==r?r:"",children:(0,l.jsxs)("div",{className:"relative cursor-pointer rounded-md bg-slate-100 dark:bg-slate-800",onClick:function(){return f(!v)},ref:b,children:[(0,l.jsxs)("div",{className:"flex min-w-[6rem] flex-row py-1 px-2",children:[(0,l.jsx)("span",{className:"my-auto mr-2 select-none",children:j.name})," ",(0,l.jsx)(o.Z,{className:"my-auto ml-auto h-2 w-2 rotate-90"})]}),(0,l.jsx)("ul",{className:"absolute top-[100%] right-0 overflow-hidden bg-white dark:bg-slate-800 ".concat(v?"z-10 max-h-[30rem] border border-slate-100 py-3 shadow-2xl dark:border-slate-700":"max-h-0"),children:n.map((function(e){return(0,l.jsx)(c,{isChecked:0===e.value?p===e.value:p>=e.value,onChange:function(){return p!==e.value?Z(e.value):Z(0)},children:e.name},e.value)}))})]})})}},2465:function(e,r,n){var t=n(1413),a=n(184);r.Z=function(e){return(0,a.jsx)("textarea",(0,t.Z)((0,t.Z)({},e),{},{className:"w-full rounded border border-gray-300 bg-white py-1 px-3 text-base leading-8 text-gray-700 outline-none transition-colors duration-200 ease-in-out focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 ".concat(e.className)}))}},1869:function(e,r,n){var t=n(3504),a=n(4990),i=n(5809),s=n(2562),o=n(706),l=n(7927),c=n(4411),u=n(7385),d=n(184);r.Z=function(e){var r,n,m,v,f,x=e.driveGrant,h=e.permissionTree,p=e.className,g=(0,i.Z)({targetDrive:x.permissionedDrive.drive}).fetch,b=g.data;return g.isLoading?(0,d.jsx)(c.Z,{className:"h-4 max-w-xs ".concat(p)}):(0,d.jsx)("div",{className:"flex flex-row ".concat(p),title:h,children:(0,d.jsxs)(t.rU,{to:"/owner/drives/".concat(null===b||void 0===b||null===(v=b.targetDriveInfo)||void 0===v?void 0:v.alias,"_").concat(null===b||void 0===b||null===(f=b.targetDriveInfo)||void 0===f?void 0:f.type),className:"flex flex-row hover:text-slate-700 hover:underline dark:hover:text-slate-400",children:[(0,d.jsx)(l.Z,{className:"mt-1 mb-auto mr-3 h-6 w-6"}),(0,d.jsxs)("div",{className:"mr-2 flex flex-col",children:[(0,d.jsxs)("p",{className:"leading-none ".concat(h?"":"my-auto"),children:[null===b||void 0===b?void 0:b.name,":"," ",(0,u.hz)(null===x||void 0===x?void 0:x.permissionedDrive.permission,s.Ac).name]}),h&&(0,d.jsxs)("small",{className:"",children:[(0,a.t)("Via")," ",h]})]}),(0,d.jsx)(o.Z,{className:"my-auto ml-auto h-5 w-5"})]})},"".concat(null===x||void 0===x||null===(r=x.permissionedDrive)||void 0===r||null===(n=r.drive)||void 0===n?void 0:n.alias,"-").concat(null===x||void 0===x||null===(m=x.permissionedDrive.drive)||void 0===m?void 0:m.type))}},365:function(e,r,n){var t=n(184);r.Z=function(e){var r=e.initials,n=e.className;return(0,t.jsx)("div",{className:"flex h-full w-full bg-slate-200 text-4xl font-light text-white dark:bg-slate-700 dark:text-black sm:text-6xl ".concat(null!==n&&void 0!==n?n:""),children:(0,t.jsx)("span",{className:"m-auto uppercase",children:r})})}},8602:function(e,r,n){var t=n(184);r.Z=function(e){var r=e.className;return(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",className:r,children:(0,t.jsx)("path",{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"})})}},8769:function(e,r,n){var t=n(8602),a=n(184);r.Z=function(e){var r=e.totalPages,n=e.setPage,i=e.currentPage,s=e.className;if(!(1===i&&i>=r))return(0,a.jsxs)("div",{className:"flex text-slate-300 dark:text-slate-700 ".concat(null!==s&&void 0!==s?s:""),children:[(0,a.jsx)("div",{className:1!==i?"cursor-pointer text-slate-600 dark:text-slate-200":"pointer-events-none",onClick:function(){return n(i-1)},children:(0,a.jsx)(t.Z,{className:"h-5 w-5 rotate-180"})}),(0,a.jsx)("div",{className:i<r?"cursor-pointer text-slate-600 dark:text-slate-200":"pointer-events-none",onClick:function(){return n(i+1)},children:(0,a.jsx)(t.Z,{className:"h-5 w-5"})})]})}},1434:function(e,r,n){var t=n(2791),a=n(184),i=t.forwardRef((function(e,r){var n=e.title,t=e.actions,i=e.className,s=e.children,o=e.isOpaqueBg,l=void 0!==o&&o,c=e.isBorderLess,u=void 0!==c&&c;return(0,a.jsxs)("section",{ref:r,className:"my-5 rounded-md ".concat(l?u?"":"rounded-lg border-[1px] border-gray-200 border-opacity-80 px-5 dark:border-gray-700":"bg-slate-50 px-5 dark:bg-slate-800"," dark:text-slate-300 ").concat(null!==i&&void 0!==i?i:""),children:[n||t?(0,a.jsxs)("div",{className:"relative flex flex-row items-center border-b-[1px] border-gray-200 border-opacity-80 py-5 transition-all duration-300 dark:border-gray-700",children:[(0,a.jsx)("h3",{className:"text-2xl dark:text-white",children:n}),(0,a.jsx)("div",{className:"ml-auto",children:(0,a.jsx)("div",{className:"-m-2 flex flex-col flex-wrap justify-end sm:flex-row sm:items-center",children:t})})]}):null,(0,a.jsx)("div",{className:"py-5 ",children:s})]})}));r.Z=i},8867:function(e,r,n){var t=n(4165),a=n(5861),i=n(7408),s=n(7186),o=n(8609);r.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{active:{pageSize:10,pageNumber:1}},r=e.active,n=r.pageSize,l=r.pageNumber,c=(0,o.ZP)(),u=c.getSharedSecret,d=s.I.getInstance(u()),m=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){var r,n,a,i=arguments;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{pageSize:10,pageNumber:1},n=r.pageSize,a=r.pageNumber,e.next=3,d.getConnections({pageNumber:a,pageSize:n});case 3:return e.next=5,e.sent;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{fetchActive:(0,i.useQuery)(["activeConnections",n,l],(function(){return m({pageSize:n,pageNumber:l})}),{refetchOnWindowFocus:!1,keepPreviousData:!0,onError:function(e){return console.error(e)}})}}},5809:function(e,r,n){var t=n(4165),a=n(5861),i=n(7408),s=n(5274),o=n(8609);r.Z=function(e){var r=e.targetDrive,n=(0,o.ZP)().getSharedSecret,l=new s.AO({api:s.Ii.Owner,sharedSecret:n()}),c=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(r){var n;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.driveProvider.GetDrives({pageNumber:1,pageSize:100});case 2:return e.next=4,e.sent.results;case 4:return n=e.sent,e.abrupt("return",n.find((function(e){return e.targetDriveInfo.alias===r.alias&&e.targetDriveInfo.type===r.type})));case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["drive","".concat(r.alias,"_").concat(r.type)],(function(){return c(r)}),{refetchOnWindowFocus:!1})}}},6770:function(e,r,n){var t=n(4165),a=n(5861),i=n(7408),s=n(5274),o=n(8609);r.Z=function(){var e=(0,o.ZP)().getSharedSecret,r=new s.AO({api:s.Ii.Owner,sharedSecret:e()}),n=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.driveProvider.GetDrives({pageNumber:1,pageSize:100});case 2:return e.next=4,e.sent.results;case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["drives"],(function(){return n()}),{refetchOnWindowFocus:!1})}}},9779:function(e,r,n){var t=n(4165),a=n(5861),i=n(7408),s=n(5274),o=n(8609),l={alias:s.Ib.BlogMainContentDriveId.toString(),type:s.Hm.DriveType.toString()};r.Z=function(e,r){var n=(0,o.ZP)().getSharedSecret,c=(0,i.useQueryClient)(),u=new s.KU({api:s.Ii.Owner,sharedSecret:n()}),d=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(r,n){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u.mediaProvider.getDecryptedImageUrl(null!==n&&void 0!==n?n:l,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),m=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(r){var n,a,i,o,c,d,m,v;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.bytes,a=r.type,i=r.targetDrive,o=void 0===i?l:i,c=r.acl,d=void 0===c?{requiredSecurityGroup:s.hh.Anonymous}:c,m=r.fileId,v=void 0===m?void 0:m,e.next=3,u.mediaProvider.uploadImage(o,void 0,d,n,v,a);case 3:return e.abrupt("return",e.sent.fileId);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),v=function(){var e=(0,a.Z)((0,t.Z)().mark((function e(r){var n,a,i;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.targetDrive,a=void 0===n?l:n,i=r.fileId,e.next=3,u.mediaProvider.removeImage(i,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["image",e,r],(function(){return d(e,r)}),{refetchOnMount:!1,refetchOnWindowFocus:!1,staleTime:1/0,enabled:!!e}),save:(0,i.useMutation)(m,{onSuccess:function(e,r){var n;r.fileId?c.invalidateQueries(["image",r.fileId,null!==(n=r.targetDrive)&&void 0!==n?n:l]):c.removeQueries(["image"])}}),remove:(0,i.useMutation)(v)}}},2562:function(e,r,n){n.d(r,{Ac:function(){return a},WW:function(){return i},c$:function(){return s}});var t=n(4990),a=[{name:(0,t.t)("None"),value:0},{name:(0,t.t)("Reader"),value:1},{name:(0,t.t)("Editor"),value:3}],i=[{name:(0,t.t)("None"),value:0},{name:(0,t.t)("Read Connections"),value:10},{name:(0,t.t)("Read Circle Members"),value:50}],s=[{name:(0,t.t)("None"),value:0},{name:(0,t.t)("Read Connections"),value:10},{name:(0,t.t)("Manage Connection Requests"),value:30},{name:(0,t.t)("Read Circle Members"),value:50}]},120:function(e,r,n){n.r(r),n.d(r,{default:function(){return S}});var t=n(4165),a=n(5861),i=n(9439),s=n(2791),o=n(6871),l=n(4990),c=n(4075),u=n(9747),d=n(2042),m=n(2851),v=n(7272),f=n(4523),x=n(3433),h=n(4164),p=n(8867),g=n(3412),b=n(8769),j=n(8930),Z=n(184),y=function(e){var r,n,t=e.title,a=e.confirmText,o=e.isOpen,c=e.defaultMembers,u=e.confirmationStatus,d=e.onConfirm,f=e.onCancel,y=(0,g.Z)("modal-container"),N=(0,s.useState)(1),w=(0,i.Z)(N,2),k=w[0],C=w[1],I=(0,p.Z)({active:{pageSize:12,pageNumber:k}}).fetchActive,D=I.data,S=I.isLoading,O=(0,s.useState)([]),Y=(0,i.Z)(O,2),A=Y[0],P=Y[1],F=(0,s.useState)([]),G=(0,i.Z)(F,2),L=G[0],z=G[1];if(!o)return null;var M=(0,Z.jsx)(j.Z,{size:"4xlarge",onClose:f,title:t,children:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:"flex flex-row",children:[(0,Z.jsx)("h2",{className:"mr-auto",children:(0,l.t)("Your Connections:")}),(0,Z.jsx)(b.Z,{totalPages:null===D||void 0===D?void 0:D.totalPages,setPage:C,currentPage:k,className:"m-2"})]}),(0,Z.jsx)("div",{className:"-mx-1 flex flex-row",children:S?(0,Z.jsx)(Z.Fragment,{}):null!==D&&void 0!==D&&null!==(r=D.results)&&void 0!==r&&r.length?null===(n=D.results)||void 0===n?void 0:n.map((function(e){var r=c.some((function(r){return r===e.dotYouId}))&&!L.some((function(r){return r===e.dotYouId}))||A.some((function(r){return r===e.dotYouId}));return(0,Z.jsx)(v.Z,{dotYouId:e.dotYouId,className:"relative w-1/2 cursor-pointer p-1 sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/6",isChecked:r,onClick:function(){var r=c.some((function(r){return r===e.dotYouId})),n=L.some((function(r){return r===e.dotYouId})),t=A.some((function(r){return r===e.dotYouId}));!function(e,r){e?(c.some((function(e){return e===r}))||P([].concat((0,x.Z)(A),[r])),z(L.filter((function(e){return e!==r})))):(c.some((function(e){return e===r}))&&z([].concat((0,x.Z)(L),[r])),P(A.filter((function(e){return e!==r}))))}(!(r?!n:t),e.dotYouId)}},e.dotYouId)})):(0,Z.jsx)(Z.Fragment,{children:(0,l.t)("No connections found")})}),(0,Z.jsxs)("div",{className:"-m-2 flex flex-row-reverse py-3",children:[(0,Z.jsx)(m.Z,{className:"m-2",icon:"send",state:u,onClick:function(){d(A,L)},children:a||(0,l.t)("Update Circle")}),(0,Z.jsx)(m.Z,{className:"m-2",type:"secondary",onClick:f,children:(0,l.t)("Cancel")}),null!==A&&void 0!==A&&A.length||null!==L&&void 0!==L&&L.length?(0,Z.jsxs)("div",{className:"m-2 my-auto",children:[null!==A&&void 0!==A&&A.length?"".concat(A.length>=2?"".concat(A.length," ").concat((0,l.t)("people")):"".concat((0,l.t)("One person"))," ").concat((0,l.t)("will gain access")):"",null!==L&&void 0!==L&&L.length?"".concat(A.length>=2?"".concat(A.length," ").concat((0,l.t)("people")):"".concat((0,l.t)("One person"))," ").concat((0,l.t)("will loose access")):""]}):null]})]})});return(0,h.createPortal)(M,y)},N=n(9205),w=n(9080),k=n(7797),C=n(1869),I=n(1434),D=function(e){var r,n=e.circleId,t=e.dotYouId,a=e.className,i=(0,c.Z)({}).revokeGrants,s=i.mutate,o=i.status,u=i.error;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(d.Z,{error:u}),(0,Z.jsx)(v.Z,{className:"".concat(null!==a&&void 0!==a?a:""," relative"),dotYouId:t,href:null!==(r=t&&"/owner/connections/".concat(t))&&void 0!==r?r:void 0,children:(0,Z.jsx)("div",{className:"absolute top-2 right-2 z-10 aspect-square rounded-full",children:(0,Z.jsx)(m.Z,{type:"secondary",onClick:function(e){return e.preventDefault(),s({circleId:n,dotYouIds:[t]}),!1},confirmOptions:{title:(0,l.t)("Remove member"),body:"".concat((0,l.t)("Are you sure you want to remove")," ").concat(t," ").concat((0,l.t)("from this circle?")),buttonText:(0,l.t)("Remove")},state:o,icon:"times",className:"rounded-full",size:"square"})})})]})},S=function(){var e,r,n=(0,o.UO)().circleKey,v=decodeURIComponent(n),x=(0,c.Z)({circleId:v}),h=x.fetch,p=h.data,g=h.isLoading,b=x.fetchMembers,j=b.data,S=b.isLoading,O=x.provideGrants,Y=O.mutateAsync,A=O.status,P=O.error,F=x.revokeGrants,G=F.mutateAsync,L=F.status,z=F.error,M=x.enableCircle,R=M.mutate,T=M.status,q=M.error,U=x.disableCircle,V=U.mutate,W=U.status,B=U.error,E=x.removeCircle,Q=E.mutateAsync,_=E.status,K=E.error,H=(0,s.useState)(!1),$=(0,i.Z)(H,2),J=$[0],X=$[1],ee=(0,s.useState)(!1),re=(0,i.Z)(ee,2),ne=re[0],te=re[1];return g?(0,Z.jsx)(k.Z,{}):p?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(d.Z,{error:q}),(0,Z.jsx)(d.Z,{error:B}),(0,Z.jsx)(d.Z,{error:P}),(0,Z.jsx)(d.Z,{error:z}),(0,Z.jsx)(d.Z,{error:K}),(0,Z.jsx)(w.Z,{icon:N.Z,title:"".concat(p.name),actions:(0,Z.jsxs)(Z.Fragment,{children:[p.disabled?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(m.Z,{type:"remove",icon:"trash",className:"m-2",state:_,onClick:function(){Q({circleId:p.id})},confirmOptions:{title:"".concat((0,l.t)("Remove Circle")," ").concat(p.name),buttonText:(0,l.t)("Remove"),body:(0,l.t)("Are you sure you want to remove this circle, all members will lose their access provided by the permissions of this circle?")},children:(0,l.t)("Delete")}),(0,Z.jsx)(m.Z,{type:"primary",className:"m-2",onClick:function(){R({circleId:p.id})},state:T,children:(0,l.t)("Enable Circle")})]}):(0,Z.jsx)(m.Z,{type:"remove",className:"m-2",onClick:function(){V({circleId:p.id})},state:W,confirmOptions:{title:(0,l.t)("Disable Circle"),buttonText:(0,l.t)("Disable"),body:"".concat((0,l.t)("Are you sure you want to disable the circle")," ").concat(p.name)},children:(0,l.t)("Disable Circle")}),(0,Z.jsx)(m.Z,{type:"primary",className:"m-2",onClick:function(){X(!0)},children:(0,l.t)("Edit Members")}),(0,Z.jsx)(m.Z,{type:"primary",icon:"edit",className:"m-2",onClick:function(){te(!0)},children:(0,l.t)("Edit Circle")})]}),breadCrumbs:[{href:"/owner/circles",title:"My Circles"},{title:null!==(e=p.name)&&void 0!==e?e:""}]}),p.disabled&&(0,Z.jsx)(u.Z,{type:"critical",title:(0,l.t)("Circle is disabled"),className:"mb-5",children:(0,l.t)("This circle is disabled, all members no longer have the access provided by this cirlce")}),(0,Z.jsx)("section",{children:(0,Z.jsx)("div",{className:"mr-auto max-w-2xl",children:p.description})}),(0,Z.jsx)(I.Z,{isOpaqueBg:!0,isBorderLess:!0,title:(0,l.t)("Members"),actions:(0,Z.jsx)(m.Z,{type:"mute",className:"m-2",onClick:function(){X(!0)},icon:"edit"}),children:null!==j&&void 0!==j&&j.length&&!S?(0,Z.jsx)("div",{className:"-m-1 flex flex-row flex-wrap",children:j.map((function(e){return(0,Z.jsx)(D,{circleId:v,dotYouId:e,className:"w-1/2 p-1 sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/6"},e)}))}):(0,Z.jsxs)("div",{className:"flex flex-row",children:[(0,Z.jsxs)("p",{className:"my-auto",children:[(0,l.t)("Mmh, this looks like an emtpy circle... Time to add some connections?")," "]}),(0,Z.jsx)(m.Z,{onClick:function(e){return e.preventDefault(),X(!0),!1},type:"secondary",className:"ml-2",children:(0,l.t)("Add")})]})}),(0,Z.jsx)(I.Z,{title:(0,Z.jsxs)(Z.Fragment,{children:[(0,l.t)("Access on the following drives"),(0,Z.jsx)("small",{className:"block text-sm text-slate-500",children:(0,l.t)("all contact added will have this access")})]}),isOpaqueBg:!0,children:null!==(r=p.driveGrants)&&void 0!==r&&r.length?(0,Z.jsx)("div",{className:"-my-6",children:p.driveGrants.map((function(e){return(0,Z.jsx)(C.Z,{driveGrant:e,className:"my-6"},"".concat(e.permissionedDrive.drive.alias,"-").concat(e.permissionedDrive.drive.type))}))}):(0,Z.jsx)("div",{className:"flex flex-row",children:(0,Z.jsx)("p",{className:"my-auto",children:(0,l.t)("This circle doesn't have any access")})})}),(0,Z.jsx)(f.Z,{title:"".concat((0,l.t)("Edit"),": ").concat(p.name),isOpen:ne,confirmText:(0,l.t)("Update Circle"),defaultValue:p,onCancel:function(){te(!1)},onConfirm:function(){te(!1)}}),(0,Z.jsx)(y,{isOpen:J,title:"".concat((0,l.t)("Add Members to")," ").concat(p.name),defaultMembers:j,onCancel:function(){X(!1)},confirmationStatus:(0,m.s)(A,L),onConfirm:function(){var e=(0,a.Z)((0,t.Z)().mark((function e(r,n){return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y({circleId:v,dotYouIds:r});case 2:return e.next=4,G({circleId:v,dotYouIds:n});case 4:X(!1);case 5:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()})]}):(0,Z.jsx)(Z.Fragment,{children:"No matching circle found"})}}}]);
//# sourceMappingURL=120.1bcfa5e6.chunk.js.map