"use strict";(self.webpackChunkowner_app=self.webpackChunkowner_app||[]).push([[918],{6691:function(e,t,n){var r=n(4165),a=n(5861),i=n(9439),s=n(2791),o=n(4164),c=n(4990),l=n(9779),u=n(3412),d=n(2042),m=n(2851),f=n(184);t.Z=function(e){var t=e.title,n=e.confirmText,v=e.isOpen,h=e.acl,x=e.targetDrive,p=e.onConfirm,g=e.onCancel,b=(0,u.Z)("modal-container"),j=(0,l.Z)().save,w=j.mutate,Z=j.status,y=j.error,C=(0,s.useState)(),N=(0,i.Z)(C,2),k=N[0],I=N[1];if(!v)return null;var S=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Uint8Array,e.next=3,k.arrayBuffer();case 3:e.t1=e.sent,t=new e.t0(e.t1),w({acl:h,bytes:t,type:k.type,fileId:void 0,targetDrive:x},{onSuccess:p});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"relative z-50","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[(0,f.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),(0,f.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,f.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,f.jsxs)("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all dark:bg-black sm:my-8 sm:w-full sm:max-w-lg",children:[(0,f.jsx)(d.Z,{error:y}),(0,f.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 dark:bg-black sm:p-6 sm:pb-4",children:(0,f.jsx)("div",{className:"sm:flex sm:items-start",children:(0,f.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,f.jsx)("h3",{className:"mb-3 text-lg font-medium leading-6 text-gray-900 dark:text-slate-50",id:"modal-title",children:t}),(0,f.jsx)("input",{onChange:function(e){var t=e.target.files[0];t&&I(t)},type:"file",accept:"image/png, image/jpeg, image/tiff, image/webp, image/svg+xml",className:"w-full rounded border border-gray-300 bg-white py-1 px-3 text-base leading-8 text-gray-700 outline-none transition-colors duration-200 ease-in-out focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100"})]})})}),(0,f.jsxs)("div",{className:"-m-2 flex flex-row-reverse px-4 py-3",children:[(0,f.jsx)(m.Z,{className:"m-2",onClick:S,state:Z,children:null!==n&&void 0!==n?n:"Add"}),(0,f.jsx)(m.Z,{className:"m-2",type:"secondary",onClick:g,children:(0,c.t)("Cancel")})]})]})})})]})});return(0,o.createPortal)(D,b)}},3197:function(e,t,n){var r=n(4165),a=n(5861),i=n(9439),s=n(2791),o=n(4990),c=n(9779),l=n(1803),u=n(3352),d=n(3354),m=n(8231),f=n(6691),v=n(2042),h=n(184);t.Z=function(e){var t=e.targetDrive,n=e.acl,x=e.onChange,p=e.defaultValue,g=e.name,b=(0,c.Z)("string"===typeof p?p:void 0,t),j=b.fetch,w=j.data,Z=j.isLoading,y=b.remove,C=y.mutateAsync,N=y.error,k=(0,s.useState)(!1),I=(0,i.Z)(k,2),S=I[0],D=I[1],M=(0,s.useState)(!1),H=(0,i.Z)(M,2),P=H[0],F=H[1],T=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C({fileId:"string"===typeof p?p:void 0,targetDrive:t});case 2:x({target:{name:g,value:void 0}});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Z&&p?(0,h.jsx)("div",{className:"aspect-square max-w-[20rem] animate-pulse bg-slate-100 dark:bg-slate-700"}):(0,h.jsxs)(h.Fragment,{children:[w?(0,h.jsx)("div",{className:"flex",children:(0,h.jsxs)("div",{className:"relative mr-auto",children:[(0,h.jsx)("button",{className:"absolute top-2 right-2 rounded-full bg-white p-2",onClick:function(e){return e.preventDefault(),D(!0),!1},children:(0,h.jsx)(d.Z,{className:"h-4 w-4 text-black"})}),(0,h.jsx)("button",{className:"absolute bottom-2 right-2 rounded-full bg-red-200 p-2",onClick:function(){return F(!0),!1},children:(0,h.jsx)(m.Z,{className:"h-4 w-4 text-black"})}),(0,h.jsx)("img",{src:w,alt:w,className:"max-h-[20rem]",onClick:function(){D(!0)}})]})}):(0,h.jsxs)("div",{className:"relative flex aspect-square max-w-[20rem] cursor-pointer bg-slate-100 dark:bg-slate-700",onClick:function(e){e.preventDefault(),D(!0)},children:[(0,h.jsx)(u.Z,{className:"m-auto h-8 w-8"}),(0,h.jsx)("p",{className:"absolute inset-0 top-auto pb-5 text-center text-slate-400",children:(0,o.t)("No image selected")})]}),(0,h.jsx)(f.Z,{acl:n,isOpen:S,targetDrive:t,title:(0,o.t)("Insert image"),confirmText:(0,o.t)("Add"),onCancel:function(){return D(!1)},onConfirm:function(e){x({target:{name:g,value:e}}),D(!1)}}),(0,h.jsx)(v.Z,{error:N}),(0,h.jsx)(l.Z,{title:"Remove Current Image",confirmText:"Permanently remove",needConfirmation:P,onConfirm:T,onCancel:function(){F(!1)},children:(0,h.jsx)("p",{className:"text-sm text-gray-500",children:(0,o.t)("Are you sure you want to remove the current file? This action cannot be undone.")})})]})}},3225:function(e,t,n){var r=n(1413),a=n(184);t.Z=function(e){var t;return(0,a.jsx)("select",(0,r.Z)((0,r.Z)({},e),{},{className:"w-full rounded ".concat(e.className&&-1!==(null===(t=e.className)||void 0===t?void 0:t.indexOf("border"))?"":"border border-gray-300 focus:border-indigo-500 dark:border-gray-700"," bg-white py-1 px-3 text-base leading-8 text-gray-700 outline-none transition-colors duration-200 ease-in-out focus:ring-2 focus:ring-indigo-200 dark:bg-gray-800 dark:text-gray-100 ").concat(e.className),children:e.children}))}},2465:function(e,t,n){var r=n(1413),a=n(184);t.Z=function(e){return(0,a.jsx)("textarea",(0,r.Z)((0,r.Z)({},e),{},{className:"w-full rounded border border-gray-300 bg-white py-1 px-3 text-base leading-8 text-gray-700 outline-none transition-colors duration-200 ease-in-out focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 ".concat(e.className)}))}},6009:function(e,t,n){var r=n(9439),a=n(2791),i=n(6430),s=n(9779),o=n(184);t.Z=function(e){var t=e.targetDrive,n=e.fileId,c=e.className,l=e.alt,u=e.title,d=(0,a.useState)(!1),m=(0,r.Z)(d,2),f=m[0],v=m[1],h=(0,a.useRef)(null),x=(0,s.Z)(f?n:void 0,t).fetch.data;return(0,i.s)(h,(function(){v(!0)})),(0,o.jsx)("img",{src:x,alt:f&&x?l:" ",className:"".concat(c," ").concat((!f||!x)&&"h-full w-full animate-pulse bg-slate-100"),title:u,ref:h})}},3756:function(e,t,n){var r=n(9439),a=n(2791),i=n(4990),s=n(9747),o=n(184);t.Z=function(e){var t=e.className,n=e.state,c=e.error,l=(0,a.useState)(null),u=(0,r.Z)(l,2),d=u[0],m=u[1],f=(0,a.useState)(new Date),v=(0,r.Z)(f,2),h=v[0],x=v[1];if((0,a.useEffect)((function(){"success"===n&&m(new Date)}),[n]),(0,a.useEffect)((function(){var e=setTimeout((function(){x(new Date)}),3e4);return function(){clearTimeout(e)}}),[h]),"loading"===n)return(0,o.jsx)("p",{className:"".concat(t," text-sm"),children:"Saving..."});if("error"===n)return(0,o.jsx)(s.Z,{type:"critical",className:t,children:c instanceof Error?c.message:(0,i.t)("Something went wrong")});if(!d)return null;var p=h.getTime()-d.getTime(),g=d?p<=6e4?"a few seconds ago":p<=6e5?"a few minutes ago":d.toLocaleString():"";return g?(0,o.jsxs)("p",{className:"".concat(t," text-sm"),children:["Last saved ",g]}):null}},9080:function(e,t,n){var r=n(6907),a=n(3504),i=n(3756),s=n(184);t.Z=function(e){var t=e.title,n=e.actions,o=e.saveStatus,c=e.breadCrumbs,l=e.icon;return(0,s.jsx)("section",{className:"-mx-5 -mt-4 mb-10 border-b-2 border-gray-100 bg-slate-50 py-4 pr-5 pl-10 dark:border-gray-700 dark:bg-slate-800 sm:-mx-10 sm:-mt-8 sm:py-8 sm:px-10",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row",children:[(0,s.jsxs)("div",{className:"flex-col",children:[c&&(0,s.jsx)("ul",{className:"mb-2 hidden flex-row sm:flex",children:c.map((function(e,t){return(0,s.jsx)("li",{className:"mr-2",children:e.href?(0,s.jsxs)(a.rU,{to:e.href,className:"",children:[e.title,(0,s.jsx)("span",{className:"ml-2",children:">"})]}):(0,s.jsx)("span",{className:"text-slate-500",children:e.title})},t)}))}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h1",{className:"mb-5 flex flex-row text-4xl dark:text-white",children:[l&&l({className:"h-8 w-8 my-auto mr-4"})," ",t]}),(0,s.jsx)(r.ql,{children:(0,s.jsxs)("title",{children:["object"!==typeof t&&"".concat(t)||window.location.pathname.split("/").pop()," ","| Owner console"]})})]})]}),(0,s.jsxs)("div",{className:"ml-auto",children:[(0,s.jsx)("div",{className:"-m-2 flex flex-col flex-wrap justify-end sm:flex-row sm:items-center",children:n}),o&&(0,s.jsx)(i.Z,{className:"mt-1",state:o})]})]})})}},6430:function(e,t,n){n.d(t,{s:function(){return l}});var r,a=n(2791),i=new WeakMap,s=new WeakMap,o=function(e){e.forEach((function(e){if(i.has(e.target)){var t=i.get(e.target),n=s.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(n&&(r.unobserve(e.target),i.delete(e.target)),t())}}))},c=function(){return void 0===r&&(r=new IntersectionObserver(o,{rootMargin:"100px",threshold:.15})),r},l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,a.useEffect)((function(){var r=null===e||void 0===e?void 0:e.current,a=c();if(r)return i.set(r,t),s.set(r,!n),a.observe(r),function(){i.delete(r),a.unobserve(r)}}),[e])}},9779:function(e,t,n){var r=n(4165),a=n(5861),i=n(7408),s=n(9631),o=n(8609),c={alias:s.Ib.BlogMainContentDriveId.toString(),type:s.Hm.DriveType.toString()};t.Z=function(e,t){var n=(0,o.ZP)().getSharedSecret,l=(0,i.useQueryClient)(),u=new s.KU({api:s.Ii.Owner,sharedSecret:n()}),d=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,u.mediaProvider.getDecryptedImageUrl(null!==n&&void 0!==n?n:c,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,i,o,l,d,m,f;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.bytes,a=t.type,i=t.targetDrive,o=void 0===i?c:i,l=t.acl,d=void 0===l?{requiredSecurityGroup:s.hh.Anonymous}:l,m=t.fileId,f=void 0===m?void 0:m,e.next=3,u.mediaProvider.uploadImage(o,void 0,d,n,f,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.targetDrive,a=void 0===n?c:n,i=t.fileId,e.next=3,u.mediaProvider.removeImage(i,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["image",e,t],(function(){return d(e,t)}),{refetchOnMount:!1,refetchOnWindowFocus:!1,staleTime:1/0,enabled:!!e}),save:(0,i.useMutation)(m,{onSuccess:function(e,t){var n;t.fileId?l.invalidateQueries(["image",t.fileId,null!==(n=t.targetDrive)&&void 0!==n?n:c]):l.removeQueries(["image"])}}),remove:(0,i.useMutation)(f)}}},8833:function(e,t,n){var r=n(4165),a=n(5861),i=n(7408),s=n(9631),o=n(8609),c=n(1695);t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.channelId,n=e.channelSlug,l=(0,o.ZP)(),u=l.getSharedSecret,d=new s.KU({api:s.Ii.Owner,sharedSecret:u()}),m=(0,i.useQueryClient)(),f=(0,c.Z)().publish.mutate,v=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,d.blogDefinitionProvider.getChannelDefinition(t);case 3:case 7:return e.abrupt("return",e.sent);case 4:if(!n){e.next=8;break}return e.next=7,d.blogDefinitionProvider.getChannelDefinitionBySlug(n);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.blogDefinitionProvider.saveChannelDefinition(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.blogDefinitionProvider.removeChannelDefinition(t.channelId);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["channel",null!==t&&void 0!==t?t:n],(function(){return v(t,n)}),{refetchOnWindowFocus:!1}),save:(0,i.useMutation)(h,{onSuccess:function(e,t){t.channelId?m.removeQueries(["channel",t.channelId]):m.removeQueries(["channel"]),m.removeQueries(["channels"]),f()}}),remove:(0,i.useMutation)(x,{onMutate:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.cancelQueries(["channels"]);case 2:return n=m.getQueryData(["channels"]),a=null===n||void 0===n?void 0:n.filter((function(e){return e.channelId!==t.channelId})),m.setQueryData(["channels"],a),e.abrupt("return",{previousChannels:n,toRemoveChannel:t});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onError:function(e,t,n){console.error(e),m.setQueryData(["channels"],n.previousChannels)},onSettled:function(){m.invalidateQueries(["channels"])}})}}},7944:function(e,t,n){var r=n(4165),a=n(5861),i=n(7408),s=n(9631),o=n(2255),c=n(8609),l=n(1695);t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.channelSlug,n=e.blogSlug,u=(0,c.ZP)(),d=u.getSharedSecret,m=new s.KU({api:s.Ii.Owner,sharedSecret:d()}),f=o.Z.getInstance(d()),v=(0,i.useQueryClient)(),h=(0,l.Z)().publish.mutate,x=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,i,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.blogSlug,a=t.channelSlug,n){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,m.blogDefinitionProvider.getChannelDefinitionBySlug(a);case 5:return i=e.sent,e.next=8,f.getPost(i.channelId,s.j4.toGuidId(n));case 8:if(!(o=e.sent)){e.next=11;break}return e.abrupt("return",o);case 11:return e.abrupt("return");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.blogFile,a=t.channelId,e.next=3,f.savePost(n,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fileId,a=t.channelId,t.slug,e.next=3,f.removePost(n,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{fetch:(0,i.useQuery)(["blog",t,n],(function(){return x({blogSlug:n,channelSlug:t})}),{refetchOnWindowFocus:!1}),save:(0,i.useMutation)(p,{onSuccess:function(e,t){t.blogFile.content.slug?v.invalidateQueries(["blog",t.blogFile.content.slug]):v.invalidateQueries(["blog"]),v.removeQueries(["blogs"]),h()}}),remove:(0,i.useMutation)(g,{onSuccess:function(e,t){t&&t.slug?v.invalidateQueries(["blog",t.slug]):v.invalidateQueries(["blog"]),v.removeQueries(["blogs"])}})}}},2255:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(4165),a=n(3433),i=n(5861),s=n(5671),o=n(3144),c=n(9340),l=n(1129),u=n(9631),d=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,s.Z)(this,n),t.call(this,{api:e.api,sharedSecret:e.sharedSecret,driveProvider:e.driveProvider,blogDefinitionProvider:e.blogDefinitionProvider})}return(0,o.Z)(n,[{key:"savePost",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,s,o,c,l,d,m,f,v,h,x,p,g;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.content.id){e.next=4;break}t.content.id=t.content.slug?u.j4.toGuidId(t.content.slug):u.j4.getNewId(),e.next=26;break;case 4:if(t.fileId){e.next=26;break}return e.next=7,this.getPost(n,t.content.id);case 7:if(e.t2=l=e.sent,e.t1=null===e.t2,e.t1){e.next=11;break}e.t1=void 0===l;case 11:if(!e.t1){e.next=15;break}e.t3=void 0,e.next=16;break;case 15:e.t3=l.fileId;case 16:if(e.t4=c=e.t3,e.t0=null!==e.t4,!e.t0){e.next=20;break}e.t0=void 0!==c;case 20:if(!e.t0){e.next=24;break}e.t5=c,e.next=25;break;case 24:e.t5=void 0;case 25:t.fileId=e.t5;case 26:return d=!((null===(i=t.acl)||void 0===i?void 0:i.requiredSecurityGroup)===u.hh.Anonymous||(null===(s=t.acl)||void 0===s?void 0:s.requiredSecurityGroup)===u.hh.Authenticated),m={transferIv:this._driveProvider.Random16(),storageOptions:{overwriteFileId:null!==(o=null===t||void 0===t?void 0:t.fileId)&&void 0!==o?o:"",drive:this._blogDefinitionProvider.getTargetDrive(n)},transitOptions:null},f=u.j4.JsonStringify64(t.content),v=u.j4.stringToUint8Array(f),h=t.content.slug?u.j4.toGuidId(t.content.slug):t.content.id,x=v.length<3e3,p={contentType:"application/json",appData:{tags:[(0,u.iY)("type"in t.content?t.content.type:"Article").toString(),t.content.id].concat((0,a.Z)(h&&h!==t.content.id?[h]:[])),uniqueId:h,contentIsComplete:x,fileType:u.Hm.PostFileType,jsonContent:x?f:null},payloadIsEncrypted:d,accessControlList:t.acl},e.next=35,this._driveProvider.Upload(m,p,v,void 0,d);case 35:return g=e.sent,e.abrupt("return",g.file.fileId);case 37:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"removePost",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this._blogDefinitionProvider.getTargetDrive(n),this._driveProvider.DeleteFile(a,t);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(e){if(!e)throw new Error("Shared Secret not set for OwnerProvider");if(!n.instance){var t=new u.l$({api:u.Ii.Owner,sharedSecret:e}),r=new u.ax({api:u.Ii.Owner,sharedSecret:e,driveProvider:t});n.instance=new n({api:u.Ii.Owner,sharedSecret:e,driveProvider:t,blogDefinitionProvider:r})}return n.instance}}]),n}(u.j_);d.instance=void 0},5918:function(e,t,n){n.r(t),n.d(t,{default:function(){return ue}});var r=n(1413),a=n(9439),i=n(9631),s=n(6871),o=n(3990),c=n(4990),l=n(7944),u=n(8833),d=n(2042),m=n(2878),f=n(2791),v=n(3197),h=n(6916),x=n(3147),p=n(3225),g=n(2465),b=n(4205),j=n(366),w=n(2100),Z=n(6283),y=n(5473),C=n(4925),N=n(184),k=["className","active","reversed"],I=["className"],S=function(e){var t=e.className,n=e.active,a=e.reversed,i=(0,C.Z)(e,k);return(0,N.jsx)("button",(0,r.Z)((0,r.Z)({},i),{},{className:"".concat(null!==t&&void 0!==t?t:""," cursor-pointer px-1 py-2 ").concat(a?n?"text-white":"text-slate-400":n?"text-black dark:text-white":"text-slate-200 dark:text-slate-700")}))},D=function(e){var t=e.className,n=(0,C.Z)(e,I);return(0,N.jsx)("div",(0,r.Z)((0,r.Z)({},n),{},{className:"".concat(null!==t&&void 0!==t?t:""," relative -mx-1 mb-3 flex flex-row flex-wrap border-b border-slate-200 border-opacity-50")}))},M=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M321.1 242.4C340.1 220.1 352 191.6 352 160c0-70.59-57.42-128-128-128L32 32.01c-17.67 0-32 14.31-32 32s14.33 32 32 32h16v320H32c-17.67 0-32 14.31-32 32s14.33 32 32 32h224c70.58 0 128-57.41 128-128C384 305.3 358.6 264.8 321.1 242.4zM112 96.01H224c35.3 0 64 28.72 64 64s-28.7 64-64 64H112V96.01zM256 416H112v-128H256c35.3 0 64 28.71 64 63.1S291.3 416 256 416z"})})},H=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M384 64.01c0 17.69-14.31 32-32 32h-58.67l-133.3 320H224c17.69 0 32 14.31 32 32s-14.31 32-32 32H32c-17.69 0-32-14.31-32-32s14.31-32 32-32h58.67l133.3-320H160c-17.69 0-32-14.31-32-32s14.31-32 32-32h192C369.7 32.01 384 46.33 384 64.01z"})})},P=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M416 448H32c-17.69 0-32 14.31-32 32s14.31 32 32 32h384c17.69 0 32-14.31 32-32S433.7 448 416 448zM48 64.01H64v160c0 88.22 71.78 159.1 160 159.1s160-71.78 160-159.1v-160h16c17.69 0 32-14.32 32-32s-14.31-31.1-32-31.1l-96-.0049c-17.69 0-32 14.32-32 32s14.31 32 32 32H320v160c0 52.94-43.06 95.1-96 95.1S128 276.1 128 224v-160h16c17.69 0 32-14.31 32-32s-14.31-32-32-32l-96 .0049c-17.69 0-32 14.31-32 31.1S30.31 64.01 48 64.01z"})})},F=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M96 224C84.72 224 74.05 226.3 64 229.9V224c0-35.3 28.7-64 64-64c17.67 0 32-14.33 32-32S145.7 96 128 96C57.42 96 0 153.4 0 224v96c0 53.02 42.98 96 96 96s96-42.98 96-96S149 224 96 224zM352 224c-11.28 0-21.95 2.305-32 5.879V224c0-35.3 28.7-64 64-64c17.67 0 32-14.33 32-32s-14.33-32-32-32c-70.58 0-128 57.42-128 128v96c0 53.02 42.98 96 96 96s96-42.98 96-96S405 224 352 224z"})})},T=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M414.8 40.79L286.8 488.8C281.9 505.8 264.2 515.6 247.2 510.8C230.2 505.9 220.4 488.2 225.2 471.2L353.2 23.21C358.1 6.216 375.8-3.624 392.8 1.232C409.8 6.087 419.6 23.8 414.8 40.79H414.8zM518.6 121.4L630.6 233.4C643.1 245.9 643.1 266.1 630.6 278.6L518.6 390.6C506.1 403.1 485.9 403.1 473.4 390.6C460.9 378.1 460.9 357.9 473.4 345.4L562.7 256L473.4 166.6C460.9 154.1 460.9 133.9 473.4 121.4C485.9 108.9 506.1 108.9 518.6 121.4V121.4zM166.6 166.6L77.25 256L166.6 345.4C179.1 357.9 179.1 378.1 166.6 390.6C154.1 403.1 133.9 403.1 121.4 390.6L9.372 278.6C-3.124 266.1-3.124 245.9 9.372 233.4L121.4 121.4C133.9 108.9 154.1 108.9 166.6 121.4C179.1 133.9 179.1 154.1 166.6 166.6V166.6z"})})},L=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M448 448c0 17.69-14.33 32-32 32h-96c-17.67 0-32-14.31-32-32s14.33-32 32-32h16v-144h-224v144H128c17.67 0 32 14.31 32 32s-14.33 32-32 32H32c-17.67 0-32-14.31-32-32s14.33-32 32-32h16v-320H32c-17.67 0-32-14.31-32-32s14.33-32 32-32h96c17.67 0 32 14.31 32 32s-14.33 32-32 32H112v112h224v-112H320c-17.67 0-32-14.31-32-32s14.33-32 32-32h96c17.67 0 32 14.31 32 32s-14.33 32-32 32h-16v320H416C433.7 416 448 430.3 448 448z"})})},V=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M55.1 56.04C55.1 42.78 66.74 32.04 79.1 32.04H111.1C125.3 32.04 135.1 42.78 135.1 56.04V176H151.1C165.3 176 175.1 186.8 175.1 200C175.1 213.3 165.3 224 151.1 224H71.1C58.74 224 47.1 213.3 47.1 200C47.1 186.8 58.74 176 71.1 176H87.1V80.04H79.1C66.74 80.04 55.1 69.29 55.1 56.04V56.04zM118.7 341.2C112.1 333.8 100.4 334.3 94.65 342.4L83.53 357.9C75.83 368.7 60.84 371.2 50.05 363.5C39.26 355.8 36.77 340.8 44.47 330.1L55.59 314.5C79.33 281.2 127.9 278.8 154.8 309.6C176.1 333.1 175.6 370.5 153.7 394.3L118.8 432H152C165.3 432 176 442.7 176 456C176 469.3 165.3 480 152 480H64C54.47 480 45.84 474.4 42.02 465.6C38.19 456.9 39.9 446.7 46.36 439.7L118.4 361.7C123.7 355.9 123.8 347.1 118.7 341.2L118.7 341.2zM512 64C529.7 64 544 78.33 544 96C544 113.7 529.7 128 512 128H256C238.3 128 224 113.7 224 96C224 78.33 238.3 64 256 64H512zM512 224C529.7 224 544 238.3 544 256C544 273.7 529.7 288 512 288H256C238.3 288 224 273.7 224 256C224 238.3 238.3 224 256 224H512zM512 384C529.7 384 544 398.3 544 416C544 433.7 529.7 448 512 448H256C238.3 448 224 433.7 224 416C224 398.3 238.3 384 256 384H512z"})})},z=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M16 96C16 69.49 37.49 48 64 48C90.51 48 112 69.49 112 96C112 122.5 90.51 144 64 144C37.49 144 16 122.5 16 96zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 416C16 389.5 37.49 368 64 368C90.51 368 112 389.5 112 416C112 442.5 90.51 464 64 464C37.49 464 16 442.5 16 416zM112 256C112 282.5 90.51 304 64 304C37.49 304 16 282.5 16 256C16 229.5 37.49 208 64 208C90.51 208 112 229.5 112 256z"})})},O=n(6691),_=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M447.1 32h-384C28.64 32-.0091 60.65-.0091 96v320c0 35.35 28.65 64 63.1 64h384c35.35 0 64-28.65 64-64V96C511.1 60.65 483.3 32 447.1 32zM111.1 96c26.51 0 48 21.49 48 48S138.5 192 111.1 192s-48-21.49-48-48S85.48 96 111.1 96zM446.1 407.6C443.3 412.8 437.9 416 432 416H82.01c-6.021 0-11.53-3.379-14.26-8.75c-2.73-5.367-2.215-11.81 1.334-16.68l70-96C142.1 290.4 146.9 288 152 288s9.916 2.441 12.93 6.574l32.46 44.51l93.3-139.1C293.7 194.7 298.7 192 304 192s10.35 2.672 13.31 7.125l128 192C448.6 396 448.9 402.3 446.1 407.6z"})})},A=function(e){var t=e.targetDrive,n=(0,f.useState)(!1),r=(0,a.Z)(n,2),s=r[0],o=r[1],l=(0,w._7)();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(S,{onClick:function(e){e.preventDefault(),o(!0)},children:(0,N.jsx)(_,{className:"h-5 w-5"})}),(0,N.jsx)(O.Z,{isOpen:s,onCancel:function(){o(!1)},onConfirm:function(e){!function(e,t){var n={text:""},r=[{type:"image",imageFileId:t,children:[n]},{type:"paragraph",children:[n]}];Z.YR.insertNodes(e,r)}(l,e),o(!1)},title:(0,c.t)("Insert image"),confirmText:(0,c.t)("Add"),acl:{requiredSecurityGroup:i.hh.Anonymous},targetDrive:t})]})},Q=n(6009),q=function(e){var t=e.className;return(0,N.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",className:t,children:(0,N.jsx)("path",{d:"M320 0c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L448 109.3V192c0 17.7 14.3 32 32 32s32-14.3 32-32V32c0-17.7-14.3-32-32-32H320zM80 32C35.8 32 0 67.8 0 112V432c0 44.2 35.8 80 80 80H400c44.2 0 80-35.8 80-80V320c0-17.7-14.3-32-32-32s-32 14.3-32 32V432c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16H192c17.7 0 32-14.3 32-32s-14.3-32-32-32H80z"})})},E=n(4164),U=n(3412),B=n(2851),R=n(8930),G={linkText:"",uri:""},Y=function(e){var t=e.title,n=e.confirmText,i=e.isOpen,s=e.onConfirm,o=e.onCancel,l=e.buttonProps,u=(0,U.Z)("modal-container"),d=(0,f.useState)(null!==l&&void 0!==l?l:G),m=(0,a.Z)(d,2),v=m[0],p=m[1];if(!i)return null;var g=(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(R.Z,{title:t,onClose:o,children:(0,N.jsxs)("form",{onSubmit:function(e){return e.preventDefault(),s((0,r.Z)({},v)),p(G),!1},children:[(0,N.jsxs)("div",{className:"mb-5",children:[(0,N.jsx)(x.Z,{htmlFor:"linkText",children:(0,c.t)("Text")}),(0,N.jsx)(h.Z,{id:"linkText",name:"linkText",defaultValue:v.linkText,onChange:function(e){p((0,r.Z)((0,r.Z)({},v),{},{linkText:e.target.value}))},required:!0})]}),(0,N.jsxs)("div",{className:"mb-5",children:[(0,N.jsx)(x.Z,{htmlFor:"url",children:(0,c.t)("Url")}),(0,N.jsx)(h.Z,{id:"uri",name:"uri",defaultValue:v.uri,onChange:function(e){p((0,r.Z)((0,r.Z)({},v),{},{uri:e.target.value}))},required:!0})]}),(0,N.jsxs)("div",{className:"-m-2 flex flex-row-reverse px-4 py-3",children:[(0,N.jsx)(B.Z,{className:"m-2",state:"idle",children:null!==n&&void 0!==n?n:"Save"}),(0,N.jsx)(B.Z,{className:"m-2",type:"secondary",onClick:o,children:(0,c.t)("Cancel")})]})]})})});return(0,E.createPortal)(g,u)},W=function(){var e=(0,f.useState)(!1),t=(0,a.Z)(e,2),n=t[0],i=t[1],s=(0,w._7)();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(S,{onClick:function(e){e.preventDefault(),i(!0)},children:(0,N.jsx)(q,{className:"h-5 w-5"})}),(0,N.jsx)(Y,{isOpen:n,onCancel:function(){i(!1)},onConfirm:function(e){!function(e,t){var n=(0,r.Z)((0,r.Z)({type:"link-button"},t),{},{children:[{text:""}]});Z.YR.insertNodes(e,n)}(s,e),i(!1)},title:(0,c.t)("Include link button"),confirmText:(0,c.t)("Save")})]})},K={"mod+b":"bold","mod+i":"italic","mod+u":"underline","mod+`":"code"},J=["numbered-list","bulleted-list"],X=function(e,t){ee(e,t)?Z.ML.removeMark(e,t):Z.ML.addMark(e,t,!0)},$=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"type",r=e.selection;if(!r)return!1;var i=Array.from(Z.ML.nodes(e,{at:Z.ML.unhangRange(e,r),match:function(e){return!Z.ML.isEditor(e)&&Z.W_.isElement(e)&&e[n]===t}})),s=(0,a.Z)(i,1),o=s[0];return!!o},ee=function(e,t){var n=Z.ML.marks(e);return!!n&&!0===n[t]},te=function(e){var t=e.attributes,n=e.children,a=e.element,i=e.mediaDrive,s={};switch(a.type){case"block-quote":return(0,N.jsx)("blockquote",(0,r.Z)((0,r.Z)({style:s},t),{},{className:"border-l-4 pl-2",children:n}));case"bulleted-list":return(0,N.jsx)("ul",(0,r.Z)((0,r.Z)({style:s},t),{},{className:"list-disc pl-5",children:n}));case"heading-one":return(0,N.jsx)("h1",(0,r.Z)((0,r.Z)({style:s},t),{},{className:"text-2xl",children:n}));case"heading-two":return(0,N.jsx)("h2",(0,r.Z)((0,r.Z)({style:s},t),{},{className:"text-xl",children:n}));case"list-item":return(0,N.jsx)("li",(0,r.Z)((0,r.Z)({style:s},t),{},{children:n}));case"numbered-list":return(0,N.jsx)("ol",(0,r.Z)((0,r.Z)({style:s},t),{},{className:"list-decimal pl-5",children:n}));case"image":var c,l=(0,w._7)(),u=w.F3.findPath(l,a),d=(0,w.vt)(),m=(0,w.UE)();return(0,N.jsx)("div",(0,r.Z)((0,r.Z)({},t),{},{className:"".concat(null!==(c=t.className)&&void 0!==c?c:""," p-2"),children:(0,N.jsx)("div",{contentEditable:!1,children:(0,N.jsx)("div",{className:"my-5 flex flex-row",children:(0,N.jsxs)("div",{className:"relative mr-auto",children:[(0,N.jsx)("div",{className:"absolute right-1 top-1",children:(0,N.jsx)(B.Z,{onClick:function(){Z.YR.removeNodes(l,{at:u})},type:"remove",icon:"trash",size:"square"})}),(0,N.jsx)(Q.Z,{targetDrive:i,fileId:a.imageFileId,className:"max-w-md ".concat(d&&m?"outline outline-4 outline-offset-2 outline-indigo-500":"")})]})})})}));case"link-button":var f=(0,w._7)(),v=w.F3.findPath(f,a);return(0,N.jsx)("div",(0,r.Z)((0,r.Z)({},t),{},{children:(0,N.jsx)("div",{contentEditable:!1,children:(0,N.jsxs)("div",{className:"my-5 flex flex-row",children:[(0,N.jsxs)("a",{className:"pointer-events-none rounded-md rounded-r-none bg-slate-500 px-3 py-2 text-left text-white",title:a.uri,children:[a.linkText,(0,N.jsx)("small",{className:"block text-sm opacity-60",children:(0,o.iL)(a.uri,60)})]}),(0,N.jsx)(B.Z,{onClick:function(){return Z.YR.removeNodes(f,{at:v})},type:"remove",icon:"trash",size:"square",className:"rounded-l-none rounded-r-md"})]})})}));default:return(0,N.jsx)("p",(0,r.Z)((0,r.Z)({style:s},t),{},{children:n}))}},ne=function(e){var t=e.attributes,n=e.children,a=e.leaf;return a.bold&&(n=(0,N.jsx)("strong",{children:n})),a.code&&(n=(0,N.jsx)("code",{children:n})),a.italic&&(n=(0,N.jsx)("em",{children:n})),a.underline&&(n=(0,N.jsx)("u",{children:n})),(0,N.jsx)("span",(0,r.Z)((0,r.Z)({},t),{},{children:n}))},re=function(e){var t=e.format,n=e.icon,r=(0,w.ui)();return(0,N.jsx)(S,{active:$(r,t,"type"),onMouseDown:function(e){e.preventDefault(),function(e,t){var n=$(e,t,"type"),r=J.includes(t);Z.YR.unwrapNodes(e,{match:function(e){return!Z.ML.isEditor(e)&&Z.W_.isElement(e)&&J.includes(e.type)},split:!0});var a={type:n?"paragraph":r?"list-item":t};if(Z.YR.setNodes(e,a),!n&&r){var i={type:t,children:[]};Z.YR.wrapNodes(e,i)}}(r,t)},children:n&&(0,N.jsx)(n,{className:"h-5 w-5"})})},ae=function(e){var t=e.format,n=e.icon,r=(0,w.ui)();return(0,N.jsx)(S,{active:ee(r,t),onMouseDown:function(e){e.preventDefault(),X(r,t)},children:n&&(0,N.jsx)(n,{className:"h-5 w-5"})})},ie=function(e){var t=e.defaultValue,n=e.placeholder,a=e.mediaDrive,i=e.onChange,s=(0,f.useCallback)((function(e){return(0,N.jsx)(te,(0,r.Z)((0,r.Z)({},e),{},{mediaDrive:a}))}),[]),o=(0,f.useCallback)((function(e){return(0,N.jsx)(ne,(0,r.Z)({},e))}),[]),c=(0,f.useMemo)((function(){return(0,y.VC)((0,w.BU)((0,Z.Jh)()))}),[]),l=(0,f.useMemo)((function(){return(0,m.Z)(i,1500)}),[i]);return(0,N.jsx)("section",{className:"min-h-[30rem] w-[100%] overflow-hidden",children:(0,N.jsxs)(w.mH,{editor:c,value:t,onChange:l,children:[(0,N.jsxs)(D,{children:[(0,N.jsx)(ae,{format:"bold",icon:M}),(0,N.jsx)(ae,{format:"italic",icon:H}),(0,N.jsx)(ae,{format:"underline",icon:P}),(0,N.jsx)(ae,{format:"code",icon:T}),(0,N.jsx)(re,{format:"heading-one",icon:L}),(0,N.jsx)(re,{format:"heading-two",icon:L}),(0,N.jsx)(re,{format:"block-quote",icon:F}),(0,N.jsx)(re,{format:"numbered-list",icon:V}),(0,N.jsx)(re,{format:"bulleted-list",icon:z}),(0,N.jsx)(A,{targetDrive:a}),(0,N.jsx)(W,{})]}),(0,N.jsx)(w.CX,{renderElement:s,renderLeaf:o,placeholder:n,spellCheck:!0,autoFocus:!0,onKeyDown:function(e){for(var t in K){if((0,j.ZP)(t,e))e.preventDefault(),X(c,K[t])}}})]})})},se=function(e){var t=e.post,n=e.mediaDrive,r=e.onChange,a=(0,f.useMemo)((function(){return(0,m.Z)(r,500)}),[r]),s=(0,N.jsx)(N.Fragment,{});if("Article"===t.type){var o,l=t,u=Array.isArray(null===l||void 0===l?void 0:l.body)?null===l||void 0===l?void 0:l.body:[{type:"paragraph",children:[{text:null!==(o=null===l||void 0===l?void 0:l.body)&&void 0!==o?o:""}]}];s=(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"mb-5",children:[(0,N.jsx)(x.Z,{className:"mb-2 block",htmlFor:"post_abstract",children:(0,c.t)("Abstract")}),(0,N.jsx)(g.Z,{id:"post_abstract",name:"abstract",defaultValue:l.abstract,onChange:a})]}),(0,N.jsx)(b.S,{children:(0,N.jsx)(ie,{defaultValue:u,placeholder:(0,c.t)("Start writing..."),mediaDrive:n,onChange:function(e){r({target:{name:"body",value:e}})}})})]})}else if("Video"===t.type){var d=t;s=(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{className:"mb-5",children:[(0,N.jsx)(x.Z,{className:"mb-2 block",htmlFor:"post_videoId",children:(0,c.t)("Video File Id")}),(0,N.jsx)(h.Z,{id:"post_videoId",name:"videoFileId",defaultValue:d.videoFileId,onChange:a})]})})}return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"mb-5",children:[(0,N.jsx)(x.Z,{className:"mb-2 block",htmlFor:"post_type",children:(0,c.t)("Type")}),(0,N.jsxs)(p.Z,{id:"post_type",name:"type",defaultValue:t.type,onChange:a,children:[(0,N.jsx)("option",{value:"Article",children:"Article"}),(0,N.jsx)("option",{value:"Image",children:"Image"}),(0,N.jsx)("option",{value:"Video",children:"Video"}),(0,N.jsx)("option",{value:"Tweet",children:"Tweet"})]})]}),(0,N.jsxs)("div",{className:"mb-5",children:[(0,N.jsx)(x.Z,{className:"mb-2 block",htmlFor:"post_caption",children:(0,c.t)("Caption")}),(0,N.jsx)(h.Z,{id:"post_caption",name:"caption",defaultValue:t.caption,onChange:a})]}),(0,N.jsxs)("div",{className:"mb-5",children:[(0,N.jsx)(x.Z,{className:"mb-2 block",htmlFor:"post_image",children:(0,c.t)("Primary image")}),(0,N.jsx)(v.Z,{id:"post_image",name:"primaryImageFileId",defaultValue:t.primaryImageFileId,onChange:a,targetDrive:(0,i.V7)(t.channelId),acl:{requiredSecurityGroup:i.hh.Anonymous}})]}),t.slug?(0,N.jsxs)("div",{className:"mb-5",children:[(0,N.jsx)(x.Z,{className:"mb-2 block",htmlFor:"post_slug",children:(0,c.t)("Slug")}),(0,N.jsx)(h.Z,{id:"post_slug",name:"slug",defaultValue:t.slug,disabled:!0,onChange:a})]}):null,s]})},oe=function(e){var t,n=e.post,a=e.savePost;return(0,N.jsx)(se,{post:n.content,mediaDrive:(0,i.V7)(null===(t=n.content)||void 0===t?void 0:t.channelId),onChange:function(e){var t=(0,r.Z)({},n);t.content[e.target.name]=e.target.value,"type"===e.target.name&&(t.content.slug=(0,o.Cb)(t)),a(t)}})},ce=n(9080),le=n(7797),ue=function(){var e,t,n,m,v,h,x=(0,s.s0)(),p=(0,s.UO)(),g=p.channelKey,b=p.blogKey,j=(0,u.Z)({channelSlug:g}).fetch.data,w=(0,l.Z)({channelSlug:g,blogSlug:b}),Z=w.fetch,y=Z.data,C=Z.isLoading,k=Z.isFetched,I=w.save,S=I.mutate,D=I.status,M=I.error,H=w.remove,P=H.mutate,F=H.error,T=(0,f.useState)("new"===b?{acl:{requiredSecurityGroup:i.hh.Owner},content:{id:i.j4.getNewId(),channelId:null!==(e=null===j||void 0===j?void 0:j.channelId)&&void 0!==e?e:void 0,caption:"",slug:"",dateUnixTime:(new Date).getTime(),type:"Article",primaryImageFileId:""}}:void 0),L=(0,a.Z)(T,2),V=L[0],z=L[1];(0,f.useEffect)((function(){k&&y&&z((0,r.Z)({},y))}),[y]),(0,f.useEffect)((function(){j&&null!==V&&void 0!==V&&V.content&&z((0,r.Z)((0,r.Z)({},V),{},{content:(0,r.Z)((0,r.Z)({},V.content),{},{channelId:j.channelId})}))}),[j]);var O=function(e){e.content.slug||(e.content.slug=(0,o.Cb)(e)),e.content.caption||(e.content.caption=(0,c.t)("Untitled")),z((0,r.Z)({},e)),S({blogFile:e,channelId:e.content.channelId},{onSuccess:function(t){if(!V||b!==e.content.slug&&b!==e.fileId){var n=window.location.pathname.split("/");n.pop(),n&&window.history.replaceState(null,e.content.caption,"".concat(n.join("/"),"/").concat(e.content.slug))}z((0,r.Z)((0,r.Z)({},e),{},{fileId:t}))}})};return C?(0,N.jsx)(le.Z,{}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(d.Z,{error:M}),(0,N.jsx)(d.Z,{error:F}),(0,N.jsxs)("section",{children:[(0,N.jsx)(ce.Z,{title:null!==V&&void 0!==V&&null!==(t=V.content)&&void 0!==t&&t.caption?(0,o.iL)(V.content.caption,50):(0,c.t)("New post"),actions:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(B.Z,{type:"remove",className:"m-2",icon:"trash",confirmOptions:{title:"".concat((0,c.t)("Remove")," ").concat(null!==(n=null===V||void 0===V?void 0:V.content.caption.substring(0,50))&&void 0!==n?n:""),buttonText:"Permanently remove",body:(0,c.t)("Are you sure you want to remove this post? This action cannot be undone.")},onClick:function(){return P({fileId:V.fileId,channelId:V.content.channelId,slug:V.content.slug},{onSuccess:function(){var e=window.location.pathname.split("/");e.pop(),e&&x("".concat(e.join("/")))}})}}),null!==V&&void 0!==V&&V.acl&&(null===(m=V.acl.requiredSecurityGroup)||void 0===m?void 0:m.toLowerCase())!==i.hh.Owner.toLowerCase()?(0,N.jsx)(B.Z,{type:"primary",className:"m-2",onClick:function(){var e=(0,r.Z)({},V);e.acl={requiredSecurityGroup:i.hh.Owner},O(e)},confirmOptions:{title:(0,c.t)("Unpublish"),body:(0,c.t)("Are you sure you want to unpublish this post, it will again become a draft"),buttonText:(0,c.t)("Unpublish")},children:(0,c.t)("Unpublish")}):(0,N.jsx)(B.Z,{type:"primary",className:"m-2",onClick:function(){var e=(0,r.Z)({},V);e.acl=(0,r.Z)({},j.acl),e.content.dateUnixTime=(new Date).getTime(),O(e)},confirmOptions:{title:(0,c.t)("Publish"),body:(0,c.t)("Are you sure you want to publish this post, the contents will be accessible as specified on the channel"),buttonText:(0,c.t)("Publish")},children:(0,c.t)("Publish")})]}),breadCrumbs:[{href:"/owner/posts",title:"Posts"},{href:"/owner/posts/".concat(null===j||void 0===j?void 0:j.slug),title:j.name},{title:null!==(v=null===V||void 0===V||null===(h=V.content)||void 0===h?void 0:h.caption)&&void 0!==v?v:(0,c.t)("New")}],saveStatus:D}),(0,N.jsx)("div",{className:"md:mx-auto md:max-w-[40rem]",children:V&&(0,N.jsx)(oe,{post:V,savePost:O})})]})]})}}}]);
//# sourceMappingURL=918.5b23137d.chunk.js.map